(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[19],{2457:function(e,t,a){e.exports={nameID:"nameID___lHOPc",icon:"icon___3bO_J",iconm:"iconm___1h3X6",cmd:"cmd___1CeOh",logline:"logline___2nRMf"}},"52ST":function(e,t,a){"use strict";var s=a("g09b"),l=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var r=s(a("bx4M"));a("jCWc");var n=s(a("kPKH"));a("5Dmo");var d=s(a("3S7+"));a("14J3");var i=s(a("BMrR"));a("+L6B");var o=s(a("2/Rp")),u=s(a("jehZ"));a("y8nQ");var c=s(a("Vl3Y"));a("FJo9");var p,h,m,f,C=s(a("L41K")),g=s(a("18gR")),E=a("MuoO"),k=a("7DNP"),v=l(a("q1tI")),y=a("LLXN"),b=s(a("sQyZ")),I=s(a("VQ3Z")),_=s(a("LjLi")),w=s(a("s6ox")),M=s(a("5ov5")),S=s(a("XZXw")),D=s(a("2lxJ")),x=s(a("AklW")),L=s(a("QDog")),T=s(a("+iC2")),K=C.default.Step,P=(p=c.default.create(),h=(0,E.connect)(e=>{var t=e.user,a=e.list,s=e.loading,l=e.global,r=e.index;return{user:t.currentUser,list:a,loading:s.models.list,rainbondInfo:l.rainbondInfo,enterprise:l.enterprise,isRegist:l.isRegist,oauthLongin:s.effects["global/creatOauth"],overviewInfo:r.overviewInfo}}),p(m=h((f=class extends v.PureComponent{constructor(e){super(e),this.startInit=(()=>{var e=this.props,t=e.dispatch,a=e.match.params,s=a.eid,l=a.provider,r=this.state,n=r.selectClusterID,d=r.rainbondInit;t(k.routerRedux.push("/enterprise/".concat(s,"/provider/").concat(l,"/kclusters/").concat(n,"/").concat(d?"link":"init")))}),this.selectCluster=(e=>{this.setState({selectClusterID:e.clusterID,rainbondInit:e.rainbond_init})}),this.loadLastTask=(()=>{var e=this.props,t=e.dispatch,a=e.match.params,s=a.eid,l=a.provider;t({type:"cloud/loadLastTask",payload:{enterprise_id:s,provider_name:l},callback:e=>{e&&(this.setState({lastTask:e,currentClusterID:e.clusterID}),"start"===e.status&&this.setState({showTaskDetail:!0}))},handleError:e=>{x.default.handleCloudAPIError(e)}})}),this.loadKubernetesCluster=(()=>{var e=this.props,t=e.dispatch,a=e.match.params,s=a.eid,l=a.provider;this.setState({loading:!0}),t({type:"cloud/loadKubereneteClusters",payload:{enterprise_id:s,provider_name:l},callback:e=>{if(e&&e.clusters&&e.clusters.length>0){var t="running"===e.clusters[0].state;this.setState({k8sClusters:e.clusters,loading:!1}),t&&document.getElementById("initializeBtn").scrollIntoView(),this.loadRainbondClusters()}else"custom"!==l&&"rke"!==l||this.showBuyClusterConfig(),this.setState({loading:!1,k8sClusters:[]})},handleError:e=>{x.default.handleCloudAPIError(e),this.setState({loading:!1})}})}),this.handleStartLog=((e,t,a)=>{var s=this.props,l=s.match.params,r=l.eid,n=l.provider,d=s.rainbondInfo,i=s.enterprise;L.default.putInstallClusterLog(i,d,{eid:r,taskID:e,status:a?t:"start",install_step:"createK8s",provider:n})}),this.loadRainbondClusters=(()=>{var e=this.props,t=e.dispatch,a=e.match.params.eid;t({type:"region/fetchEnterpriseClusters",payload:{enterprise_id:a,check_status:"no"},callback:e=>{if(e&&e.list){var t=new Map;e.list.map(e=>{return""!==e.provider_cluster_id&&t.set(e.provider_cluster_id,!0),e}),this.setState({linkedClusters:t})}}})}),this.showBuyClusterConfig=(()=>{this.setState({showBuyClusterConfig:!0})}),this.cancelAddCluster=(()=>{this.setState({showBuyClusterConfig:!1})}),this.cancelShowCreateDetail=(()=>{this.setState({showTaskDetail:!1}),this.loadKubernetesCluster()}),this.addClusterOK=(()=>{var e=this.props.dispatch,t=this.props.match.params.eid;e(k.routerRedux.push("/enterprise/".concat(t,"/clusters")))}),this.preStep=(()=>{var e=this.props.dispatch,t=this.props.match.params.eid;e(k.routerRedux.push("/enterprise/".concat(t,"/addCluster")))}),this.loadSteps=(()=>{var e=[{title:(0,y.formatMessage)({id:"enterpriseColony.addCluster.supplier"})},{title:(0,y.formatMessage)({id:"enterpriseColony.addCluster.cluster"})},{title:(0,y.formatMessage)({id:"enterpriseColony.addCluster.Initialize"})},{title:(0,y.formatMessage)({id:"enterpriseColony.addCluster.docking"})}];return e}),this.handleOk=((e,t,a)=>{this.setState(t),e&&e.taskID&&this.handleStartLog(e.taskID,e.status,a),this.cancelAddCluster(),this.loadKubernetesCluster()}),this.handleGuideStep=(e=>{this.setState({guideStep:e})}),this.handleNewbieGuiding=(e=>{var t=e.prevStep,a=e.nextStep,s=e.handleClick,l=void 0===s?()=>{}:s,r=e.handleClosed,n=void 0===r?()=>{}:r;return v.default.createElement(g.default,(0,u.default)({},e,{totals:14,handleClose:()=>{this.handleGuideStep("close"),this.selectCluster({clusterID:"",rainbond_init:!1}),n()},handlePrev:()=>{t&&this.handleGuideStep(t)},handleNext:()=>{a&&(l(),this.handleGuideStep(a))}}))}),this.renderCreateClusterShow=(()=>{var e=this.props.match.params,t=e.eid,a=e.provider,s=this.state.guideStep;switch(a){case"ack":return v.default.createElement(b.default,{eid:t,selectProvider:a,onCancel:()=>{this.cancelAddCluster()},onOK:e=>{var t={lastTask:e,showTaskDetail:!0,currentClusterID:e.clusterID};this.handleOk(e,t)}});case"tke":break;case"custom":return v.default.createElement(I.default,{eid:t,onCancel:()=>{this.cancelAddCluster()},onOK:e=>{var t={currentClusterID:e.clusterID};this.handleOk(e,t,!0)}});case"rke":return v.default.createElement(w.default,{eid:t,guideStep:s,handleNewbieGuiding:this.handleNewbieGuiding,onCancel:()=>{this.cancelAddCluster()},onOK:e=>{var t={lastTask:e,showTaskDetail:!0,currentClusterID:e.clusterID};this.handleOk(e,t)}});default:}});var t=this.props.user,a=T.default.isCompanyAdmin(t);this.state={adminer:a,showBuyClusterConfig:!1,k8sClusters:[],loading:!0,rainbondInit:!1,selectClusterID:"",showTaskDetail:!1,linkedClusters:new Map,lastTask:{},guideStep:3,currentClusterID:""}}componentWillMount(){var e=this.state.adminer,t=this.props.dispatch;e||t(k.routerRedux.push("/"))}componentDidMount(){this.loadKubernetesCluster(),this.loadLastTask()}render(){var e=this.props,t=e.match.params,a=t.eid,s=t.provider,l=e.location.query,u=l.clusterID,c=l.updateKubernetes,p=this.state,h=p.k8sClusters,m=p.showBuyClusterConfig,f=p.loading,g=p.selectClusterID,E=p.showTaskDetail,k=p.lastTask,b=p.linkedClusters,I=p.currentClusterID,w=p.guideStep,x=""===g,L="".concat((0,y.formatMessage)({id:"enterpriseColony.addCluster.host.Cluster_list"}));switch(s){case"ack":L+="".concat((0,y.formatMessage)({id:"enterpriseColony.addCluster.host.al"}));break;case"tke":L+="".concat((0,y.formatMessage)({id:"enterpriseColony.addCluster.host.tx"}));break;case"custom":L+="".concat((0,y.formatMessage)({id:"enterpriseColony.addCluster.host.zdy"}));break;case"rke":L+="".concat((0,y.formatMessage)({id:"enterpriseColony.addCluster.host.host_oneself"}));break;default:L+="".concat((0,y.formatMessage)({id:"enterpriseColony.addCluster.host.provider"},{provider:s}))}var T=v.default.createElement(o.default,{style:{marginLeft:"16px"},type:"primary",onClick:this.startInit,disabled:x,id:"initializeBtn"},v.default.createElement(y.FormattedMessage,{id:"button.next"})),P=!1,A="",N=!1;return h&&h.length&&h.map(e=>{var t=e.state;"running"===t&&(N=e.rainbond_init,A=e.cluster_id,P=!0)}),v.default.createElement(S.default,{title:v.default.createElement(y.FormattedMessage,{id:"enterpriseColony.button.text"}),content:v.default.createElement(y.FormattedMessage,{id:"enterpriseColony.PageHeaderLayout.content"}),titleSvg:D.default.getSvg("clusterSvg",18)},v.default.createElement(i.default,{style:{marginBottom:"16px"}},v.default.createElement(C.default,{current:1},this.loadSteps().map(e=>v.default.createElement(K,{key:e.title,title:e.title})))),v.default.createElement(r.default,{title:L},v.default.createElement(_.default,{eid:a,loading:f,loadKubernetesCluster:this.loadKubernetesCluster,selectCluster:this.selectCluster,selectProvider:s,data:h,lastTask:k,showLastTaskDetail:()=>{this.setState({showTaskDetail:!0})},guideStep:w,handleNewbieGuiding:this.handleNewbieGuiding,loadLastTask:this.loadLastTask,linkedClusters:b,showBuyClusterConfig:this.showBuyClusterConfig,updateKubernetes:c,updateKubernetesClusterID:u}),!P||3!==w&&8!==w?"":this.handleNewbieGuiding({tit:(0,y.formatMessage)({id:"enterpriseColony.addCluster.host.select_the_cluster"}),desc:(0,y.formatMessage)({id:"enterpriseColony.addCluster.host.cluster"}),send:!1,configName:"kclustersInitializationCluster",nextStep:9,svgPosition:{left:"44px",marginTop:"-35px"},handleClick:()=>{this.selectCluster({clusterID:A,rainbond_init:N})}}),m&&this.renderCreateClusterShow(),v.default.createElement(n.default,{style:{textAlign:"center",marginTop:"32px"},span:24},v.default.createElement(o.default,{onClick:this.preStep},v.default.createElement(y.FormattedMessage,{id:"button.previous"})),x?v.default.createElement(d.default,{title:(0,y.formatMessage)({id:"enterpriseColony.addCluster.host.select_the_cluster"})},T):T,P&&9===w?this.handleNewbieGuiding({tit:(0,y.formatMessage)({id:"enterpriseColony.addCluster.host.Rainbond"}),desc:(0,y.formatMessage)({id:"enterpriseColony.addCluster.host.install"}),send:!0,configName:"kclustersInitializationCluster",nextStep:10,conPosition:{left:"60%",bottom:"-24px"},svgPosition:{left:"54%",marginTop:"-11px"},handleClick:()=>{x||this.startInit()}}):""),E&&k&&v.default.createElement(M.default,{onCancel:this.cancelShowCreateDetail,eid:a,selectProvider:s,taskID:k.taskID,clusterID:I})))}},m=f))||m)||m);t.default=P},"5ov5":function(e,t,a){"use strict";var s=a("g09b"),l=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n,d,i=s(a("jehZ")),o=a("MuoO"),u=l(a("q1tI")),c=s(a("AklW")),p=s(a("QDog")),h=s(a("UBd8")),m=a("LLXN"),f=(r=(0,o.connect)(e=>{var t=e.global;return{rainbondInfo:t.rainbondInfo,enterprise:t.enterprise}}),r((d=class extends u.PureComponent{constructor(e){super(e),this.refresh=!0,this.loadTask=(()=>{var e=this.props,t=e.dispatch,a=e.eid,s=e.taskID;t({type:"cloud/loadTask",payload:{enterprise_id:a,taskID:s},callback:e=>{e&&this.setState({complete:"complete"===e.status})},handleError:e=>{c.default.handleCloudAPIError(e),this.setState({loading:!1})}})}),this.loadTaskEvents=(()=>{var e=this.props,t=e.dispatch,a=e.eid,s=e.taskID,l=e.rainbondInfo,r=e.enterprise;t({type:"cloud/loadTaskEvents",payload:{enterprise_id:a,taskID:s},callback:e=>{if(e){var t=c.default.showCreateKubernetesSteps(e.events),n=t.complete,d=t.steps;n&&d&&d.length>0&&p.default.putInstallClusterLog(r,l,{eid:a,taskID:s,status:d[d.length-1].Status,message:d[d.length-1].Message,install_step:"createK8s",provider:"rke"}),this.setState({complete:n,loading:!1,steps:d}),this.refresh&&!n&&setTimeout(()=>{this.loadTaskEvents()},4e3)}},handleError:e=>{c.default.handleCloudAPIError(e),this.setState({loading:!1}),this.refresh&&setTimeout(()=>{this.loadTaskEvents()},8e3)}})}),this.queryCreateLog=(()=>{this.setState({showCreateLog:!0})}),this.state={loading:!0,complete:!1,steps:[],showCreateLog:!1}}componentDidMount(){this.loadTask(),this.loadTaskEvents()}componentWillUnmount(){this.refresh=!1}render(){var e=this.props.title;return u.default.createElement(h.default,(0,i.default)({title:e||u.default.createElement(m.FormattedMessage,{id:"enterpriseColony.ShowKubernetesCreateDetail.msg"}),msg:(0,m.formatMessage)({id:"enterpriseColony.ShowKubernetesCreateDetail.msg"})},this.state,this.props))}},n=d))||n),C=f;t.default=C},LjLi:function(e,t,a){"use strict";var s=a("g09b"),l=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var r=s(a("kLXV"));a("g9YV");var n=s(a("wCAj"));a("14J3");var d=s(a("BMrR"));a("P2fV");var i=s(a("NJEC"));a("+L6B");var o=s(a("2/Rp"));a("5Dmo");var u=s(a("3S7+"));a("7Kak");var c=s(a("9yH6"));a("jCWc");var p=s(a("kPKH"));a("Pwec");var h=s(a("CtXQ"));a("/xke");var m=s(a("TeRw"));a("miYZ");var f=s(a("tsqr"));a("tU7J");var C,g,E,k=s(a("wFql")),v=s(a("+QRC")),y=a("MuoO"),b=l(a("q1tI")),I=a("LLXN"),_=s(a("9tdr")),w=a("ArA+"),M=a("mLYH"),S=s(a("AklW")),D=s(a("dBUJ")),x=s(a("imTl")),L=s(a("3//m")),T=s(a("s6ox")),K=s(a("gtfS")),P=s(a("T8HY")),A=s(a("2457")),N=k.default.Paragraph,R=(C=(0,y.connect)(),C((E=class extends b.PureComponent{constructor(e){super(e),this.handleLoadInitNodeCmd=(()=>{var e=this.props.dispatch;e({type:"cloud/getInitNodeCmd",callback:e=>{this.setState({initCmd:e&&e.response_data&&e.response_data.cmd||""})}})}),this.autoPage=(()=>{var e=this.props,t=e.updateKubernetes,a=e.updateKubernetesClusterID;t&&a&&this.updateCluster(a)}),this.queryCreateLog=(e=>{this.setState({showCreateLog:!0,clusterID:e.cluster_id})}),this.reInstallCluster=(e=>{var t=this.props,a=t.dispatch,s=t.eid,l=t.selectProvider,r=t.loadKubernetesCluster,n=t.loadLastTask;if("rke"!==l)return f.default.warning("\u8be5\u63d0\u4f9b\u5546\u4e0d\u652f\u6301\u96c6\u7fa4\u91cd\u88c5"),void this.handleInstallLoading(!1);a({type:"cloud/reInstall",payload:{enterprise_id:s,clusterID:e},callback:e=>{this.handleInstallRemind(!1),this.handleInstallLoading(!1),e&&(r&&r(),n&&n())},handleError:e=>{this.handleInstallLoading(!1),S.default.handleCloudAPIError(e)}})}),this.updateCluster=(e=>{var t=this.props,a=t.eid,s=t.selectProvider;(0,M.getUpdateKubernetesTask)({clusterID:e,providerName:s,enterprise_id:a},e=>{S.default.handleCloudAPIError(e)}).then(t=>{t.task&&"complete"!==t.task.status?this.setState({showUpdateKubernetesTasks:!0,updateTask:t.task}):this.setState({showUpdateKubernetes:!0,nodeList:t.nodeList,rkeConfig:t.rkeConfig,updateClusterID:e})}).catch(e=>{console.log(e)})}),this.uninstallCluster=(e=>{var t=this.props,a=t.eid,s=t.selectProvider;(0,M.uninstallRegion)({provider_name:s,enterprise_id:a,clusterID:e},e=>{S.default.handleCloudAPIError(e)}).then(e=>{e&&200===e.status_code&&m.default.success({message:(0,I.formatMessage)({id:"notification.success.cluster_uninstalled"})})})}),this.handleInstallLoading=(e=>{this.setState({installLoading:e})}),this.handleInstallRemind=(e=>{this.setState({isInstallRemind:e})}),this.handleCommandBox=(e=>{return b.default.createElement(p.default,{span:24,style:{marginTop:"16px"}},b.default.createElement("span",{className:K.default.cmd},b.default.createElement(h.default,{className:K.default.copy,type:"copy",onClick:()=>{(0,v.default)(e),m.default.success({message:(0,I.formatMessage)({id:"notification.success.copy"})})}}),e))}),this.cancelShowUpdateKubernetes=(()=>{var e=this.props.loadKubernetesCluster;this.setState({showUpdateKubernetesTasks:!1,updateTask:null}),e&&e()}),this.getKubeConfig=(e=>{var t=this.props,a=t.eid,s=t.selectProvider;(0,M.getKubeConfig)({clusterID:e,enterprise_id:a,providerName:s}).then(e=>{200===e.status_code&&this.setState({kubeConfig:e.config})})}),this.handleIsComponents=(e=>{this.setState({isComponents:e})}),this.state={selectClusterName:"",clusterID:"",showCreateLog:!1,isInstallRemind:!1,installLoading:!1,isComponents:!1,initCmd:null}}componentDidMount(){this.autoPage(),this.handleLoadInitNodeCmd()}deleteCluster(e){var t=this.props,a=t.dispatch,s=t.eid,l=t.selectProvider,r=t.loadKubernetesCluster;a({type:"cloud/deleteKubernetesCluster",payload:{enterprise_id:s,providerName:l,clusterID:e},callback:()=>{r&&r()},handleError:e=>{S.default.handleCloudAPIError(e)}})}render(){var e=this.props,t=e.selectProvider,a=e.linkedClusters,s=e.eid,l=e.selectCluster,f=this.state,C=f.selectClusterName,g=f.initCmd,E=[{width:50,dataIndex:"radio",render:(e,t)=>{var s=t.cluster_id,r="running"!==t.state||a.get(s)||t.parameters&&t.parameters.DisableRainbondInit,n=t.parameters&&t.parameters.Message,d=t.name;return b.default.createElement(u.default,{title:n},b.default.createElement(c.default,{disabled:r,checked:C===d,onClick:()=>{r||(this.setState({selectClusterName:d}),l&&l({clusterID:s,name:d,can_init:t.can_init,rainbond_init:t.state&&"running"===t.state&&t.rainbond_init}))}},e))}},{title:(0,I.formatMessage)({id:"enterpriseColony.addCluster.host.name"}),width:120,dataIndex:"name",render:(e,t)=>{var a="".concat(e,"(").concat(t.cluster_id,")");return b.default.createElement(u.default,{title:a},b.default.createElement("div",{className:A.default.nameID},a))}},{title:(0,I.formatMessage)({id:"enterpriseColony.addCluster.host.cluster_type"}),width:180,dataIndex:"cluster_type",render:e=>{return S.default.getAliyunClusterName(e)}}];"custom"!==t&&"rke"!==t?(E.push({title:(0,I.formatMessage)({id:"enterpriseColony.addCluster.host.region_id"}),dataIndex:"region_id",render:e=>{return S.default.getAliyunRegionName(e)}}),E.push({title:(0,I.formatMessage)({id:"enterpriseColony.addCluster.host.zone_id"}),dataIndex:"zone_id"})):E.push({title:(0,I.formatMessage)({id:"enterpriseColony.addCluster.host.master_url"}),width:300,dataIndex:"master_url.api_server_endpoint"}),E.push({title:(0,I.formatMessage)({id:"enterpriseColony.addCluster.host.size"}),width:100,dataIndex:"size"}),E.push({title:(0,I.formatMessage)({id:"enterpriseColony.addCluster.host.current_version"}),width:250,dataIndex:"current_version"}),E.push({title:(0,I.formatMessage)({id:"enterpriseColony.addCluster.host.state"}),width:150,dataIndex:"state",render:(e,t)=>{return S.default.getAliyunClusterStatus(e,t,a)}}),E.push({title:(0,I.formatMessage)({id:"enterpriseColony.addCluster.host.cluster_id"}),dataIndex:"cluster_id",render:(e,l)=>{return b.default.createElement("div",null,"running"===l.state&&b.default.createElement("a",{onClick:()=>this.getKubeConfig(l.cluster_id||l.name)},"KubeConfig"),"failed"===l.state&&"rke"===t&&b.default.createElement("a",{onClick:()=>{this.handleInstallRemind(l.cluster_id||l.name)}},b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.Reinstall"})),!0===l.rainbond_init&&!a.get(l.cluster_id)&&b.default.createElement(w.Link,{to:"/enterprise/".concat(s,"/provider/").concat(t,"/kclusters/").concat(l.cluster_id,"/link")},b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.Docking"})),"rke"!==t&&l.create_log_path&&l.create_log_path.startsWith("http")&&b.default.createElement(o.default,{type:"link",style:{padding:0},onClick:()=>{window.open(l.create_log_path,"_blank")}},b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.view_log"})),"rke"===t&&b.default.createElement(o.default,{type:"link",style:{padding:0},onClick:()=>{this.queryCreateLog(l)}},b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.view_log"})),!l.rainbond_init&&("rke"===t||"custom"===t)&&b.default.createElement(i.default,{placement:"top",title:b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.current_cluster"}),onConfirm:()=>{this.deleteCluster(l.cluster_id||l.name)},okText:b.default.createElement(I.FormattedMessage,{id:"button.confirm"}),cancelText:b.default.createElement(I.FormattedMessage,{id:"button.cancel"})},b.default.createElement("a",null,b.default.createElement(I.FormattedMessage,{id:"button.delete"}))),"rke"===t&&b.default.createElement("a",{onClick:()=>this.updateCluster(l.cluster_id||l.name)},b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.Cluster_configuration"})),"running"===l.state&&("rke"===t||"custom"===t)&&b.default.createElement("a",{onClick:()=>this.handleIsComponents(l.cluster_id)},b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.look"})),!0===l.rainbond_init&&b.default.createElement(i.default,{placement:"top",title:b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.After_uninstallation"}),onConfirm:()=>{this.uninstallCluster(l.cluster_id||l.name)},okText:b.default.createElement(I.FormattedMessage,{id:"button.confirm"}),cancelText:b.default.createElement(I.FormattedMessage,{id:"button.cancel"})},b.default.createElement("a",null,b.default.createElement(I.FormattedMessage,{id:"button.uninstall"}))))}});var k=this.props,y=k.data,M=k.showBuyClusterConfig,R=k.loadKubernetesCluster,F=k.loading,B=k.lastTask,O=k.showLastTaskDetail,U=this.state,q=U.clusterID,W=U.kubeConfig,j=U.showUpdateKubernetes,z=U.nodeList,G=U.rkeConfig,V=U.updateClusterID,J=U.showUpdateKubernetesTasks,X=U.updateTask,Q=U.showCreateLog,Z=U.installLoading,H=U.isComponents,Y=U.isInstallRemind,$="curl -sfL https://get.rainbond.com/clean-rke | bash";return b.default.createElement("div",null,b.default.createElement(d.default,{style:{marginBottom:"20px"}},"ack"===t&&b.default.createElement(p.default,{span:24,style:{padding:"16px"}},b.default.createElement(N,{className:D.default.describe},b.default.createElement("ul",null,b.default.createElement("li",null,b.default.createElement("span",null,b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.managed"}))),b.default.createElement("li",null,b.default.createElement("span",null,b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.click"}),b.default.createElement(o.default,{type:"link",onClick:M},b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.Newly"})),b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.Quick"}))),b.default.createElement("li",null,b.default.createElement("span",null,b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.try_again"}),S.default.getAliyunCountDescribe().map(e=>{return b.default.createElement("a",{style:{marginRight:"8px"},href:e.href,target:"_blank",rel:"noreferrer"},e.title)}))),b.default.createElement("li",null,b.default.createElement("span",null,b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.successfully"})))))),b.default.createElement(p.default,{span:12,style:{textAlign:"left"}},C&&b.default.createElement("span",{style:{marginRight:"16px"}},b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.Cluster_selected"})," ",C,",",b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.cluster_complies"})),!C&&B&&B.name&&O&&b.default.createElement("span",null,b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.Last_created"}),B.name,",",b.default.createElement(o.default,{onClick:O,type:"link"},b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.creation_progress"})))),b.default.createElement(p.default,{span:12,style:{textAlign:"right"}},b.default.createElement(o.default,{type:"primary",onClick:M},b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.add"})),b.default.createElement(o.default,{style:{marginLeft:"16px"},onClick:R},b.default.createElement(h.default,{type:"reload"})))),b.default.createElement(n.default,{scroll:{x:!(window.innerWidth>1500)&&1500},loading:F,pagination:!1,columns:E,dataSource:y}),Y&&b.default.createElement(r.default,{title:b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.reinstall_current_cluster"}),confirmLoading:Z,className:K.default.TelescopicModal,width:900,visible:!0,onOk:()=>{this.handleInstallLoading(!0),this.reInstallCluster(Y)},onCancel:()=>{this.handleInstallRemind(!1)}},b.default.createElement(d.default,{style:{padding:"0 16px"}},b.default.createElement("span",{style:{fontWeight:600,color:"red"}},b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.following"}),b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.commands"}),b.default.createElement("br",null),b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.addCluster.host.permission"})),this.handleCommandBox($),this.handleCommandBox(g))),Q&&b.default.createElement(L.default,{eid:s,clusterID:q,selectProvider:t,onCancel:()=>{this.setState({clusterID:"",showCreateLog:!1})}}),W&&b.default.createElement(r.default,{visible:!0,width:1e3,maskClosable:!1,onCancel:()=>{this.setState({kubeConfig:""})},title:"KubeConfig",bodyStyle:{background:"#000"},onOk:()=>{(0,v.default)(W),m.default.success({message:(0,I.formatMessage)({id:"notification.success.copy"})})},okText:b.default.createElement(I.FormattedMessage,{id:"button.copy"})},b.default.createElement("div",{className:A.default.cmd},b.default.createElement(_.default,{value:W,options:{mode:{name:"javascript",json:!0},lineNumbers:!0,theme:"seti",lineWrapping:!0,smartIndent:!0,matchBrackets:!0,scrollbarStyle:null,showCursorWhenSelecting:!0,height:500}}))),j&&b.default.createElement(T.default,{eid:s,onOK:e=>{this.setState({clusterID:e.clusterID,showUpdateKubernetes:!1,updateTask:e,showUpdateKubernetesTasks:!0})},onCancel:()=>{this.setState({showUpdateKubernetes:!1})},clusterID:V,nodeList:z,rkeConfig:G}),J&&b.default.createElement(P.default,{eid:s,clusterID:q,task:X,selectProvider:t,onCancel:this.cancelShowUpdateKubernetes}),H&&b.default.createElement(x.default,{eid:s,clusterID:H,providerName:t,onCancel:()=>{this.handleIsComponents(!1)}}))}},g=E))||g);t.default=R},sQyZ:function(e,t,a){"use strict";var s=a("g09b"),l=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var r=s(a("kLXV"));a("14J3");var n=s(a("BMrR"));a("giR+");var d=s(a("fyUT"));a("5NDa");var i=s(a("5rEg"));a("jCWc");var o=s(a("kPKH")),u=s(a("p0pE"));a("y8nQ");var c=s(a("Vl3Y"));a("OaEy");var p=s(a("2fM7"));a("tU7J");var h,m,f,C,g=s(a("wFql")),E=a("MuoO"),k=l(a("q1tI")),v=s(a("AklW")),y=s(a("dBUJ")),b=g.default.Paragraph,I=p.default.Option,_=(h=c.default.create(),m=(0,E.connect)(),h(f=m((C=class extends k.PureComponent{constructor(e){super(e),this.createCluster=(()=>{var e=this.props,t=e.form,a=e.dispatch,s=e.eid,l=e.onOK;t.validateFields((e,t)=>{e||(this.setState({loading:!0}),a({type:"cloud/createKubernetesCluster",payload:(0,u.default)({enterprise_id:s,provider_name:"ack"},t),callback:e=>{e&&l&&l(e)},handleError:e=>{e&&e.data&&7005===e.data.code?l(e.data.data):(v.default.handleCloudAPIError(e),this.setState({loading:!1}))}}))})}),this.changeWorkerType=(e=>{""===e&&this.setState({customResource:!0})}),this.state={customResource:!1,loading:!1}}render(){var e=this.props.onCancel,t=this.props.form.getFieldDecorator,a=this.state,s=a.customResource,l=a.loading;return k.default.createElement(r.default,{visible:!0,title:"\u8d2d\u4e70\u963f\u91cc\u4e91 ACK \u96c6\u7fa4",onOk:this.createCluster,width:800,confirmLoading:l,onCancel:e},k.default.createElement(c.default,null,k.default.createElement(n.default,null,k.default.createElement(o.default,{span:24,style:{padding:"16px"}},k.default.createElement(b,{className:y.default.describe},k.default.createElement("ul",null,k.default.createElement("li",null,k.default.createElement("span",null,"\u59d4\u6258\u8d2d\u4e70\u65f6\u5c06\u8d2d\u4e70\u4ee5\u4e0b\u8d44\u6e90\uff1a\u6807\u51c6\u6258\u7ba1\u96c6\u7fa4(1\u4e2a)\u3001VPC(1\u4e2a)")),k.default.createElement("li",null,k.default.createElement("span",null,"\u65b0\u8d2d\u96c6\u7fa4\u90fd\u5c06\u91c7\u7528\u6309\u9700\u540e\u4ed8\u8d39\u6a21\u5f0f\uff0c\u56e0\u6b64\u8bf7\u786e\u4fdd\u4f60\u7684\u963f\u91cc\u4e91\u8d26\u53f7\u80fd\u591f\u8fdb\u884c\u6309\u9700\u8d2d\u4e70\u8d44\u6e90")),k.default.createElement("li",null,k.default.createElement("span",null,"\u8d2d\u4e70\u7684Kubernetes\u5c06\u5f00\u542fEIP,\u901a\u8fc7\u516c\u7f51\u8bbf\u95eeKubeApiserver, \u96c6\u7fa4\u5bf9\u63a5\u5b8c\u6bd5\u540e\u53ef\u4ee5\u624b\u5de5\u5173\u95ed\u96c6\u7fa4\u7684\u5916\u7f51\u8bbf\u95eeEIP")),k.default.createElement("li",null,k.default.createElement("span",null,"\u9ed8\u8ba4\u91c7\u7528\u63a8\u8350\u7684\u8d44\u6e90\u7c7b\u578b\u914d\u7f6e\uff0c\u82e5\u4e0d\u7b26\u5408\u4f60\u7684\u9884\u671f\uff0c\u4f60\u53ef\u76f4\u63a5\u524d\u5f80\u963f\u91cc\u4e91\u63a7\u5236\u53f0\u81ea\u5b9a\u4e49\u8d2d\u4e70\u6258\u7ba1\u96c6\u7fa4\uff0c\u7136\u540e\u8fd4\u56de\u5230\u96c6\u7fa4\u5217\u8868\u9009\u62e9\u540e\u5f00\u59cb\u521d\u59cb\u5316")),k.default.createElement("li",null,k.default.createElement("span",null,"\u8d2d\u4e70\u96c6\u7fa4\u7684\u6210\u529f\u6027\u548c\u8017\u65f6\u53d6\u51b3\u4e8e\u963f\u91cc\u4e91\u7684\u5b9e\u9645\u72b6\u6001\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u9884\u8ba110\u5206\u949f\u53ef\u4ee5\u5b8c\u6210\u96c6\u7fa4\u8d2d\u4e70")),s&&k.default.createElement("li",null,k.default.createElement("span",null,"\u81ea\u5b9a\u4e49\u8d44\u6e90\u89c4\u683c\u65f6\u8bf7\u53c2\u8003"," ",k.default.createElement("a",{target:"_blank",rel:"noreferrer",href:"https://ecs-buy.aliyun.com/instanceTypes"},"\u963f\u91cc\u4e91ECS\u89c4\u683c\u8bf4\u660e\u6587\u6863")," ","\u83b7\u53d6\u8d44\u6e90\u89c4\u683cID"))))),k.default.createElement(o.default,{span:12,style:{padding:"0 16px"}},k.default.createElement(c.default.Item,{label:"\u533a\u57df"},t("region",{initialValue:"cn-hangzhou",rules:[{required:!0,message:"\u96c6\u7fa4\u521b\u5efa\u533a\u57df\u5fc5\u9009"}]})(k.default.createElement(p.default,{placeholder:"\u533a\u57df",getPopupContainer:e=>e.parentNode},v.default.getAllAliyunRegions().map(e=>{return k.default.createElement(I,{key:e.RegionId,value:e.RegionId},e.LocalName)}))))),k.default.createElement(o.default,{span:12,style:{padding:"0 16px"}},k.default.createElement(c.default.Item,{label:"\u540d\u79f0"},t("name",{initialValue:"",rules:[{required:!0,message:"\u96c6\u7fa4\u540d\u79f0\u5fc5\u586b"},{pattern:/^[a-z0-9A-Z-]+$/,message:"\u53ea\u652f\u6301\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e2d\u5212\u7ebf\u7ec4\u5408"},{max:24,message:"\u6700\u5927\u957f\u5ea624\u4f4d"}]})(k.default.createElement(i.default,{placeholder:"\u96c6\u7fa4\u540d\u79f0,\u8bf7\u786e\u4fdd\u5176\u4fdd\u6301\u552f\u4e00"})))),k.default.createElement(o.default,{span:12,style:{padding:"0 16px"}},!s&&k.default.createElement(c.default.Item,{label:"\u8d44\u6e90\u914d\u7f6e"},t("resourceType",{initialValue:"ecs.g5.xlarge",rules:[{required:!0,message:"\u8d44\u6e90\u914d\u7f6e\u5fc5\u987b\u6307\u5b9a"}]})(k.default.createElement(p.default,{getPopupContainer:e=>e.parentNode,onChange:this.changeWorkerType,placeholder:"\u96c6\u7fa4\u540d\u79f0"},k.default.createElement(I,{value:"ecs.g5.large"},"\u6700\u5c0f\u914d\u7f6e\uff08\u5355\u8282\u70b92Core/8GB RAM, \u6309\u9700\u9884\u8ba12\u5143/\u5c0f\u65f6\uff09"),k.default.createElement(I,{value:"ecs.g5.xlarge"},"\u666e\u901a\u914d\u7f6e\uff08\u5355\u8282\u70b94Core/16GB RAM, \u6309\u9700\u9884\u8ba14\u5143/\u5c0f\u65f6\uff09"),k.default.createElement(I,{value:"ecs.g5.2xlarge"},"\u751f\u4ea7\u914d\u7f6e\uff08\u5355\u8282\u70b98Core/32GB RAM, \u6309\u9700\u9884\u8ba18\u5143/\u5c0f\u65f6\uff09"),k.default.createElement(I,{value:""},"\u81ea\u5b9a\u4e49")))),s&&k.default.createElement(c.default.Item,{label:"\u8d44\u6e90\u914d\u7f6e"},t("resourceType",{initialValue:"",rules:[{required:!0,message:"\u8d44\u6e90\u914d\u7f6e\u5fc5\u987b\u6307\u5b9a"},{pattern:/^[a-z0-9A-Z.]+$/,message:"\u8bf7\u786e\u5b9a\u8d44\u6e90\u914d\u7f6e\u89c4\u683c\u662f\u5426\u5408\u6cd5"}]})(k.default.createElement(i.default,{placeholder:"\u963f\u91cc\u4e91ECS\u89c4\u683c"})))),k.default.createElement(o.default,{span:12,style:{padding:"0 16px"}},k.default.createElement(c.default.Item,{label:"\u8282\u70b9\u6570\u91cf"},t("workerNum",{initialValue:2,rules:[{required:!0,message:"\u8282\u70b9\u6570\u91cf\u5fc5\u987b\u6307\u5b9a"}]})(k.default.createElement(d.default,{style:{width:"100%"},min:2,placeholder:"\u8282\u70b9\u6570\u91cf"})))))))}},f=C))||f)||f);t.default=_}}]);