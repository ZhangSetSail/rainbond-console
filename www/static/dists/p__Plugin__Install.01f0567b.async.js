(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[70],{DU6M:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,n,r,o=l(a("p0pE")),p=i(a("q1tI")),d=a("LLXN"),u=a("MuoO"),c=a("7DNP"),h=l(a("XZXw")),m=l(a("QDog")),g=l(a("yxQP")),f=(l(a("Gyju")),l(a("2lxJ"))),v=l(a("GMji")),y=(s=(0,u.connect)(),s((r=class extends p.PureComponent{constructor(){super(...arguments),this.handleSubmit=(e=>{this.props.dispatch({type:"plugin/createPlugin",payload:(0,o.default)({team_name:m.default.getCurrTeamName()},e),callback:e=>{this.props.dispatch(c.routerRedux.push("/team/".concat(m.default.getCurrTeamName(),"/region/").concat(m.default.getCurrRegionName(),"/myplugns/").concat(e&&e.bean.plugin_id)))}})})}render(){g.default.pageHeaderContent,g.default.extraImg;return p.default.createElement(h.default,{title:(0,d.formatMessage)({id:"teamPlugin.install.title"}),isFooter:!0,titleSvg:f.default.getSvg("apiSvg",18)},p.default.createElement(v.default,{isAddMarket:!1}))}},n=r))||n);t.default=y},GMji:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("fOrg");var s=l(a("+KLJ"));a("2qtc");var n=l(a("kLXV"));a("7Kak");var r=l(a("9yH6"));a("+L6B");var o=l(a("2/Rp"));a("T2oS");var p=l(a("W9HT"));a("5NDa");var d=l(a("5rEg"));a("Mwp2");var u=l(a("VXEj")),c=l(a("jehZ"));a("IzEo");var h=l(a("bx4M"));a("5Dmo");var m=l(a("3S7+"));a("+BJd");var g=l(a("mr32"));a("/xke");var f=l(a("TeRw")),v=l(a("p0pE"));a("y8nQ");var y=l(a("Vl3Y"));a("Znn+");var _=l(a("ZTPi"));a("OaEy");var b,C,S,k,A=l(a("2fM7")),E=a("MuoO"),M=a("7DNP"),x=i(a("q1tI")),T=a("LLXN"),w=l(a("/VoG")),L=l(a("d5pB")),P=l(a("fXYz")),N=l(a("e6Ls")),O=l(a("xNuS")),I=l(a("hH+r")),R=l(a("iPMB")),z=l(a("EGgK")),B=l(a("bwcx")),D=a("34ay"),H=a("vSx2"),F=l(a("QDog")),V=l(a("hMqj")),j=l(a("ZgmS")),G=l(a("yxQP")),q=A.default.Option,K=_.default.TabPane,X=(b=(0,E.connect)(e=>{var t=e.global,a=e.loading,l=e.teamControl,i=e.enterprise;return{loading:a,enterprise:t.enterprise,currentTeam:l.currentTeam,currentRegionName:l.currentRegionName,currentEnterprise:i.currentEnterprise,currentTeamPermissionsInfo:l.currentTeamPermissionsInfo}},null,null,{pure:!1}),C=y.default.create(),b(S=C((k=class extends x.PureComponent{constructor(e){super(e),this.onCancelCreate=(()=>{this.setState({showCreate:null,helmCreate:null,addAppLoading:!1})}),this.getCloudRecommendApps=(e=>{var t=this.state.currentKey,a=this.props.currentEnterprise;this.props.dispatch({type:"market/fetchMarkets",payload:{name:t,enterprise_id:a.enterprise_id,query:e?"":this.state.cloudApp_name||"",pageSize:e?9:this.state.cloudPageSize,page:e?1:this.state.cloudPage,is_plugin:!0},callback:e=>{e?this.setState({cloudList:e.list||[],cloudTotal:e.total},()=>{e._code&&210===e.status_code&&e._condition&&10503===e._condition?this.setState({isSpincloudList:-1,networkText:e.msg_show}):this.setState({isSpincloudList:!1})}):this.setState({isSpincloudList:!1})}})}),this.getApps=(e=>{var t=this.props,a=t.currentEnterprise,l=t.dispatch,i=this.state.scopeMax;if(i&&"localApplication"!==i)return null;l({type:"market/fetchAppModels",payload:{enterprise_id:a.enterprise_id,app_name:e?"":this.state.app_name||"",scope:e?"":this.state.scope,page_size:e?9:this.state.pageSize,page:e?1:this.state.page,need_install:!0,is_complete:1,is_plugin:!0},callback:e=>{e?this.setState({list:e.list||[],total:e.total},()=>{this.setState({isSpinList:!1})}):this.setState({isSpinList:!1})}})}),this.getMarketsTab=(()=>{var e=this.props,t=e.dispatch,a=e.currentEnterprise,l=this.state.scopeMax;t({type:"market/fetchMarketsTab",payload:{enterprise_id:a.enterprise_id},callback:e=>{var t=e&&e.list||[],a=[];t&&t.length>0&&t.map(e=>{var t=e.name,l=e.status,i=e.alias;1===l&&a.push(Object.assign({},e,{tab:i||t,key:t}))}),this.setState({rainStoreTab:a}),l&&"localApplication"!==l&&this.handleTabMaxChange(l)}})}),this.getHelmMarketsTab=(()=>{var e=this.props,t=e.dispatch,a=e.currentEnterprise,l=e.isHelm,i=void 0===l||l;i&&t({type:"market/fetchHelmMarketsTab",payload:{enterprise_id:a.enterprise_id},callback:e=>{if(e&&200===e.status_code){var t=[];Array.isArray(e)&&e.map(e=>{t.push(Object.assign({},e,{tab:e.name,key:"Helm-".concat(e.name)}))}),this.setState({helmStoreTab:t})}}})}),this.getHelmAppStore=(e=>{var t=this.props,a=t.dispatch,l=t.currentEnterprise,i=this.state.helmPag,s=Object.assign({},{name:e,enterprise_id:l.enterprise_id},i);a({type:"market/fetchHelmAppStore",payload:s,callback:e=>{if(e&&200===e.status_code){var t=Object.assign({},i,{total:e&&e.length||0}),a=[];if(Array.isArray(e)){var l=i.query,s=i.page;if(l){var n=[],r=l.length;e.map(e=>{if(r<=e.name.length){var t=e.name.substring(0,r);t.indexOf(l)>-1&&n.push(e)}}),t.total=n.length,a=n.length>9?n.splice(9*(s-1),9):n}else a=e.splice(s>1?9*(s-1):0,9)}this.setState({helmLoading:!1,helmList:a,helmPag:t})}}})}),this.handleSearch=(e=>{var t=this.state.scopeMax;if("localApplication"===t)this.setState({app_name:e,page:1},()=>{this.getApps()});else if(t.indexOf("Helm-")>-1){var a=this.state.helmPag,l=Object.assign({},a,{page:1,query:e});this.setState({helmPag:l},()=>{this.getHelmAppStore(t.slice(5))})}else this.setState({cloudApp_name:e,cloudPage:1},()=>{this.getCloudRecommendApps()})}),this.hanldePageChange=(e=>{this.setState({page:e},()=>{this.getApps()})}),this.hanldeCloudPageChange=(e=>{this.setState({cloudPage:e},()=>{this.getCloudRecommendApps()})}),this.hanldeHelmPageChange=(e=>{var t=this.state,a=t.helmPag,l=t.scopeMax,i=Object.assign({},a,{page:e});this.setState({helmPag:i},()=>{this.getHelmAppStore(l.slice(5))})}),this.handleTabChange=(e=>{this.setState({scope:e,page:1},()=>{this.getApps()})}),this.handleTabMaxChange=(e=>{this.setState({page:1,cloudPage:1,currentKey:e,scopeMax:e,isSpinList:!0,isSpincloudList:!0,app_name:"",cloudApp_name:""},()=>{"localApplication"===e?this.getApps("reset"):e.indexOf("Helm-")>-1?this.getHelmAppStore(e.slice(5)):this.getCloudRecommendApps("reset")})}),this.showCreate=(e=>{var t=this.state.handleType;t?this.setState({installBounced:e}):this.setState({showCreate:e})}),this.handleHelmIntall=(e=>{var t=this.state,a=t.scopeMax,l=t.helmStoreTab,i={};l.map(e=>{e.key===a&&(i=e)}),this.setState({helmCreate:Object.assign({},e,i,{app_store_name:a.slice(5)})})}),this.handleInstallBounced=(e=>{e.preventDefault();var t=this.props,a=t.form,l=t.dispatch,i=t.groupId,s=t.refreshCurrent,n=this.state,r=n.installBounced,o=n.is_deploy,p=n.scopeMax,d=n.handleType,u=n.currentKey,c=F.default.getCurrTeamName(),h=F.default.getCurrRegionName();a.validateFields((e,t)=>{e||l({type:"createApp/installAppPlugin",payload:{team_name:c,region_name:h,group_id:i||0,app_id:r.app_id,is_deploy:o,group_key:r.ID,app_version:t.group_version,marketName:u,install_from_cloud:"localApplication"!==p},callback:()=>{l({type:"global/fetchGroups",payload:{team_name:c}}),this.setState({installBounced:!1,is_deploy:!0}),d&&s&&s(),l(M.routerRedux.push("/team/".concat(c,"/region/").concat(F.default.getCurrRegionName(),"/myplugns")))}})})}),this.onChangeSelect=((e,t)=>{var a=this.props.dispatch,l=this.state,i=l.showCreate,s=l.currentKey,n=(l.btnStatus,F.default.getCurrTeamName()),r=F.default.getCurrRegionName();a({type:"createApp/changeAppVersions",payload:(0,v.default)({team_name:n,region_name:r},e,{app_id:i.app_id,is_deploy:t,group_key:i.group_key,app_version:e.group_version,marketName:s}),callback:e=>{this.setState({btnStatus:e.bean.status})}})}),this.onChangeSelectCloud=((e,t)=>{var a=this.props.dispatch,l=this.state,i=l.showCreate,s=l.currentKey,n=(l.btnStatus,l.scopeMax),r=F.default.getCurrTeamName(),o=F.default.getCurrRegionName();a({type:"createApp/changeAppVersions",payload:(0,v.default)({team_name:r,region_name:o},e,{app_id:i.app_id,is_deploy:t,group_key:i.group_key,app_version:e.group_version,marketName:s,install_from_cloud:"localApplication"!==n}),callback:e=>{this.setState({btnStatus:e.bean.status})}})}),this.handleCreate=((e,t)=>{this.setState({addAppLoading:!0});var a=this.props.dispatch,l=this.state,i=l.showCreate,s=l.currentKey,n=F.default.getCurrTeamName(),r=F.default.getCurrRegionName();a({type:"createApp/installAppPlugin",payload:(0,v.default)({team_name:n,region_name:r},e,{app_id:i.app_id,is_deploy:t,group_key:i.group_key,app_version:e.group_version,marketName:s}),callback:()=>{a({type:"global/fetchGroups",payload:{team_name:n},callback:()=>{this.onCancelCreate(),a(M.routerRedux.push("/team/".concat(n,"/region/").concat(F.default.getCurrRegionName(),"/myplugns")))}})}})}),this.handleCreateHelm=((e,t)=>{var a=this.props.dispatch,l=F.default.getCurrTeamName();this.setState({helmInstallLoading:!0}),a({type:"createApp/installHelmApp",payload:(0,v.default)({team_name:l},e,{is_deploy:t}),callback:e=>{a({type:"global/fetchGroups",payload:{team_name:l},callback:()=>{e&&200===e.status_code&&e.bean&&e.bean.ID&&(this.onCancelCreate(),a(M.routerRedux.push("/team/".concat(l,"/region/").concat(F.default.getCurrRegionName(),"/apps/").concat(e.bean.ID)))),this.setState({helmInstallLoading:!1})},renderError:()=>{this.setState({helmInstallLoading:!1})}})}})}),this.handleCloudCreate=((e,t)=>{this.setState({addAppLoading:!0});var a=this.state,l=a.scopeMax,i=a.currentKey,s=(this.props.groupId,this.state.showCreate),n=F.default.getCurrTeamName(),r=F.default.getCurrRegionName();this.props.dispatch({type:"createApp/installAppPlugin",payload:(0,v.default)({app_id:s.app_id,team_name:n,region_name:r},e,{is_deploy:t,app_versions:s.app_versions,group_key:s.app_key_id,app_version:e.group_version,install_from_cloud:"localApplication"!==l,marketName:i}),callback:e=>{this.props.dispatch({type:"global/fetchGroups",payload:{team_name:F.default.getCurrTeamName()},callback:()=>{f.default.success({message:(0,T.formatMessage)({id:"notification.success.install_success"})}),this.onCancelCreate(),this.setState({is_deploy:!0}),this.props.dispatch(M.routerRedux.push("/team/".concat(n,"/region/").concat(F.default.getCurrRegionName(),"/myplugns")))}})}})}),this.handleVisibleChange=((e,t)=>{var a=this.state.visiblebox,l=e.ID;a[l]=t,this.setState({visiblebox:a}),this.queryExport(e)}),this.showMarketAppDetail=(e=>{e&&e.app_detail_url?window.open(e.app_detail_url,"_blank"):this.setState({showApp:e,showMarketAppDetail:!0})}),this.hideMarketAppDetail=(()=>{this.setState({showApp:{},showMarketAppDetail:!1})}),this.loadMore=(()=>{var e=this.state.scopeMax;this.props.handleServiceComponent(e)}),this.handleTabs=((e,t)=>{var a=this.state.handleType;return x.default.createElement(_.default,{defaultActiveKey:"",onChange:this.handleTabChange,style:{background:"#fff",padding:a?"0 20px 20px":"20px "}},e.map(e=>{var a=e.key,l=e.tab;return x.default.createElement(K,{tab:l,key:a},x.default.createElement("div",{className:G.default.cardList,style:{paddingBottom:"20px"}},t))}))}),this.renderApp=((e,t,l)=>{var i=this.state,s=i.scopeMax,n=i.handleType,r="localApplication"!=s,o=e=>x.default.createElement("div",{title:e.app_name||e.name||"",style:{maxWidth:"200px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},x.default.createElement("a",{onClick:()=>{this.showMarketAppDetail(e)}},e.app_name||e.name)),p=x.default.createElement("div",{title:e.version,className:G.default.cardVersionStyle},x.default.createElement("span",null,"\u7248\u672c:"),x.default.createElement("div",{className:G.default.overScroll},x.default.createElement("div",null,e.versions_info&&e.versions_info.map((e,t)=>{return x.default.createElement(g.default,{title:e.version,className:G.default.cardVersionTagStyle,color:"green",size:"small",key:t},e.version)}),e.versions&&e.versions.map((e,t)=>{return x.default.createElement(g.default,{className:G.default.cardVersionTagStyle,color:"green",size:"small",title:e.app_version||e.version,key:t},e.app_version||e.version)})))),d=[x.default.createElement(m.default,{title:t?"\u70b9\u51fb\u5b89\u88c5":"\u4e0d\u53ef\u5b89\u88c5"},x.default.createElement("div",{onClick:()=>{t&&this.showCreate(e)}},x.default.createElement("div",{className:G.default.cardTitle},x.default.createElement("span",{title:e.app_name},e.app_name)),p))],u=t?[x.default.createElement("span",{onClick:()=>{"helm"===l?this.handleHelmIntall(e):this.showCreate(e)}},(0,T.formatMessage)({id:"button.install"}))]:[],c=a("Vkwn");return x.default.createElement(x.Fragment,null,(1==e.is_official||1==e.is_official)&&x.default.createElement(I.default,{style:{marginLeft:6,marginTop:6}}),x.default.createElement(h.default,{className:n?"".concat(G.default.cards," ").concat(G.default.clearAvatar):G.default.cards,actions:n?d:u},x.default.createElement(h.default.Meta,{className:G.default.cardsMetas,style:n&&{height:80,overflow:"hidden",display:"flex",justifyContent:"center",cursor:"pointer"},avatar:x.default.createElement("img",{style:n?{width:80,height:80,margin:" 0 auto"}:{width:110,height:110,margin:" 0 auto"},alt:e.title,src:r?e.logo||e.icon||c:e.pic||c,height:n?154:80,onClick:()=>{this.showMarketAppDetail(e)}}),title:n?"":o(e),description:n?"":x.default.createElement(x.Fragment,null,x.default.createElement("span",{style:{display:"block",color:"rgb(200, 200, 200)",marginBottom:2,fontSize:12}},p,!r&&x.default.createElement("div",{className:G.default.memoryStyle},x.default.createElement("span",null,"\u5185\u5b58: "),j.default.unit(e.min_memory||128,"MB"))),x.default.createElement(O.default,{className:G.default.item,lines:3},x.default.createElement("span",{title:e.describe||e.description},e.describe||e.description)))})))}),this.renderSuccessOnChange=(()=>{this.setState({is_deploy:!this.state.is_deploy})}),this.renderFormComponent=(()=>{var e={labelCol:{span:5},wrapperCol:{span:19}},t=this.props.form,a=t.getFieldDecorator,l=this.state.installBounced,i=l.versions_info||l.versions;return x.default.createElement(y.default,{onSubmit:this.handleInstallBounced,layout:"horizontal",hideRequiredMark:!0},x.default.createElement(y.default.Item,(0,c.default)({},e,{label:"\u9009\u62e9\u7248\u672c"}),a("group_version",{initialValue:i[0].version||i[0].app_version,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7248\u672c"}]})(x.default.createElement(A.default,{getPopupContainer:e=>e.parentNode,style:{width:"220px"}},i.map(e=>{return x.default.createElement(q,{key:e.version,value:e.version||e.app_version},e.version||e.app_version)})))))}),this.handleCertification=(e=>{this.setState({authorizations:e})});var t=this.props,l=t.handleType,i=void 0===l?"":l,s=t.match,n=t.scope,r=void 0===n?"":n,o=t.moreState,p=t.scopeMax,d=decodeURIComponent("Service"===i?"":s&&s.params&&s.params.keyword||"");this.state={helmInstallLoading:!1,list:[],authorizations:!1,app_name:d,page:1,pageSize:9,total:0,isSpinList:!0,isSpincloudList:!0,networkText:"",cloudList:[],cloudApp_name:"",cloudPage:1,cloudPageSize:9,cloudTotal:0,helmCreate:null,showCreate:null,scope:r,scopeMax:p||"localApplication",showApp:{},showMarketAppDetail:!1,installBounced:!1,handleType:i||null,moreState:o||null,is_deploy:!0,btnStatus:"",localAppTab:[{key:"localApplication",tab:(0,T.formatMessage)({id:"popover.applicationMarket.local"})}],rainStoreTab:[],helmStoreTab:[],currentKey:"",helmList:[],helmLoading:!0,helmPag:{pageSize:9,total:0,page:1,query:""},addAppLoading:!1},this.mount=!1}componentWillMount(){var e=this.props,t=e.currentTeamPermissionsInfo,a=e.dispatch;V.default.canCreateComponent(t,a)}componentDidMount(){this.mount=!0,this.getApps(),this.getMarketsTab(),this.getHelmMarketsTab()}componentWillUnmount(){this.mount=!1,this.mountquery=!1}render(){var e=this.props,t=e.loading,a=e.currentEnterprise,l=e.currentTeam,i=e.currentRegionName,c=e.isHelm,h=void 0===c||c,m=e.isAddMarket,g=this.state,f=g.handleType,v=g.moreState,y=g.installBounced,_=g.list,b=g.scopeMax,C=g.cloudList,S=g.cloudPage,k=g.cloudPageSize,A=g.cloudTotal,E=g.isSpinList,M=g.isSpincloudList,O=g.networkText,I=g.page,V=g.pageSize,j=g.total,q=g.helmInstallLoading,K=g.currentKey,X=g.authorizations,Q=g.showCreate,J=g.showMarketAppDetail,Z=g.showApp,W=g.is_deploy,U=g.app_name,Y=g.cloudApp_name,$=g.helmList,ee=g.helmPag,te=g.helmLoading,ae=g.helmCreate,le=g.addAppLoading,ie=g.localAppTab,se=g.rainStoreTab,ne=g.helmStoreTab,re=g.btnStatus,oe=(F.default.fetchSvg("dockerSvg"),!!v),pe={current:v?1:I,pageSize:v?3:V,total:v?1:j,hideOnSinglePage:oe,onChange:e=>{this.hanldePageChange(e)}},de={current:v?1:S,pageSize:v?3:k,total:v?1:A,hideOnSinglePage:oe,onChange:e=>{this.hanldeCloudPageChange(e)}},ue={current:v?1:ee.page,pageSize:v?3:ee.pageSize,total:v?1:ee.total,hideOnSinglePage:oe,onChange:e=>{this.hanldeHelmPageChange(e)}},ce=!0,he=[...ie,...se,...ne];if(he&&he.length>0){var me=he.filter(e=>{return e.name===K});me&&me.length>0&&(ce=(0,D.fetchMarketAuthority)(me[0],"ReadInstall"))}var ge=f&&v&&("localApplication"===b&&_&&_.length>0||"localApplication"!=b&&C&&C.length>0)&&x.default.createElement("div",{style:{textAlign:"right",height:"70px",marginTop:"-40px",position:"relative",zIndex:99}},x.default.createElement("a",{onClick:this.loadMore},"\u67e5\u770b\u66f4\u591a...")),fe=x.default.createElement(u.default,{bordered:!1,grid:{gutter:24,lg:3,md:2,sm:1,xs:1},locale:{emptyText:!E&&_&&_.length<=0&&x.default.createElement("p",{style:{paddingTop:80,lineHeight:1.3}},(0,T.formatMessage)({id:"notification.market.hint.null_app1"}),x.default.createElement("br",null),x.default.createElement("br",null),(0,T.formatMessage)({id:"notification.market.hint.null_app2"}))},pagination:pe,dataSource:_,renderItem:e=>x.default.createElement(u.default.Item,{style:{border:"none"}},this.renderApp(e,!0))}),ve=x.default.createElement(u.default,{bordered:!1,grid:{gutter:24,lg:3,md:2,sm:1,xs:1},pagination:de,dataSource:C,renderItem:e=>x.default.createElement(u.default.Item,{style:{border:"none"}},this.renderApp(e,ce))}),ye=x.default.createElement(u.default,{bordered:!1,grid:{gutter:24,lg:3,md:2,sm:1,xs:1},pagination:ue,dataSource:$,renderItem:e=>{var t=e;return e.versions&&e.versions.length>0&&(t=Object.assign({},e,e.versions[0])),x.default.createElement(u.default.Item,{style:{border:"none"}},this.renderApp(t,!0,"helm"))}}),_e="localApplication"==b?U:Y,be=x.default.createElement("div",{style:{textAlign:"center"}},x.default.createElement("span",{id:"searchWrap",style:{display:"inline-block"}},x.default.createElement(d.default.Search,{ref:"searchs",placeholder:(0,T.formatMessage)({id:"placeholder.group_name"}),enterButton:(0,T.formatMessage)({id:"button.search"}),size:"large",value:_e,onChange:e=>{this.setState({app_name:e.target.value,cloudApp_name:e.target.value})},defaultValue:_e,onSearch:this.handleSearch,style:{width:500}}))),Ce=[{key:"",tab:(0,T.formatMessage)({id:"popover.applicationMarket.all"})}],Se=[{key:"enterprise",tab:(0,T.formatMessage)({id:"popover.applicationMarket.company"})},{key:"team",tab:(0,T.formatMessage)({id:"popover.applicationMarket.team"})}],ke=Ce.concat(Se),Ae=[];Ae=(0,H.createTeam)((0,H.createEnterprise)(Ae,a),l,i),Ae.push({title:"\u521b\u5efa\u7ec4\u4ef6"});var Ee=x.default.createElement("div",{style:{height:"255px",lineHeight:"255px",textAlign:"center"}},x.default.createElement(p.default,{size:"large"}));return x.default.createElement("div",null,X&&x.default.createElement(w.default,{eid:a.enterprise_id,marketName:X,title:"\u83b7\u53d6\u4e91\u5e94\u7528\u5546\u5e97\u6388\u6743",onCancel:()=>{this.setState({authorizations:!1})},currStep:2}),ae&&x.default.createElement(L.default,{installLoading:q,data:ae,onSubmit:this.handleCreateHelm,onCancel:this.onCancelCreate}),Q&&x.default.createElement(P.default,{disabled:t.effects["createApp/installAppPlugin"],onChangeSelect:f?this.onChangeSelect:"localApplication"==b?this.onChangeSelect:this.onChangeSelectCloud,btnStatus:re,onSubmit:f?this.handleCreate:"localApplication"==b?this.handleCreate:this.handleCloudCreate,onCancel:this.onCancelCreate,showCreate:Q,addAppLoading:le}),J&&x.default.createElement(R.default,{onOk:this.hideMarketAppDetail,onCancel:this.hideMarketAppDetail,app:Z}),f&&y&&x.default.createElement(n.default,{title:(0,T.formatMessage)({id:"confirmModal.install.app.desc"}),className:N.default.TelescopicModal,visible:y,onOk:this.handleInstallBounced,onCancel:()=>{this.setState({installBounced:!1})},footer:x.default.createElement("div",null,x.default.createElement(o.default,{onClick:()=>{this.setState({installBounced:!1,is_deploy:!0})}},(0,T.formatMessage)({id:"button.cancel"})),x.default.createElement(o.default,{onClick:this.handleInstallBounced,type:"primary",style:{marginRight:"5px"},loading:t.effects["createApp/installAppPlugin"]},(0,T.formatMessage)({id:"button.install"})),x.default.createElement(r.default,{size:"small",onClick:this.renderSuccessOnChange,checked:W},(0,T.formatMessage)({id:"button.build_start"})))},y.describe&&x.default.createElement("p",{style:{background:"rgba(22, 184, 248, 0.1)",padding:"8px"}},y.describe),this.renderFormComponent()),he&&he.length>0&&m?x.default.createElement("div",null,x.default.createElement(z.default,{isAddMarket:this.props.isAddMarket,isSvg:!0,breadcrumbList:Ae,content:f&&v?"":be,tabList:he,tabActiveKey:b,onTabChange:this.handleTabMaxChange,isFooter:!!f},"localApplication"!==b&&!ce&&x.default.createElement(s.default,{message:x.default.createElement("div",null,(0,T.formatMessage)({id:"notification.market.hint.null_app5"}),x.default.createElement("a",{onClick:()=>{this.handleCertification(b)}},(0,T.formatMessage)({id:"notification.market.hint.null_app6"}))),type:"success",style:{margin:"-10px 0 15px 0"}}),b.indexOf("Helm-")>-1&&h?x.default.createElement("div",null,te?Ee:ye):"localApplication"===b?x.default.createElement("div",{style:{marginBottom:!v&&f&&"Service"===f&&"40px"}},E?Ee:this.handleTabs(ke,fe)):x.default.createElement("div",null,M&&-1!==M?Ee:x.default.createElement("div",null,x.default.createElement("div",{className:G.default.cardList,style:{paddingBottom:"20px",marginBottom:v?"0px":"40px"}},-1!==M&&ve,O&&x.default.createElement(s.default,{style:{textAlign:"center",marginBottom:16},message:O,type:"warning"})))),ge)):x.default.createElement("div",null,x.default.createElement(B.default,{isAddMarket:this.props.isAddMarket,isSvg:!0,breadcrumbList:Ae,content:f&&v?"":be,tabList:he,tabActiveKey:b,onTabChange:this.handleTabMaxChange,isFooter:!!f},"localApplication"!==b&&!ce&&x.default.createElement(s.default,{message:x.default.createElement("div",null,(0,T.formatMessage)({id:"notification.market.hint.null_app5"}),x.default.createElement("a",{onClick:()=>{this.handleCertification(b)}},(0,T.formatMessage)({id:"notification.market.hint.null_app6"}))),type:"success",style:{margin:"-10px 0 15px 0"}}),b.indexOf("Helm-")>-1&&h?x.default.createElement("div",null,te?Ee:ye):"localApplication"===b?x.default.createElement("div",{style:{marginBottom:!v&&f&&"Service"===f&&"40px"}},E?Ee:this.handleTabs(ke,fe)):x.default.createElement("div",null,M&&-1!==M?Ee:x.default.createElement("div",null,x.default.createElement("div",{className:G.default.cardList,style:{paddingBottom:"20px",marginBottom:v?"0px":"40px"}},-1!==M&&ve,O&&x.default.createElement(s.default,{style:{textAlign:"center",marginBottom:16},message:O,type:"warning"})))),ge)))}},S=k))||S)||S);t.default=X},fXYz:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV")),n=l(a("jehZ"));a("+L6B");var r=l(a("2/Rp"));a("y8nQ");var o=l(a("Vl3Y"));a("OaEy");var p,d,u,c,h=l(a("2fM7")),m=a("MuoO"),g=i(a("q1tI")),f=a("LLXN"),v=(l(a("qCJ4")),l(a("QDog"))),y=l(a("e6Ls")),_=h.default.Option,b={labelCol:{span:7},wrapperCol:{span:17}},C=(p=(0,m.connect)(e=>{var t=e.global;return{groups:t.groups}},null,null,{withRef:!0}),d=o.default.create(),p(u=d((c=class extends g.PureComponent{constructor(e){super(e),this.onAddGroup=(()=>{this.setState({addGroup:!0})}),this.cancelAddGroup=(()=>{this.setState({addGroup:!1})}),this.handleAddGroup=(e=>{var t=this.props.form.setFieldsValue;t({group_id:e}),this.cancelAddGroup()}),this.handleChangeVersion=(e=>{var t=this.state.is_deploy,a=this.props,l=a.onChangeSelect,i=a.showCreate;if(e){var s={group_version:e};l(s,t)}else{var n={group_version:i.versions_info?i.versions_info[0].version:i.versions[0].app_version};l(n,t)}}),this.fetchGroup=(()=>{this.props.dispatch({type:"global/fetchGroups",payload:{team_name:v.default.getCurrTeamName()}})}),this.handleSubmit=(e=>{e.preventDefault();var t=this.state.is_deploy,a=this.props,l=a.form,i=a.onSubmit;l.validateFields((e,a)=>{!e&&i&&(i(a,t),this.setState({is_deploy:!0}))})}),this.renderSuccessOnChange=(()=>{this.setState({is_deploy:!this.state.is_deploy})}),this.state={addGroup:!1,is_deploy:!0}}componentDidMount(){this.handleChangeVersion()}render(){var e=this.props.form.getFieldDecorator,t=this.props,a=(t.groups,t.onCancel),l=t.showCreate,i=t.addAppLoading,p=t.disabled,d=t.btnStatus,u=(this.props.data,l&&l.versions_info&&l.versions_info.length>0&&l.versions_info),c=l&&l.versions&&l.versions.length>0&&l.versions;return g.default.createElement(s.default,{className:y.default.TelescopicModal,visible:l,onCancel:a,onOk:this.handleSubmit,title:(0,f.formatMessage)({id:"teamOther.CreateAppFromMarketForm.title"}),footer:[g.default.createElement("div",{style:{display:"flex",marginLeft:"120px"}},g.default.createElement(r.default,{onClick:a},(0,f.formatMessage)({id:"button.cancel"})),g.default.createElement("div",null,d&&"Installable"==d?g.default.createElement(r.default,{onClick:this.handleSubmit,type:"primary",style:{marginRight:"5px"},loading:i||p},(0,f.formatMessage)({id:"button.install"})):"AlreadyInstalled"==d?g.default.createElement(r.default,{type:"primary",style:{marginRight:"5px"},disabled:!0},(0,f.formatMessage)({id:"teamOther.CreateAppFromPlugin.been_installed"})):"Upgradeable"==d?g.default.createElement(r.default,{onClick:this.handleSubmit,type:"primary",style:{marginRight:"5px"},loading:i||p},(0,f.formatMessage)({id:"teamOther.CreateAppFromPlugin.upgrade"})):g.default.createElement(r.default,{onClick:this.handleSubmit,type:"primary",style:{marginRight:"5px"},loading:i||p},(0,f.formatMessage)({id:"button.install"}))))]},g.default.createElement(o.default,{onSubmit:this.handleOk,layout:"horizontal",hideRequiredMark:!0},g.default.createElement(o.default.Item,(0,n.default)({},b,{label:(0,f.formatMessage)({id:"teamOther.CreateAppFromMarketForm.install"})}),e("group_version",{initialValue:u?u[0].version:c?c[0].app_version:"",rules:[{required:!0,message:(0,f.formatMessage)({id:"teamOther.CreateAppFromMarketForm.setect"})}]})(g.default.createElement(h.default,{getPopupContainer:e=>e.parentNode,onChange:this.handleChangeVersion,style:{width:"220px"}},u?u.map((e,t)=>{return g.default.createElement(_,{key:t,value:e.version},e.version)}):c&&c.map((e,t)=>{return g.default.createElement(_,{key:t,value:e.app_version},e.app_version)}))))))}},u=c))||u)||u);t.default=C}}]);