(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{"+aXB":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("6UJt");var i=l(a("DFOY"));a("y8nQ");var r=l(a("Vl3Y"));a("5NDa");var o=l(a("5rEg"));a("+L6B");var d=l(a("2/Rp"));a("OaEy");var c,u,m,p=l(a("2fM7")),f=a("MuoO"),h=n(a("q1tI")),g=l(a("PWDA")),v=l(a("cUW5")),y=a("xpXo"),b=l(a("lpA0")),_=l(a("QDog")),E=l(a("OSFV")),w=l(a("a8l+")),M=l(a("zMIy")),C=a("LLXN"),S=p.default.Option,O=(c=(0,f.connect)(e=>{var t=e.user;return{currUser:t.currentUser}},null,null,{withRef:!0}),c((m=class extends h.PureComponent{constructor(e){super(e),this.formRef=h.default.createRef(),this.fetchInstanceInfo=(()=>{var e=this.props,t=e.dispatch,a=e.appAlias;t({type:"appControl/fetchPods",payload:{team_name:_.default.getCurrTeamName(),app_alias:a},callback:e=>{var t=[];if(e&&e.list){var a=e.list.new_pods&&e.list.new_pods.length&&e.list.new_pods||[],l=e.list.old_pods&&e.list.old_pods.length&&e.list.old_pods||[];t=[...a,...l]}t&&t.length>0&&t.map(e=>{e.name="".concat((0,C.formatMessage)({id:"componentOverview.body.tab.log.exampleName"},{name:e.pod_name})),e.container.map(e=>{e.name="".concat((0,C.formatMessage)({id:"componentOverview.body.tab.log.containerName"},{name:e.container_name}))})}),t.push({name:(0,C.formatMessage)({id:"componentOverview.body.tab.log.allLogs"})}),this.setState({instances:t})}})}),this.onFinish=(e=>{this.setState({filter:e},()=>{var t=this.state,a=t.logs,l=t.pod_name;""===e?l?this.fetchContainerLog():this.fetchServiceLog():this.setLogs(a)})}),this.setLogs=(e=>{var t=this.state,a=t.filter,l=t.pod_name,n=e;n=e.filter(e=>{return""==a||-1!=e.indexOf(a)}),n=n.map(e=>{if(-1!=e.indexOf(a)){var t=e.replace(a,"\x1b[33m".concat(a,"\x1b[0m"));return t}return e}),n.length>5e3&&(n=n.slice(e.length-5e3,e.length));var s=l?{containerLog:n}:{logs:n};this.setState(s)}),this.fetchServiceLog=(()=>{(0,y.getServiceLog)({team_name:_.default.getCurrTeamName(),app_alias:this.props.appAlias}).then(e=>{e&&(this.refs.box&&(this.refs.box.scrollTop=this.refs.box.scrollHeight),this.setState({logs:e.list||[]}),this.watchLog())})}),this.hanleTimer=(()=>{var e=this.state.refreshValue;if(this.closeTimer(),!e)return null;this.timer=setTimeout(()=>{this.fetchContainerLog()},1e3*e)}),this.closeTimer=(()=>{this.timer&&clearInterval(this.timer)}),this.fetchContainerLog=(()=>{var e=this.state,t=e.pod_name,a=e.container_name;(0,y.getContainerLog)({team_name:_.default.getCurrTeamName(),app_alias:this.props.appAlias,pod_name:t,container_name:a}).then(e=>{if(e&&e.status_code&&200===e.status_code&&e.response_data){var t=e.response_data.split("\n");this.setState({containerLog:t||[]},()=>{this.hanleTimer()})}})}),this.handleStop=(()=>{this.setState({started:!1}),this.props.socket&&this.props.socket.closeLogMessage()}),this.handleStart=(()=>{this.setState({started:!0}),this.watchLog()}),this.showDownHistoryLog=(()=>{this.setState({showHistoryLog:!0})}),this.hideDownHistoryLog=(()=>{this.setState({showHistoryLog:!1})}),this.showDownHistory1000Log=(()=>{this.setState({showHistory1000Log:!0})}),this.hideDownHistory1000Log=(()=>{this.setState({showHistory1000Log:!1})}),this.onChangeCascader=(e=>{e&&e.length>1?this.setState({pod_name:e[0].slice(3),container_name:e[1].slice(3)},()=>{this.fetchContainerLog()}):this.setState({pod_name:"",container_name:"",containerLog:[]},()=>{this.closeTimer(),this.fetchServiceLog()})}),this.handleChange=(e=>{this.setState({refreshValue:e}),e||this.closeTimer()}),this.state={containerLog:[],logs:[],instances:[],started:!0,showHistoryLog:!1,showHistory1000Log:!1,showHighlighted:"",filter:"",pod_name:"",container_name:"",refreshValue:5}}componentDidMount(){this.canView()&&(this.loadLog(),this.fetchInstanceInfo())}componentDidUpdate(e,t){this.refs.box&&t.logs.length!==this.state.logs.length&&""===this.state.showHighlighted&&(this.refs.box.scrollTop=this.refs.box.scrollHeight)}componentWillUnmount(){this.props.socket&&this.props.socket.closeLogMessage()}watchLog(){this.props.socket&&this.props.socket.setOnLogMessage(e=>{if(e&&e.length>0){var t=this.state.logs||[],a=t.concat(e);this.setLogs(a)}},e=>{if(this.state.started){var t=this.state.logs||[];t=t.concat(e),this.refs.box&&(this.refs.box.scrollTop=this.refs.box.scrollHeight),this.setLogs(t)}})}loadLog(){var e=this.state.logs;0==e.length?this.fetchServiceLog():this.watchLog()}canView(){return b.default.canManageAppLog(this.props.appDetail)}render(){if(!this.canView())return h.default.createElement(v.default,null);var e=this.props.appAlias,t=this.state,a=t.logs,l=t.pod_name,n=t.containerLog,c=t.showHighlighted,u=t.instances,m=t.started,f=t.refreshValue,y=t.showHistoryLog,b=t.showHistory1000Log;return h.default.createElement(s.default,{title:h.default.createElement(h.Fragment,null,m?h.default.createElement(d.default,{onClick:this.handleStop},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.log.push"})):h.default.createElement(d.default,{onClick:this.handleStart},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.log.startPushing"}))),extra:h.default.createElement(h.Fragment,null,h.default.createElement("a",{onClick:this.showDownHistoryLog,style:{marginRight:10}},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.log.install"})),h.default.createElement("a",{onClick:this.showDownHistory1000Log},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.log.lately"})))},h.default.createElement(r.default,{layout:"inline",name:"logFilter",style:{marginBottom:"16px"}},h.default.createElement(r.default.Item,{name:"filter",label:h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.log.text"}),style:{marginRight:"10px"}},h.default.createElement(o.default.Search,{style:{width:"300px"},placeholder:(0,C.formatMessage)({id:"componentOverview.body.tab.log.filtertext"}),onSearch:this.onFinish})),h.default.createElement(r.default.Item,{name:"container",label:h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.log.container"}),style:{marginRight:"10px"},className:M.default.podCascader},h.default.createElement(i.default,{defaultValue:["".concat((0,C.formatMessage)({id:"componentOverview.body.tab.log.allLogs"}))],fieldNames:{label:"name",value:"name",children:"container"},options:u,onChange:this.onChangeCascader,placeholder:(0,C.formatMessage)({id:"componentOverview.body.tab.log.select"})})),l&&h.default.createElement(r.default.Item,{name:"refresh",label:h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.log.refresh"}),style:{marginRight:"0"}},h.default.createElement(p.default,{value:f,onChange:this.handleChange,style:{width:130}},h.default.createElement(S,{value:5},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.log.five"})),h.default.createElement(S,{value:10},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.log.ten"})),h.default.createElement(S,{value:30},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.log.thirty"})),h.default.createElement(S,{value:0},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.log.close"}))))),h.default.createElement("div",{className:M.default.logsss,ref:"box"},n&&n.length>0&&n.map((e,t)=>{return h.default.createElement("div",{key:t},h.default.createElement("span",{style:{color:"#666666"}},h.default.createElement("span",null,t+1)),h.default.createElement("span",{ref:"texts",style:{width:"100%",color:"#FFF"}},h.default.createElement(g.default,null,e)))})||a&&a.length>0&&a.map((e,t)=>{return h.default.createElement("div",{key:t},h.default.createElement("span",{style:{color:c==e.substring(e.indexOf(":")-12,e.indexOf(":"))?"#FFFF91":"#666666"}},h.default.createElement("span",null,""==e?"":"".concat(t+1))),h.default.createElement("span",{ref:"texts",style:{color:c==e.substring(e.indexOf(":")-12,e.indexOf(":"))?"#FFFF91":"#FFF"}},h.default.createElement(g.default,null,e.substring(e.indexOf(":")+1,e.length))),1==a.length?h.default.createElement("span",{style:{color:c==e.substring(e.indexOf(":")-12,e.indexOf(":"))?"#FFFF91":"#bbb",cursor:"pointer",backgroundColor:e.substring(e.indexOf(":")-12,e.indexOf(":"))?"#666":""},onClick:()=>{this.setState({showHighlighted:c==e.substring(e.indexOf(":")-12,e.indexOf(":"))?"":e.substring(e.indexOf(":")-12,e.indexOf(":"))})}},h.default.createElement(g.default,null,e.substring(0,e.indexOf(":")))):a.length>1&&t>=1&&e.substring(e.indexOf(":")-12,e.indexOf(":"))==a[t<=0?t+1:t-1].substring(a[t<=0?t+1:t-1].indexOf(":")-12,a[t<=0?t+1:t-1].indexOf(":"))?"":h.default.createElement("span",{style:{color:c==e.substring(e.indexOf(":")-12,e.indexOf(":"))?"#FFFF91":"#bbb",cursor:"pointer",backgroundColor:0==t&&e.substring(e.indexOf(":")-12,e.indexOf(":"))?"#666":e.substring(e.indexOf(":")-12,e.indexOf(":"))==a[t<=0?t+1:t-1].substring(a[t<=0?t+1:t-1].indexOf(":")-12,a[t<=0?t+1:t-1].indexOf(":"))?"":"#666"},onClick:()=>{this.setState({showHighlighted:c==e.substring(e.indexOf(":")-12,e.indexOf(":"))?"":e.substring(e.indexOf(":")-12,e.indexOf(":"))})}},h.default.createElement(g.default,null,e.substring(0,e.indexOf(":")))))})),y&&h.default.createElement(E.default,{onCancel:this.hideDownHistoryLog,appAlias:e}),b&&h.default.createElement(w.default,{onCancel:this.hideDownHistory1000Log,appAlias:e}))}},u=m))||u);t.default=O},"+y/a":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("14J3");var i=l(a("BMrR"));a("jCWc");var r=l(a("kPKH"));a("Pwec");var o=l(a("CtXQ"));a("5Dmo");var d=l(a("3S7+"));a("y8nQ");var c,u,m,p,f=l(a("Vl3Y")),h=a("MuoO"),g=l(a("wd/R")),v=n(a("q1tI")),y=a("7DNP"),b=l(a("QDog")),_=l(a("Sw8b")),E=l(a("ctOv")),w=a("LLXN"),M=(c=(0,h.connect)(),u=f.default.create(),c(m=u((p=class extends v.PureComponent{constructor(e){var t;super(e),t=this,this.handleMore=(()=>{var e=this.props.handleMore;e&&e(!0)}),this.showLogModal=function(e,a){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=t.props,s=n.isopenLog,i=n.onLogPush;n.dispatch;"AbnormalExited"==l||"EventTypeAbnormalExited"==l?t.props.dispatch(y.routerRedux.push("/team/".concat(b.default.getCurrTeamName(),"/region/").concat(b.default.getCurrRegionName(),"/components/").concat(b.default.getComponentID(),"/log"))):s&&i&&i(!1),t.setState({logVisible:!0,selectEventID:e,showSocket:a})},this.handleCancel=(()=>{this.setState({logVisible:!1})}),this.showUserName=(e=>{return"system"===e?v.default.createElement(w.FormattedMessage,{id:"componentOverview.body.tab.overview.handle.system"}):e?"@".concat(e):""}),this.state={logVisible:!1,selectEventID:"",showSocket:!1}}componentDidMount(){}render(){var e=this.props,t=e.logList,a=e.has_next,l=e.recordLoading,n=e.isopenLog,c=this.state,u=c.logVisible,m=c.selectEventID,p=c.showSocket,f=b.default.fetchSvg("logs","#cccccc"),h="",y={success:"logpassed",timeout:"logcanceled",failure:"logfailed"};return v.default.createElement(s.default,{title:v.default.createElement(w.FormattedMessage,{id:"componentOverview.body.tab.overview.handle.operationRecord"}),loading:l},v.default.createElement(i.default,{gutter:24},v.default.createElement(r.default,{xs:24,xm:24,md:24,lg:24,xl:24},t&&t.map(e=>{var t=e.Status,a=e.FinalStatus,l=e.UserName,s=e.OptType,i=e.Reason,r=e.Message,o=e.EndTime,c=e.SynType,u=e.EventID,m=e.create_time;n&&""===a&&s&&s.indexOf("build")>-1&&""===h&&(h=u);var p=this.showUserName(l),_=b.default.fetchMessageLange(r,t,s);return v.default.createElement("div",{key:u,className:"".concat(E.default.loginfo," ").concat(E.default[y[t]||"logfored"])},v.default.createElement(d.default,{title:(0,g.default)(m).locale("zh-cn").format("YYYY-MM-DD HH:mm:ss")},v.default.createElement("div",{style:{wordBreak:"break-word",lineHeight:"17px"}},b.default.fetchdayTime(m))),v.default.createElement("div",null,v.default.createElement(d.default,{title:_},v.default.createElement("span",{style:{color:b.default.fetchAbnormalcolor(s)}},b.default.fetchStateOptTypeText(s),"\xa0"),b.default.fetchOperation(a,t),"\xa0","failure"===t&&b.default.fetchReason(i),_)),v.default.createElement("div",{className:E.default.nowarpText},v.default.createElement("span",null,v.default.createElement(d.default,{title:p},p))),v.default.createElement("div",null,v.default.createElement("span",{className:E.default.alcen},o&&m&&b.default.fetchSvg("runTime"),v.default.createElement("span",null,o&&m?b.default.fetchTime(new Date(o).getTime()?new Date(o).getTime()-new Date(m).getTime():""):""))),v.default.createElement("div",{style:{position:"static"},className:"table-wrap"},0===c&&v.default.createElement(d.default,{visible:""===a,placement:"top",arrowPointAtCenter:!0,autoAdjustOverflow:!1,title:v.default.createElement(w.FormattedMessage,{id:"componentOverview.body.tab.overview.handle.lookLog"}),getPopupContainer:()=>document.querySelector(".table-wrap")},v.default.createElement("div",{style:{width:"16px"},onClick:()=>{this.showLogModal(u,""===a,s)}},f))))}),h&&this.showLogModal(h,!0),!t||t&&0===t.length&&v.default.createElement("div",{style:{background:"#fff",paddingBottom:"10px",textAlign:"center"}},v.default.createElement(w.FormattedMessage,{id:"componentOverview.body.tab.overview.handle.handler"})),a&&v.default.createElement("p",{style:{textAlign:"center",fontSize:30}},v.default.createElement(o.default,{style:{cursor:"pointer"},onClick:this.props.handleNextPage,type:"down"})))),u&&v.default.createElement(_.default,{title:v.default.createElement(w.FormattedMessage,{id:"componentOverview.body.tab.overview.handle.log"}),width:"1000px",onOk:this.handleCancel,onCancel:this.handleCancel,showSocket:p,EventID:m,socket:this.props.socket}))}},m=p))||m)||m),C=M;t.default=C},"0//z":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV")),i=l(a("jehZ"));a("5NDa");var r=l(a("5rEg"));a("fOrg");var o=l(a("+KLJ"));a("/xke");var d=l(a("TeRw")),c=l(a("p0pE"));a("OaEy");var u=l(a("2fM7"));a("y8nQ");var m=l(a("Vl3Y"));a("Znn+");var p,f,h,g,v=l(a("ZTPi")),y=a("MuoO"),b=n(a("q1tI")),_=a("LLXN"),E=(l(a("6UP8")),a("xpXo")),w=l(a("lpA0")),M=l(a("8+Sn")),C=l(a("QDog")),S=v.default.TabPane,O=m.default.Item,k=u.default.Option,A=(p=m.default.create(),f=(0,y.connect)(),p(h=f((g=class extends b.PureComponent{constructor(e){super(e),this.changeServerType=(e=>{var t=this.props.form,a=t.getFieldValue,l=a("user_name");"oss"==e?this.setState({isFlag:!1}):this.setState({isFlag:!0}),this.setState({serverType:e,showUsernameAndPass:""!==l})}),this.checkURL=((e,t,a)=>{var l=this.getUrlCheck();l.test(t)?a():a(b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.Illegal"}))}),this.handleSubmit=(()=>{var e=this.props.form,t=this.state.tabValue;e.validateFields((e,a)=>{e||("tag"==a.version_type&&(a.code_version="tag:".concat(a.code_version)),this.props.dispatch({type:"appControl/putAppBuidSource",payload:(0,c.default)({team_name:C.default.getCurrTeamName(),service_alias:this.props.appAlias,service_source:t},a),callback:()=>{d.default.success({message:(0,_.formatMessage)({id:"notification.success.edit_deploy"})}),this.props.onOk&&this.props.onOk()}}))})}),this.hideShowKey=(()=>{this.setState({showKey:!1})}),this.handleTabs=(e=>{"2"==e?this.setState({tabValue:"docker_run"}):this.setState({tabValue:"source_code"})}),this.state={branch:this.props.branch||[],buildSource:this.props.buildSource||null,showUsernameAndPass:""!==this.props.buildSource.user,showKey:!1,isFlag:!0,tabValue:"source_code",gitUrl:this.props.buildSource.git_url,serverType:this.props.buildSource.server_type?this.props.buildSource.server_type:"git",showCode:w.default.isCodeAppByBuildSource(this.props.buildSource),showImage:w.default.isImageAppByBuildSource(this.props.buildSource),tabKey:"",language:"zh-CN"===M.default.get("language")}}componentDidMount(){w.default.isCodeAppByBuildSource(this.state.buildSource)&&this.loadBranch();var e=this.props.buildSource;"docker_image"==e.service_source||"docker_run"==e.service_source?this.setState({tabKey:"2",tabValue:"docker_run"}):this.setState({tabKey:"1",tabValue:"source_code"})}shouldComponentUpdate(){return!0}getUrlCheck(){return"svn"==this.state.serverType?/^(ssh:\/\/|svn:\/\/|http:\/\/|https:\/\/).+$/gi:/^(git@|ssh:\/\/|svn:\/\/|http:\/\/|https:\/\/).+$/gi}loadBranch(){(0,E.getCodeBranch)({team_name:C.default.getCurrTeamName(),app_alias:this.props.appAlias}).then(e=>{e&&this.setState({branch:e.list})})}render(){var e=this.props,t=e.title,a=e.onCancel,l=e.appBuidSourceLoading,n=e.form,d=n.getFieldDecorator,c=n.getFieldValue,p=this.state,f=(p.showUsernameAndPass,p.showKey,p.isFlag),h=p.tabValue,g=p.buildSource,y=p.tabKey,E=p.language,w={labelCol:{xs:{span:5},sm:{span:3}},wrapperCol:{xs:{span:10},sm:{span:16}}},M={labelCol:{xs:{span:5},sm:{span:5}},wrapperCol:{xs:{span:10},sm:{span:16}}},C=E?w:M,A=c("git_url");/(http|https):\/\/([\w.]+\/?)\S*/.test(A||"");"git"!==this.state.serverType||this.state.serverType;var x=d("server_type",{initialValue:"git"})(b.default.createElement(u.default,{getPopupContainer:e=>e.parentNode,onChange:this.changeServerType,style:{width:100}},b.default.createElement(k,{value:"git"},"Git"),b.default.createElement(k,{value:"svn"},"Svn"),b.default.createElement(k,{value:"oss"},"OSS"))),D=this.state.buildSource.code_version,F="branch";D&&0===D.indexOf("tag:")&&(F="tag",D=D.substr(4,D.length));var T=d("version_type",{initialValue:F})(b.default.createElement(u.default,{getPopupContainer:e=>e.parentNode,style:{width:100}},b.default.createElement(k,{value:"branch"},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.git_branch"})),b.default.createElement(k,{value:"tag"},"Tag")));return b.default.createElement(s.default,{width:700,title:t,confirmLoading:l,onOk:this.handleSubmit,onCancel:a,visible:!0},b.default.createElement(o.default,{message:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.creat"}),type:"warning",closable:!0,size:"small",style:{marginBottom:"12px"}}),b.default.createElement(v.default,{defaultActiveKey:y,onChange:this.handleTabs},b.default.createElement(S,{tab:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.Source_code"}),key:"1"},"source_code"===h&&b.default.createElement(m.default,{onSubmit:this.handleSubmit},b.default.createElement(m.default.Item,(0,i.default)({},C,{label:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.address"})}),d("git_url",{initialValue:"source_code"==g.service_source&&g.git_url?g.git_url:"",force:!0,rules:[{required:!0,message:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_address"})},{validator:this.checkURL,message:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.Illegal_address"})}]})(b.default.createElement(r.default,{addonBefore:x,placeholder:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_address"})}))),f&&b.default.createElement(m.default.Item,(0,i.default)({},C,{label:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.version"})}),d("code_version",{initialValue:"source_code"==g.service_source&&D?D:"",rules:[{required:!0,message:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_version"})}]})(b.default.createElement(r.default,{addonBefore:T,placeholder:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_version"})}))),b.default.createElement(m.default.Item,(0,i.default)({},C,{label:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.name"})}),d("user_name",{initialValue:"source_code"==g.service_source&&(g.user_name||g.user)?g.user_name||g.user:"",rules:[{required:!1,message:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_name"})}]})(b.default.createElement(r.default,{autoComplete:"off",placeholder:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_name"})}))),b.default.createElement(m.default.Item,(0,i.default)({},C,{label:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.password"})}),d("password",{initialValue:"source_code"==g.service_source&&g.password?g.password:"",rules:[{required:!1,message:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_password"})}]})(b.default.createElement(r.default,{autoComplete:"new-password",type:"password",placeholder:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_password"})}))))),b.default.createElement(S,{tab:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.image"}),key:"2"},"docker_run"===h&&b.default.createElement(m.default,{onSubmit:this.handleSubmit},b.default.createElement(O,(0,i.default)({},C,{label:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.image_name"})}),d("image",{initialValue:"docker_image"!=g.service_source&&"docker_run"!=g.service_source||!g.image?"":g.image,rules:[{required:!0,message:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.image_name_null"})},{max:190,message:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.max"})}]})(b.default.createElement(r.default,{placeholder:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_image_name"})}))),b.default.createElement(O,(0,i.default)({},C,{label:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.Start"})}),d("cmd",{initialValue:"docker_image"==g.service_source&&g.cmd?g.cmd:""})(b.default.createElement(r.default,{placeholder:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_Start"})}))),b.default.createElement(m.default.Item,(0,i.default)({},C,{label:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.name"})}),d("user_name",{initialValue:"docker_image"==g.service_source&&(g.user_name||g.user)?g.user_name||g.user:"",rules:[{required:!1,message:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_name"})}]})(b.default.createElement(r.default,{autoComplete:"off",placeholder:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_name"})}))),b.default.createElement(m.default.Item,(0,i.default)({},C,{label:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.ChangeBuildSource.password"})}),d("password",{initialValue:"docker_image"==g.service_source&&g.password?g.password:"",rules:[{required:!1,essage:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_password"})}]})(b.default.createElement(r.default,{autoComplete:"new-password",type:"password",placeholder:(0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.input_password"})})))))))}},h=g))||h)||h);t.default=A},"0oB1":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("+L6B");var i=l(a("2/Rp"));a("fOrg");var r=l(a("+KLJ"));a("/xke");var o,d,c,u=l(a("TeRw")),m=l(a("ALo4")),p=l(a("QDog")),f=a("MuoO"),h=n(a("q1tI")),g=a("LLXN"),v=(o=(0,f.connect)(e=>{var t=e.user,a=e.appControl;return{currUser:t.currentUser,appDetail:a.appDetail}}),o((c=class extends h.PureComponent{constructor(e){super(e),this.openTrace=(()=>{var e=this.props,t=e.appDetail,a=e.dispatch;a({type:"monitor/setComponsentTrace",payload:{team_name:p.default.getCurrTeamName(),app_alias:t.service.service_alias},callback:()=>{u.default.success({message:(0,g.formatMessage)({id:"notification.success.setupAssembly"})}),this.loadTraceSetting()}})}),this.closeTrace=(()=>{var e=this.props,t=e.appDetail,a=e.dispatch;a({type:"monitor/deleteComponsentTrace",payload:{team_name:p.default.getCurrTeamName(),app_alias:t.service.service_alias},callback:()=>{u.default.success({message:(0,g.formatMessage)({id:"notification.success.closeAssembly"})}),this.loadTraceSetting()}})}),this.state={trace:{}}}componentDidMount(){this.loadTraceSetting()}loadTraceSetting(){var e=this.props,t=e.appDetail,a=e.dispatch;a({type:"monitor/getComponsentTrace",payload:{team_name:p.default.getCurrTeamName(),app_alias:t.service.service_alias},callback:e=>{this.setState({trace:e.bean})}})}componentWillUnmount(){}render(){var e=this.state.trace;return h.default.createElement(h.Fragment,null,h.default.createElement(r.default,{style:{marginBottom:"16px"},message:h.default.createElement(g.FormattedMessage,{id:"componentOverview.body.tab.monitor.TraceShow.message"})}),h.default.createElement(s.default,null,e.collector_host&&!e.enable_apm&&h.default.createElement(m.default,{type:"success",description:h.default.createElement(g.FormattedMessage,{id:"componentOverview.body.tab.monitor.TraceShow.Docking"}),actions:[h.default.createElement(i.default,{type:"primary",onClick:this.openTrace},h.default.createElement(g.FormattedMessage,{id:"componentOverview.body.tab.monitor.TraceShow.open"}))]}),e.collector_host&&e.enable_apm&&h.default.createElement(m.default,{type:"success",description:h.default.createElement(g.FormattedMessage,{id:"componentOverview.body.tab.monitor.TraceShow.alreadyOpen"}),actions:[h.default.createElement(i.default,{type:"primary",onClick:this.closeTrace},h.default.createElement(g.FormattedMessage,{id:"componentOverview.body.tab.monitor.TraceShow.close"}))]}),!e.collector_host&&h.default.createElement(m.default,{type:"warning",description:h.default.createElement(g.FormattedMessage,{id:"componentOverview.body.tab.monitor.TraceShow.notDependent"})})))}},d=c))||d);t.default=v},"18Tw":function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=n(a("kLXV"));a("/xke");var i=n(a("TeRw"));a("+BJd");var r=n(a("mr32")),o=l(a("q1tI")),d=a("LLXN"),c=r.default.CheckableTag;class u extends o.PureComponent{constructor(e){super(e),this.handleOk=(()=>{var e=Object.keys(this.state.selected);e.length?this.props.onOk&&this.props.onOk(e):i.default.warning({message:(0,d.formatMessage)({id:"notification.warn.label"})})}),this.isCheck=(e=>!!this.state.selected[e]),this.handleChange=((e,t)=>{t?this.state.selected[e]=!0:delete this.state.selected[e],this.forceUpdate()}),this.state={selected:{}}}render(){var e=this.props.tags||[],t=this.props.onCancel;return o.default.createElement(s.default,{title:o.default.createElement(d.FormattedMessage,{id:"componentOverview.body.AddTag.choice"}),visible:!0,onOk:this.handleOk,onCancel:t},e&&e.length?e.map(e=>o.default.createElement(c,{onChange:t=>{this.handleChange(e.label_id,t)},checked:this.isCheck(e.label_id)},e.label_alias)):o.default.createElement("div",{style:{textAlign:"center"}},o.default.createElement(d.FormattedMessage,{id:"componentOverview.body.AddTag.Not_yet"})))}}t.default=u},"2RmR":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV"));a("5NDa");var i=l(a("5rEg")),r=l(a("jehZ"));a("7Kak");var o=l(a("9yH6"));a("OaEy");var d=l(a("2fM7"));a("y8nQ");var c,u,m,p=l(a("Vl3Y")),f=n(a("q1tI")),h=a("LLXN"),g=l(a("IhRX")),v=l(a("CQXj")),y=p.default.Item,b=d.default.Option,_=o.default.Group,E=(c=p.default.create(),c((m=class extends f.PureComponent{constructor(){super(...arguments),this.handleSubmit=(e=>{e.preventDefault(),this.props.form.validateFields({force:!0},(e,t)=>{e||this.props.onOk&&this.props.onOk(t)})}),this.checkPath=((e,t,a)=>{var l=this.props.form.getFieldValue("scheme");"tcp"!=l?"tcp"!=l&&t?a():a(f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.EditRunHealthCheck.input_path"})):a()})}render(){var e=this.props,t=e.title,a=e.onCancel,l=e.ports,n=this.props.data||{},o={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},c=this.props.form,u=c.getFieldDecorator,m=c.getFieldValue,E=m("scheme")||"tcp";return f.default.createElement(s.default,{width:700,title:t,onOk:this.handleSubmit,onCancel:a,visible:!0},f.default.createElement(p.default,{onSubmit:this.handleSubmit},f.default.createElement(y,(0,r.default)({},o,{label:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.EditRunHealthCheck.port"})}),u("port",{initialValue:v.default.getPort(n)||(l.length?l[0].container_port:"")})(f.default.createElement(d.default,{getPopupContainer:e=>e.parentNode},l.map(e=>f.default.createElement(b,{key:e.container_port,value:e.container_port},e.container_port))))),f.default.createElement(y,(0,r.default)({},o,{label:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.EditRunHealthCheck.agreement"})}),u("scheme",{initialValue:n.scheme||"tcp"})(f.default.createElement(_,{options:[{label:"tcp",value:"tcp"},{label:"http",value:"http"}]}))),f.default.createElement(y,(0,r.default)({},o,{label:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.EditRunHealthCheck.http"}),style:{display:"tcp"===E?"none":""}}),u("http_header",{initialValue:n.http_header||""})(f.default.createElement(g.default,null))),f.default.createElement(y,(0,r.default)({},o,{label:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.EditRunHealthCheck.path"}),style:{display:"tcp"===E?"none":""}}),u("path",{initialValue:n.path||"",rules:[{validator:this.checkPath}]})(f.default.createElement(i.default,{placeholder:(0,h.formatMessage)({id:"componentOverview.body.EditRunHealthCheck.Response"})}))),f.default.createElement(y,(0,r.default)({},o,{label:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.EditRunHealthCheck.initialization"})}),u("initial_delay_second",{initialValue:n.initial_delay_second||"20",rules:[{required:!0,message:(0,h.formatMessage)({id:"componentOverview.body.EditRunHealthCheck.input_initialization"})}]})(f.default.createElement(i.default,{type:"number",style:{width:"80%"}})),f.default.createElement("span",{style:{marginLeft:8}},f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.EditRunHealthCheck.second"}))),f.default.createElement(y,(0,r.default)({},o,{label:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.EditRunHealthCheck.time"})}),u("period_second",{initialValue:n.period_second||"3",rules:[{required:!0,message:(0,h.formatMessage)({id:"componentOverview.body.EditRunHealthCheck.input_time"})}]})(f.default.createElement(i.default,{type:"number",style:{width:"80%"}})),f.default.createElement("span",{style:{marginLeft:8}},f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.EditRunHealthCheck.second"}))),f.default.createElement(y,(0,r.default)({},o,{label:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.EditRunHealthCheck.over_time"})}),u("timeout_second",{initialValue:n.timeout_second||"20",rules:[{required:!0,message:(0,h.formatMessage)({id:"componentOverview.body.EditRunHealthCheck.input_over_time"})}]})(f.default.createElement(i.default,{type:"number",style:{width:"80%"}})),f.default.createElement("span",{style:{marginLeft:8}},f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.EditRunHealthCheck.second"}))),f.default.createElement(y,(0,r.default)({},o,{label:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.EditRunHealthCheck.error"})}),u("failure_threshold",{initialValue:n.failure_threshold||"3",rules:[{required:!0,message:(0,h.formatMessage)({id:"componentOverview.body.EditRunHealthCheck.error_frequency"})}]})(f.default.createElement(i.default,{type:"number",style:{width:"80%"}})))))}},u=m))||u);t.default=E},"2U5Y":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV")),i=l(a("jehZ"));a("14J3");var r=l(a("BMrR"));a("jCWc");var o=l(a("kPKH"));a("sRBo");var d=l(a("kaz8"));a("+L6B");var c=l(a("2/Rp"));a("/xke");var u=l(a("TeRw"));a("y8nQ");var m,p,f,h,g=l(a("Vl3Y")),v=a("MuoO"),y=n(a("q1tI")),b=a("LLXN"),_=l(a("e6Ls")),E=g.default.Item,w=(m=(0,v.connect)(),p=g.default.create(),m(f=p((h=class extends y.PureComponent{constructor(e){super(e),this.onChange=(e=>{var t=this.props,a=t.data,l=t.form,n=l.setFieldsValue;this.setState({indeterminate:!!e.length&&e.length<a.length,checkAll:e.length===a.length}),n({graphIds:e})}),this.onCheckAllChange=(e=>{var t=this.state.allCheckedList,a=this.props.form.setFieldsValue;a({graphIds:e.target.checked?t:[]}),this.setState({indeterminate:!1,checkAll:e.target.checked})}),this.onOk=(e=>{e.preventDefault();var t=this.props,a=t.form,l=t.onOk;a.validateFields({force:!0},(e,t)=>{!e&&l&&this.handleSubmitBatchDelete(t)})}),this.handleSubmitBatchDelete=(e=>{var t=this.props,a=t.dispatch,l=t.onOk,n=t.team_name,s=t.app_alias;a({type:"monitor/batchDeleteServiceMonitorFigure",payload:{app_alias:s,team_name:n,graph_ids:e.graphIds},callback:e=>{e&&200===e.status_code&&(u.default.success({message:(0,b.formatMessage)({id:"notification.success.delete"})}),l())}})});var t=this.props.data,a=t&&t.length>0&&t.map(e=>e.graph_id);this.state={allCheckedList:a,indeterminate:!0,checkAll:!0}}render(){var e=this.props,t=e.title,a=e.onCancel,l=e.data,n=e.form,u=e.loading,m=void 0!==u&&u,p=this.state,f=p.checkAll,h=p.indeterminate,g=l&&l.length>0&&l.map(e=>e.graph_id),v=n.getFieldDecorator,w={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}};return y.default.createElement(s.default,{title:t,visible:!0,onOk:this.onOk,onCancel:a,className:_.default.TelescopicModal,footer:[y.default.createElement(c.default,{onClick:a},"  ",y.default.createElement(b.FormattedMessage,{id:"button.cancel"})),y.default.createElement(c.default,{type:"primary",loading:m,onClick:this.onOk},y.default.createElement(b.FormattedMessage,{id:"button.determine"}))]},y.default.createElement("div",null,y.default.createElement("div",{style:{borderBottom:"1px solid #E9E9E9",paddingBottom:"10px",marginBottom:"10px"}},y.default.createElement(d.default,{indeterminate:h,onChange:this.onCheckAllChange,checked:f},y.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.BatchDeleteChart.all"}))),y.default.createElement(E,(0,i.default)({},w,{label:""}),v("graphIds",{initialValue:g||[],rules:[{required:!0,message:(0,b.formatMessage)({id:""})}]})(y.default.createElement(d.default.Group,{style:{width:"472px"},onChange:this.onChange},y.default.createElement(r.default,null,l.map(e=>{var t=e.title,a=e.ID,l=e.graph_id;return y.default.createElement(o.default,{span:12,key:a,style:{marginBottom:"5px"}},y.default.createElement(d.default,{value:l},t))})))))))}},f=h))||f)||f),M=w;t.default=M},"308x":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var s=l(a("2/Rp"));a("Mwp2");var i=l(a("VXEj"));a("Pwec");var r=l(a("CtXQ"));a("g9YV");var o=l(a("wCAj"));a("/xke");var d=l(a("TeRw"));a("IzEo");var c=l(a("bx4M"));a("T2oS");var u=l(a("W9HT"));a("14J3");var m=l(a("BMrR"));a("jCWc");var p=l(a("kPKH"));a("5Dmo");var f=l(a("3S7+"));a("2qtc");var h=l(a("kLXV"));a("5NDa");var g=l(a("5rEg"));a("y8nQ");var v=l(a("Vl3Y"));a("7Kak");var y=l(a("9yH6"));a("OaEy");var b,_,E,w,M,C,S,O,k,A,x,D,F=l(a("2fM7")),T=a("MuoO"),P=a("7DNP"),N=n(a("q1tI")),R=a("LLXN"),I=l(a("q76B")),L=l(a("fxb9")),V=l(a("QxhW")),B=l(a("cUW5")),H=l(a("mKRI")),q=l(a("QDog")),U=l(a("/EMh")),z=l(a("LrcT")),j=F.default.Option,X=y.default.Button,K=y.default.Group,Q=v.default.Item,W=(b=v.default.create(),b((E=class extends N.PureComponent{constructor(){super(...arguments),this.handleOk=(()=>{var e=this.props.onOk;this.props.form.validateFields((t,a)=>{!t&&e&&(a.min_cpu=Number(a.min_cpu),e(a))})})}render(){var e=this.props,t=e.minCpu,a=e.memory,l=e.form,n=e.onCancel,s=l.getFieldDecorator;return N.default.createElement(h.default,{title:N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.UpdateMemory.title"}),visible:!0,onOk:this.handleOk,onCancel:n},N.default.createElement(v.default,{onSubmit:this.handleOk,layout:"horizontal"},N.default.createElement(V.default,{labelCol:{span:5},wrapperCol:{span:19},form:l,FormItem:v.default.Item,initialValue:a,setkey:"memory",getFieldDecorator:s}),N.default.createElement(v.default.Item,{label:"CPU",labelCol:{span:5},wrapperCol:{span:19}},s("min_cpu",{initialValue:t||0,rules:[{required:!0,message:(0,R.formatMessage)({id:"componentOverview.body.UpdateMemory.cpu"})},{pattern:new RegExp(/^[0-9]\d*$/,"g"),message:(0,R.formatMessage)({id:"componentOverview.body.UpdateMemory.only"})}]})(N.default.createElement(g.default,{type:"number",min:0,addonAfter:"m",placeholder:(0,R.formatMessage)({id:"componentOverview.body.UpdateMemory.inpiut_cup"})})),N.default.createElement("div",{style:{color:"#999999",fontSize:"12px"}},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.UpdateMemory.unlimited"})))))}},_=E))||_),G=(w=v.default.create(),w((C=class extends N.PureComponent{constructor(){super(...arguments),this.onChange=((e,t)=>{var a=this.props.data;a&&a.map((a,l)=>{return t===l&&(a.attr_value=e),a}),this.props.onChange&&this.props.onChange(a),this.forceUpdate()}),this.renderItem=((e,t)=>{if("string"===e.attr_type)return N.default.createElement(Q,{style:{width:"90%"},label:N.default.createElement(f.default,{title:e.attr_info||e.attr_name},N.default.createElement("div",{className:z.default.nowarpText}," ",e.attr_name,e.attr_info?N.default.createElement("span",null,"(",e.attr_info,")"):""," "))},N.default.createElement(g.default,{disabled:!e.is_change,defaultValue:e.attr_value?e.attr_value:e.attr_default_value,onChange:e=>{this.onChange(e.target.value,t)}}));if("radio"===e.attr_type){var a=e.attr_alt_value.split(",");return N.default.createElement(Q,{style:{width:"90%"},label:N.default.createElement(f.default,{title:e.attr_info||e.attr_name},N.default.createElement("div",{className:z.default.nowarpText}," ",e.attr_name,e.attr_info?N.default.createElement("span",null,"(",e.attr_info,")"):""," "))},N.default.createElement(F.default,{getPopupContainer:e=>e.parentNode,onChange:e=>{this.onChange(e,t)},disabled:!e.is_change,value:e.attr_value||e.attr_default_value||""},a.map(e=>N.default.createElement(j,{key:e,value:e},e))))}if("checkbox"===e.attr_type){var l=e.attr_alt_value.split(",");return N.default.createElement(Q,{style:{width:"90%"},label:N.default.createElement(f.default,{title:e.attr_info||e.attr_name},N.default.createElement("div",{className:z.default.nowarpText}," ",e.attr_name,e.attr_info?N.default.createElement("span",null,"(",e.attr_info,")"):""," "))},N.default.createElement(F.default,{getPopupContainer:e=>e.parentNode,disabled:!e.is_change,onChange:e=>{this.onChange(e.join(","),t)},value:(e.attr_value||e.attr_default_value||"").split(","),mode:"multiple"},l.map(e=>N.default.createElement(j,{key:e,value:e},e))))}})}componentWillReceiveProps(){}render(){var e=this.props.data||[];return N.default.createElement(v.default,{layout:"vertical"},N.default.createElement(m.default,null,e.map((e,t)=>N.default.createElement(p.default,{span:"8"},this.renderItem(e,t)))))}},M=C))||M);class Y extends N.PureComponent{constructor(e){super(e),this.getAppByName=(e=>this.props.data.filter(t=>t.dest_service_alias===e)),this.handleAppChange=(e=>{var t=this.getAppByName(e);this.setState({currAppLoading:!0},()=>{this.setState({currApp:e,currPort:t[0].port,currAppLoading:!1})})}),this.handlePortChange=(e=>{this.setState({currAppLoading:!0},()=>{this.setState({currPort:e,currAppLoading:!1})})}),this.getCurrPorts=(()=>{var e=this.getAppByName(this.state.currApp);return e.map(e=>e.port)}),this.getCurrData=(()=>{var e=this.state.currPort,t=this.state.currApp,a=this.getAppByName(t);return a.filter(t=>t.port===e)[0]}),this.getApps=(()=>{var e=this.props.data,t=[],a=[];return e.map(e=>{-1==t.indexOf(e.dest_service_alias)&&(t.push(e.dest_service_alias),a.push({dest_service_alias:e.dest_service_alias,dest_service_cname:e.dest_service_cname,port:e.port}))}),a});var t=this.props.data;this.state={currApp:t[0].dest_service_alias,currPort:t[0].port,config_name:t[0].config_group_name,currAppLoading:!1}}render(){var e=this.getCurrData(),t=this.state,a=t.currPort,l=t.currApp,n=t.config_name,s=t.currAppLoading,i=this.getCurrPorts(),r=this.getApps();return N.default.createElement(c.default,{style:{marginBottom:24},type:"inner",title:N.default.createElement("div",null,n,N.default.createElement("span",{style:{marginRight:24,marginLeft:16}},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.getApps.app"})," ",N.default.createElement(F.default,{getPopupContainer:e=>e.parentNode,onChange:this.handleAppChange,value:l},r.map(e=>e&&N.default.createElement(j,{key:e.dest_service_alias+e.port,value:e.dest_service_alias},e.dest_service_cname))))," ",N.default.createElement("span",{style:{marginRight:24}}," ",N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.getApps.port"})," ",N.default.createElement(F.default,{getPopupContainer:e=>e.parentNode,onChange:this.handlePortChange,value:a},i.map(e=>N.default.createElement(j,{value:e},e)))," ")," ",N.default.createElement("span",{style:{marginRight:24}},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.getApps.port_agreement"}),e.protocol)," ")},s?N.default.createElement(u.default,null):N.default.createElement(G,{onChange:this.handleOnChange,data:e.config}))}}class J extends N.PureComponent{constructor(e){super(e),this.handlePortChange=(e=>{this.setState({currAppLoading:!0},()=>{this.setState({currPort:e,currAppLoading:!1})})}),this.getCurrData=(e=>this.props.data.filter(t=>t.port===e)[0]);var t=this.props.data;t.length>0&&(this.state={currAppLoading:!1,currPort:t[0].port,config_name:t[0].config_group_name})}render(){var e=this.props.data,t=this.state,a=t.currAppLoading,l=t.config_name,n=t.currPort,s=this.getCurrData(n);return N.default.createElement(N.default.Fragment,null,N.default.createElement(c.default,{style:{marginBottom:24},type:"inner",title:N.default.createElement("div",null,l,N.default.createElement("span",{style:{marginRight:24,marginLeft:16}},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.ConfigUpstreamPort.port"})," ",N.default.createElement(F.default,{getPopupContainer:e=>e.parentNode,onChange:this.handlePortChange,value:n},e.map(e=>N.default.createElement(j,{key:e.port,value:e.port},e.port))))," ",N.default.createElement("span",{style:{marginRight:24}}," ",N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.ConfigUpstreamPort.port_agreement"}),s.protocol," ")," ")},a?N.default.createElement(u.default,null):N.default.createElement(G,{onChange:this.handleOnChange,data:s.config})))}}class Z extends N.PureComponent{render(){var e=this.props.data||[],t=this.props.data.config_group_name;return N.default.createElement(N.default.Fragment,null,N.default.createElement("h4",null,N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.ConfigUnDefine"})),N.default.createElement(c.default,{style:{marginBottom:24},type:"inner",title:N.default.createElement("div",null,t)},N.default.createElement(G,{onChange:this.handleOnChange,data:e.config})))}}var $=(S=(0,T.connect)(e=>{var t=e.user,a=e.loading;return{currUser:t.currentUser,loading:a.appControl}},null,null,{withRef:!0}),S((k=class extends N.PureComponent{constructor(){super(...arguments),this.state={editStoragData:!1},this.handleSubmitStorageConfig=((e,t)=>{var a=q.default.getCurrTeamName(),l=this.props,n=l.pluginInfo,s=n.plugin_id,i=n.configs,r=n.appAlias,o=l.dispatch,c=JSON.parse(JSON.stringify(t))||{},u=JSON.parse(JSON.stringify(e))||{},m=JSON.parse(JSON.stringify(i))||{},p=c.attr_value,f=p&&JSON.parse(p)||{};if(c.volume_name=f.volume_name=u.volume_name,c.volume_path=f.volume_path=u.volume_path,c.attr_type=f.volume_type=u.volume_type,c.file_content=f.file_content=u.file_content||"",c.attr_value=f&&JSON.stringify(f),m&&m.storage_env&&m.storage_env.config){var h=m.storage_env.config;m.storage_env.config=h&&h.map(e=>{return e.attr_name===c.attr_name&&(e=c),e})}o({type:"appControl/editPluginConfigs",payload:{team_name:a,app_alias:r,plugin_id:s,data:m},callback:()=>{d.default.success({message:(0,R.formatMessage)({id:"notification.success.succeeded"})}),this.openPlugin()}})}),this.openPlugin=(()=>{var e=q.default.getCurrTeamName(),t=this.props,a=t.dispatch,l=t.pluginInfo,n=l.appAlias,s=l.pluginInfo,i=s.plugin_id,r=s.build_version;a({type:"appControl/getPluginConfigs",payload:{team_name:e,app_alias:n,plugin_id:i,build_version:r},callback:e=>{e&&(this.props.data.config=e.bean.storage_env.config,this.handleCancelAddStorageConfig())}})}),this.handleCancelAddStorageConfig=(()=>{this.setState({editStoragData:!1})}),this.handleEdit=(e=>{this.setState({editStoragData:e})})}componentDidMount(){this.openPlugin()}render(){var e=this.props.data.config,t=this.state.editStoragData,a=[];return a=e&&e.reduce((e,t)=>"config-file"===t.attr_type||"storage"===t.attr_type?[...e,t]:e,[]),a.length>0&&a.map(e=>{var t=e.attr_value,a=t&&JSON.parse(t)||{};e.volume_path=a.volume_path,e.volume_name=a.volume_name,e.attr_type=a.attr_type,e.file_content=a.file_content}),N.default.createElement(N.default.Fragment,null,N.default.createElement("h4",null,N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.handleEdit.share"})),N.default.createElement(o.default,{columns:[{title:(0,R.formatMessage)({id:"componentOverview.body.handleEdit.name"}),dataIndex:"volume_name"},{title:(0,R.formatMessage)({id:"componentOverview.body.handleEdit.path"}),dataIndex:"volume_path"},{title:(0,R.formatMessage)({id:"componentOverview.body.handleEdit.type"}),dataIndex:"attr_type",render(e,t){var a=t.attr_type;return"config-file"===a?N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.handleEdit.file"}):N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.handleEdit.shared_storage"})}},{title:(0,R.formatMessage)({id:"componentOverview.body.handleEdit.operation"}),dataIndex:"action",render:(e,t)=>{return N.default.createElement("a",{onClick:()=>{this.handleEdit(t)}},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.handleEdit.edit"}))}}],dataSource:a,pagination:!1}),t&&N.default.createElement(L.default,{onCancel:this.handleCancelAddStorageConfig,onSubmit:this.handleSubmitStorageConfig,data:this.state.editStoragData,editor:!0}))}},O=k))||O);class ee extends N.PureComponent{constructor(){super(...arguments),this.renderConfig=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return"upstream_port"===t?N.default.createElement(J,{data:e}):"downstream_port"===t?N.default.createElement(N.Fragment,null,N.default.createElement(Y,{data:e})):"un_define"===t?N.default.createElement(N.Fragment,null,N.default.createElement(Z,{data:e})):"storage_env"===t?N.default.createElement(N.Fragment,null,N.default.createElement($,{data:e,pluginInfo:a})):null}}render(){var e=this.props.configs||{},t=e.undefine_env||{},a=e.downstream_env||[],l=e.upstream_env||[],n=e.storage_env||[];return N.default.createElement("div",{style:{padding:"20px 0"}},"{}"!==JSON.stringify(t)?this.renderConfig(t,"un_define"):null,l.length?this.renderConfig(l,"upstream_port"):null,a.length?this.renderConfig(a,"downstream_port"):null,"{}"!==JSON.stringify(n)?this.renderConfig(n,"storage_env",this.props):null)}}var te=(A=(0,T.connect)(e=>{var t=e.user,a=e.loading;return{currUser:t.currentUser,loading:a.appControl}},null,null,{withRef:!0}),A((D=class extends N.PureComponent{constructor(e){var t;super(e),t=this,this.getPlugins=(()=>{var e=q.default.getCurrTeamName(),t=this.props.appAlias;this.props.dispatch({type:"appControl/getPlugins",payload:{team_name:e,app_alias:t,category:this.state.category},callback:e=>{if(e){var t=e.bean.installed_plugins||[],a=e.bean.not_install_plugins||[];this.setState({installedList:t,unInstalledList:a}),this.isInit&&(this.isInit=!1,t.length||this.setState({type:"uninstalled"}))}}})}),this.handleCategoryChange=(e=>{this.setState({category:e.target.value},()=>{this.getPlugins()})}),this.handleTypeChange=(e=>{this.setState({type:e.target.value})}),this.handleStartPlugin=(e=>{var t=q.default.getCurrTeamName(),a=this.props.appAlias;this.props.dispatch({type:"appControl/startPlugin",payload:{team_name:t,app_alias:a,plugin_id:e.plugin_id},callback:()=>{this.getPlugins(),d.default.success({message:(0,R.formatMessage)({id:"notification.success.enable"})})}})}),this.handleStopPlugin=(e=>{var t=q.default.getCurrTeamName(),a=this.props.appAlias;this.props.dispatch({type:"appControl/stopPlugin",payload:{team_name:t,app_alias:a,plugin_id:e.plugin_id},callback:()=>{this.getPlugins(),d.default.success({message:(0,R.formatMessage)({id:"notification.success.deactivate"})})}})}),this.isOpenedPlugin=(e=>{var t=this.state.openedPlugin;return!!t[e.plugin_id]}),this.openPlugin=(e=>{var t=q.default.getCurrTeamName(),a=this.props.appAlias;this.props.dispatch({type:"appControl/getPluginConfigs",payload:{team_name:t,app_alias:a,plugin_id:e.plugin_id,build_version:e.build_version},callback:t=>{if(t){var a={};a[e.plugin_id]=t.bean||{},this.setState({openedPlugin:Object.assign({},a),pluginInfo:e})}}})}),this.closePlugin=(e=>{delete this.state.openedPlugin[e.plugin_id],this.forceUpdate()}),this.handleUpdateConfig=((e,t)=>{var a=q.default.getCurrTeamName(),l=this.props.appAlias;this.props.dispatch({type:"appControl/editPluginConfigs",payload:{team_name:a,app_alias:l,plugin_id:e,data:t},callback:()=>{d.default.success({message:(0,R.formatMessage)({id:"notification.success.modified"})})}})}),this.onUpdateMemory=(e=>{this.setState({updateMemory:e})}),this.cancelUpdateMemory=(()=>{this.setState({updateMemory:null})}),this.renderInstalled=(()=>{var e=this.state,t=e.installedList,a=e.pluginInfo,l=null===this.state.unInstalledList;return N.default.createElement(i.default,{size:"large",rowKey:"id",loading:l,pagination:!1,dataSource:t||[],renderItem:e=>N.default.createElement("div",null,N.default.createElement(i.default.Item,{actions:[this.isOpenedPlugin(e)?N.default.createElement("a",{onClick:()=>{this.closePlugin(e)},href:"javascript:;"},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderInstalled.configuration"})):N.default.createElement("a",{onClick:()=>{this.openPlugin(e)},href:"javascript:;"},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderInstalled.look"})),,H.default.isStart(e)?N.default.createElement("a",{onClick:()=>{this.handleStopPlugin(e)},href:"javascript:;"},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderInstalled.deactivate"})):N.default.createElement("a",{onClick:()=>{this.handleStartPlugin(e)},href:"javascript:;"},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderInstalled.enable"})),N.default.createElement("a",{onClick:()=>{this.onUpdateMemory(e)},href:"javascript:;"},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderInstalled.allocation"})),,N.default.createElement("a",{onClick:()=>{this.onDeletePlugin(e)},href:"javascript:;"}," ",N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderInstalled.uninstall"})," ")]},N.default.createElement(i.default.Item.Meta,{avatar:N.default.createElement(r.default,{type:"api",style:{fontSize:40,color:"rgba(0, 0, 0, 0.2)"}}),title:N.default.createElement("div",null," ",N.default.createElement(P.Link,{to:"/team/".concat(q.default.getCurrTeamName(),"/region/").concat(q.default.getCurrRegionName(),"/myplugns/").concat(e.plugin_id)},e.plugin_alias)," ",N.default.createElement("p",{style:{fontSize:12,color:"#dcdcdc"}}," ",N.default.createElement("span",{style:{marginRight:24}},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderInstalled.category"}),U.default.getCategoryCN(e.category))," ",N.default.createElement("span",{style:{marginRight:24}}," ",N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderInstalled.edition"}),e.build_version," ")," ",N.default.createElement("span",null,"  ",N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderInstalled.memory"}),e.min_memory," MB "))," "),description:e.desc})),this.isOpenedPlugin(e)?N.default.createElement(N.Fragment,null,N.default.createElement(ee,{configs:this.state.openedPlugin[e.plugin_id]||[],plugin_id:e.plugin_id,appAlias:this.props.appAlias,pluginInfo:a}),N.default.createElement("div",{style:{textAlign:"right",marginBottom:80}},N.default.createElement(s.default,{style:{marginRight:8},onClick:()=>{this.handleUpdateConfig(e.plugin_id,this.state.openedPlugin[e.plugin_id])},type:"primary"},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderInstalled.updata"})),N.default.createElement(s.default,{onClick:()=>{this.closePlugin(e)},type:"default"},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderInstalled.configuration"})))):null)})}),this.renderUnInstalled=(()=>{var e=this.state.unInstalledList,t=null===this.state.unInstalledList;return e.length?N.default.createElement(i.default,{size:"large",rowKey:"id",loading:t,pagination:!1,dataSource:e||[],renderItem:e=>N.default.createElement(i.default.Item,{actions:[N.default.createElement("a",{onClick:()=>{this.installPlugin(e)},href:"javascript:;"}," ",N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderUnInstalled.open"})," ")]},N.default.createElement(i.default.Item.Meta,{avatar:N.default.createElement(r.default,{type:"api",style:{fontSize:40,color:"rgba(0, 0, 0, 0.2)"}}),title:N.default.createElement("div",null," ",N.default.createElement(P.Link,{to:"/team/".concat(q.default.getCurrTeamName(),"/region/").concat(q.default.getCurrRegionName(),"/myplugns/").concat(e.plugin_id)},e.plugin_alias)," ",N.default.createElement("p",{style:{fontSize:12,color:"#dcdcdc"}}," ",N.default.createElement("span",{style:{marginRight:24}},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderUnInstalled.type"}),U.default.getCategoryCN(e.category))," ",N.default.createElement("span",null,"  ",N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderUnInstalled.edition"}),e.build_version," "))," "),description:e.desc}))}):N.default.createElement("center",null,N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderUnInstalled.not"})," ",N.default.createElement(P.Link,{style:{marginTop:32},to:"/team/".concat(q.default.getCurrTeamName(),"/region/").concat(q.default.getCurrRegionName(),"/myplugns")},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.renderUnInstalled.install"})))}),this.hasInstalled=(()=>{var e=this.state.installedList;return e&&!!e.length}),this.installPlugin=(e=>{var t=q.default.getCurrTeamName(),a=this.props.appAlias;this.props.dispatch({type:"appControl/installPlugin",payload:{team_name:t,app_alias:a,plugin_id:e.plugin_id,build_version:e.build_version},callback:()=>{d.default.success({message:(0,R.formatMessage)({id:"notification.success.openToUpdate"})}),this.getPlugins(),this.props.onshowRestartTips(!0)}})}),this.onDeletePlugin=(e=>{this.setState({showDeletePlugin:e})}),this.cancelDeletePlugin=(()=>{this.setState({showDeletePlugin:null})}),this.hanldeUnInstallPlugin=(()=>{var e=q.default.getCurrTeamName(),t=this.props.appAlias,a=this.state.showDeletePlugin;this.props.dispatch({type:"appControl/unInstallPlugin",payload:{team_name:e,app_alias:t,plugin_id:a.plugin_id},callback:()=>{delete this.state.openedPlugin[a.plugin_id],d.default.success({message:(0,R.formatMessage)({id:"notification.success.uninstallToUpdate"})}),this.cancelDeletePlugin(),this.getPlugins(),this.props.onshowRestartTips(!0)}})}),this.handleUpdateMemory=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=q.default.getCurrTeamName(),l=t.props.appAlias,n=t.state.updateMemory;t.props.dispatch({type:"appControl/updatePluginMemory",payload:{team_name:a,app_alias:l,plugin_id:n.plugin_id,min_memory:e.memory,min_cpu:e.min_cpu},callback:()=>{t.getPlugins(),t.cancelUpdateMemory(),d.default.success({message:(0,R.formatMessage)({id:"notification.success.succeeded"})})}})},this.state={installedList:null,unInstalledList:null,category:"",type:"installed",showDeletePlugin:null,openedPlugin:{},pluginInfo:{}},this.isInit=!0}componentDidMount(){this.canView()&&this.getPlugins()}canView(){var e=this.props.componentPermissions.isPlugin;return e}render(){if(!this.canView())return N.default.createElement(B.default,null);var e=this.state.type;return N.default.createElement(c.default,null,N.default.createElement("p",{style:{overflow:"hidden"}},N.default.createElement(K,{onChange:this.handleTypeChange,value:e,style:{marginRight:16,float:"left"}},N.default.createElement(X,{value:"installed"},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.Plugin.installed"})),N.default.createElement(X,{value:"uninstalled"},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.Plugin.uninstalled"}))),N.default.createElement(K,{onChange:this.handleCategoryChange,defaultValue:"",style:{marginRight:16,float:"right"}},N.default.createElement(X,{value:""},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.Plugin.all"})),N.default.createElement(X,{value:"analysis"},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.Plugin.analysis"})),N.default.createElement(X,{value:"net_manage"},N.default.createElement(R.FormattedMessage,{id:"componentOverview.body.Plugin.net_manage"})))),"installed"===e?this.renderInstalled():this.renderUnInstalled(),this.state.showDeletePlugin&&N.default.createElement(I.default,{onOk:this.hanldeUnInstallPlugin,onCancel:this.cancelDeletePlugin,title:N.default.createElement(R.FormattedMessage,{id:"confirmModal.deldete.plugin.title"}),desc:N.default.createElement(R.FormattedMessage,{id:"confirmModal.deldete.plugin.desc"})}),this.state.updateMemory&&N.default.createElement(W,{onOk:this.handleUpdateMemory,onCancel:this.cancelUpdateMemory,minCpu:this.state.updateMemory.min_cpu,memory:this.state.updateMemory.min_memory}))}},x=D))||x);t.default=te},"3A2o":function(e,t,a){"use strict";var l=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,s,i=l(a("q1tI")),r=a("MuoO"),o=a("LLXN"),d=l(a("MXRY")),c=(n=(0,r.connect)(),n(s=class extends i.default.Component{render(){var e=this.props.appAlias;return i.default.createElement(d.default,{title:i.default.createElement(o.FormattedMessage,{id:"componentOverview.body.ConnectionInformation.title"}),type:"Outer",appAlias:e})}})||s);t.default=c},"4NES":function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("Mwp2");var s=n(a("VXEj")),i=l(a("q1tI")),r=n(a("ZzQo")),o=n(a("k3y4")),d=a("LLXN");class c extends i.PureComponent{constructor(e){super(e),this.showName=(e=>{var t=e&&e.split("-"),a=t[t.length-1];return"".concat((0,d.formatMessage)({id:"componentOverview.body.Expansion.InstanceList.example"},{num:a}))}),this.getContainerMem=(e=>{var t=0;return e&&e.map(e=>{e.container_name===this.props.k8s_component_name&&(t=e.usage_rate)}),t}),this.getMemorySum=(e=>{var t=0;return e&&e.map(e=>{t+=e.memory_usage}),t.toFixed(2)}),this.state={list:this.props.list}}componentWillReceiveProps(e){e.list!==this.props.list&&this.setState({list:e.list})}componentDidMount(){}render(){var e={Running:(0,d.formatMessage)({id:"componentOverview.body.Expansion.InstanceList.normal"}),Pending:(0,d.formatMessage)({id:"componentOverview.body.Expansion.InstanceList.starting"}),Succeeded:(0,d.formatMessage)({id:"componentOverview.body.Expansion.InstanceList.successfully"}),Failed:(0,d.formatMessage)({id:"componentOverview.body.Expansion.InstanceList.failed"}),Unknown:(0,d.formatMessage)({id:"componentOverview.body.Expansion.InstanceList.unknown"})};return i.default.createElement(s.default,{grid:{gutter:16,column:4},dataSource:this.state.list,renderItem:t=>i.default.createElement(s.default.Item,{className:o.default.cen,key:t.pod_name},i.default.createElement(r.default,{className:o.default.instance,height:120,title:i.default.createElement(d.FormattedMessage,{id:"componentOverview.body.Expansion.InstanceList.memory"}),percent:this.getContainerMem(t.container),memorySum:this.getMemorySum(t.container)}),i.default.createElement("div",null,this.showName(t.pod_name)),i.default.createElement("div",null,e[t.pod_status]))})}}var u=c;t.default=u},"6mLI":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("/xke");var i=l(a("TeRw"));a("+L6B");var r,o,d,c,u,m,p,f,h=l(a("2/Rp")),g=a("MuoO"),v=l(a("17x9")),y=n(a("q1tI")),b=a("LLXN"),_=l(a("0zE7")),E=a("xpXo"),w=l(a("9/bS")),M=l(a("J5jb")),C=l(a("QDog")),S=l(a("ym8O")),O=l(a("rIpq")),k=l(a("zcww")),A=l(a("+iC2")),x=l(a("dL6S")),D=l(a("+y/a")),F=l(a("ye39")),T=l(a("ruXZ")),P=l(a("LrcT")),N=h.default.Group;r=(0,g.connect)(e=>{var t=e.user,a=e.appControl;return{currUser:t.currentUser,appDetail:a.appDetail}}),r((c=d=class extends y.PureComponent{constructor(e){super(e),this.showLogType=(()=>{return"ing"===this.state.status?"none":!1===this.state.opened?"none":""}),this.getSocketUrl=(()=>{var e=A.default.getTeamByTeamName(this.props.currUser,C.default.getCurrTeamName()),t=C.default.getCurrRegionName();if(e){var a=k.default.getRegionByName(e,t);if(a)return O.default.getEventWebSocketUrl(a)}return""}),this.onClose=(()=>{this.isDoing=!1}),this.onSuccess=(e=>{this.setState({resultStatus:"success"}),this.ref.querySelector(".actionresultcn").innerHTML=y.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.LogItem.complete"})}),this.onTimeout=(e=>{this.setState({resultStatus:"timeout"}),this.ref.querySelector(".actionresultcn").innerHTML=y.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.LogItem.timeout"}),this.ref.querySelector(".action-error-msg").innerHTML="(".concat(w.default.getFailMessage(e),")")}),this.onFail=(e=>{this.setState({resultStatus:"fail"}),this.ref.querySelector(".actionresultcn").innerHTML=y.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.LogItem.fail"}),this.ref.querySelector(".action-error-msg").innerHTML="(".concat(w.default.getFailMessage(e),")")}),this.onComplete=(e=>{this.setState({status:""}),this.context.isActionIng(!1),this.close()}),this.open=(()=>{this.setState({opened:!0,logType:"info"},()=>{this.loadLog()})}),this.close=(()=>{this.setState({opened:!1})}),this.changeLogType=(e=>{e!==this.state.logType&&this.setState({logType:e,logs:[]},()=>{this.loadLog()})}),this.saveRef=(e=>{this.ref=e}),this.handleRollback=(()=>{this.context.appRolback(w.default.getRollbackVersion(this.props.data))}),this.state={status:"",resultStatus:"",opened:!1,logType:"info",logs:[]}}componentDidMount(){var e=this.props.data;e&&this.ref&&(this.ref.querySelector(".actioncn").innerHTML=w.default.getActionCN(e),w.default.isSuccess(e)&&this.onSuccess(),w.default.isFail(e)&&this.onFail(e),w.default.isTimeout(e)&&this.onTimeout(e),w.default.isActioning(e)&&(this.setState({status:"ing"}),this.ref.querySelector(".actionresultcn").innerHTML=y.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.LogItem.hand"}),this.context.isActionIng(!0)),this.ref.querySelector(".action-user").innerHTML="@".concat(w.default.getActionUser(e)))}loadLog(){(0,E.getActionLogDetail)({app_alias:this.props.appAlias,level:this.state.logType,team_name:C.default.getCurrTeamName(),event_id:this.props.data.event_id}).then(e=>{e&&this.setState({logs:e.list||[]})})}createSocket(){var e=this.props.data,t=this.getSocketUrl();if(t){var a=M.default.isWebSocketOpen(t);a&&"through"===a&&(this.socket=new S.default({url:this.getSocketUrl(),eventId:e.event_id,onMessage:e=>{var t=this.state.logs;t.unshift(e),this.setState({logs:[].concat(t)})}}))}}getLogContHeight(){var e=this.state,t=e.status,a=e.opened;return"ing"!==t||a?a?"auto":0:15}getResultClass(){this.props.data;return"fail"===this.state.resultStatus?P.default.fail:"success"===this.state.resultStatus?P.default.success:""}render(){var e=this.state,t=e.status,a=e.opened,l=e.logType,n=e.logs,s=this.props.data;document.getElementById("box");return s?y.default.createElement("div",{ref:this.saveRef,className:"".concat(P.default.logItem," ").concat(this.getResultClass())},y.default.createElement("div",{className:P.default.logItemDate},y.default.createElement("span",{className:P.default.time},w.default.getActionTime(s)),y.default.createElement("span",{className:P.default.date},M.default.dateToCN(w.default.getActionDateTime(s),"yyyy-MM-dd"))),y.default.createElement("div",{className:P.default.logItemMain},y.default.createElement("div",{className:P.default.hd},y.default.createElement("label",{className:P.default.tit},y.default.createElement("span",{className:"actioncn"}),y.default.createElement("span",{className:"actionresultcn"}),y.default.createElement("span",{className:"action-error-msg"}),y.default.createElement("span",{className:"action-user"})),y.default.createElement("div",{className:P.default.btns},a?y.default.createElement("span",{onClick:this.close,className:P.default.btn},y.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.LogItem.put"})):y.default.createElement("span",{onClick:this.open,className:P.default.btn},y.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.LogItem.details"})))),w.default.isShowCommitInfo(s)?y.default.createElement("div",{className:P.default.codeVersion},y.default.createElement("div",{className:P.default.versionInfo},y.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.LogItem.information"})," ",w.default.getCommitLog(s)),y.default.createElement("div",{className:P.default.versionAuthor},"#",w.default.getCodeVersion(s),"by ",w.default.getCommitUser(s))):"",y.default.createElement(N,{style:{display:this.showLogType()},size:"small",className:P.default.logTypeBtn},y.default.createElement(h.default,{onClick:()=>{this.changeLogType("info")},className:"info"===l?"active":"",type:"dashed"},y.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.LogItem.info"})),y.default.createElement(h.default,{onClick:()=>{this.changeLogType("debug")},className:"debug"===l?"active":"",type:"dashed"},y.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.LogItem.debug"})),y.default.createElement(h.default,{onClick:()=>{this.changeLogType("error")},className:"error"===l?"active":"",type:"dashed"},y.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.LogItem.error"}))),y.default.createElement("div",{style:{height:this.getLogContHeight(),maxHeight:350,overflowY:"auto"},className:"".concat(P.default.logContent," logs-cont")},"ing"===t?y.default.createElement(_.default,{resover:!0,onClose:this.onClose,onComplete:this.onComplete,onSuccess:this.onSuccess,onTimeout:this.onTimeout,onFail:this.onFail,socketUrl:this.getSocketUrl(),eventId:s.event_id,opened:a,list:this.state.logs}):y.default.createElement("div",null,n&&n.length>0&&n.map((e,t)=>y.default.createElement("p",{key:t},y.default.createElement("span",{style:{marginRight:10}},M.default.format(e.time,"hh:mm:ss")),y.default.createElement("span",null,e.message))))))):null}},d.contextTypes={isActionIng:v.default.func,appRolback:v.default.func},o=c));var R=(u=(0,g.connect)(e=>{var t=e.user,a=e.appControl;return{currUser:t.currentUser,appRequest:a.appRequest,appRequestRange:a.appRequestRange,requestTime:a.requestTime,requestTimeRange:a.requestTimeRange,appDisk:a.appDisk,appMemory:a.appMemory}},null,null,{withRef:!0}),u((f=p=class extends y.PureComponent{constructor(e){var t;super(e),t=this,this.load=(()=>{this.fetchPods(!0),this.fetchOperationLog(!0)}),this.closeTimer=(()=>{this.fetchOperationLogTimer&&clearInterval(this.fetchOperationLogTimer),this.fetchPodsTimer&&clearInterval(this.fetchPodsTimer)}),this.handleResourcesLoading=(()=>{this.setState({resourcesLoading:!1})}),this.fetchOperationLog=function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.props.dispatch({type:"appControl/fetchOperationLog",payload:{team_name:C.default.getCurrTeamName(),app_alias:t.props.appAlias,target:"service",page:t.state.page,page_size:t.state.page_size},callback:l=>{l&&200===l.status_code&&t.setState({isopenLog:a,has_next:l.has_next||!1,logList:l.list||[],recordLoading:!1},()=>{e&&t.handleTimers("fetchOperationLogTimer",()=>{t.fetchOperationLog(!0)},5e3)})},handleError:e=>{t.handleError(e),t.handleTimers("fetchOperationLogTimer",()=>{t.fetchOperationLog(!0)},1e4)}})},this.handleError=(e=>{var t=this.state.componentTimers;if(!t)return null;e&&e.data&&e.data.msg_show&&i.default.warning({message:(0,b.formatMessage)({id:"notification.warn.error"}),description:e.data.msg_show})}),this.handleTimers=((e,t,a)=>{var l=this.state.componentTimers;if(!l)return null;this[e]=setTimeout(()=>{t()},a)}),this.handleNextPage=(()=>{this.setState({page:1,page_size:this.state.page_size*(this.state.page+1)},()=>{this.fetchOperationLog(!1)})}),this.handleRollback=(e=>{this.context.appRolback(e)}),this.onAction=(e=>{this.fetchOperationLog(!1),this.getVersionList()}),this.onLogPush=(e=>{this.fetchOperationLog(!1,e)}),this.handleDel=(e=>{this.props.dispatch({type:"appControl/delAppVersion",payload:{team_name:C.default.getCurrTeamName(),service_alias:this.props.appAlias,version_id:e.build_version},callback:e=>{e&&(i.default.success({message:(0,b.formatMessage)({id:"notification.success.delete"})}),this.getVersionList())}})}),this.onPageChange=(e=>{this.setState({pages:e},()=>{this.getVersionList()})}),this.onShowSizeChange=((e,t)=>{this.setState({pages:e,pageSize:t},()=>{this.getVersionList()})}),this.getVersionList=(e=>{var t=this.props,a=t.setShowUpgrade,l=t.appAlias,n=t.dispatch;e&&a();var s=this.state,i=s.pages,r=s.pageSize;n({type:"appControl/getAppVersionList",payload:{team_name:C.default.getCurrTeamName(),service_alias:l,page_num:i,page_size:r},callback:e=>{if(e&&e.bean&&e.list){var t=e.bean,a=e.list,l=e.total,n=void 0===l?0:l,s=null;a.length>0&&a.map(e=>{e.build_version===t.current_version&&(s=e)}),this.setState({current_version:t.current_version,beanData:s,dataList:a,total:n})}}})}),this.loadBuildSourceInfo=(()=>{var e=this.props.dispatch;e({type:"appControl/getAppBuidSource",payload:{team_name:C.default.getCurrTeamName(),service_alias:this.props.appAlias},callback:e=>{e&&this.setState({buildSource:e.bean&&e.bean.service_source&&e.bean.service_source})}})}),this.fetchPods=(e=>{var t=this.props,a=t.appAlias,l=t.dispatch;l({type:"appControl/fetchPods",payload:{team_name:C.default.getCurrTeamName(),app_alias:a},callback:t=>{t&&200===t.status_code&&this.setState({new_pods:t.list.new_pods,old_pods:t.list.old_pods,runLoading:!1},()=>{e&&this.handleTimers("fetchPodsTimer",()=>{this.fetchPods(!0)},5e3)})},handleError:e=>{this.handleError(e),this.handleTimers("fetchPodsTimer",()=>{this.fetchPods(!0)},1e4)}})}),this.handleMore=(e=>{this.setState({more:e})}),this.state={logList:[],recordLoading:!0,page:1,page_size:6,disk:0,memory:0,resourcesLoading:!0,beanData:null,dataList:[],runLoading:!0,new_pods:null,old_pods:null,more:!1,current_version:null,pages:1,pageSize:10,total:0,status:"",isopenLog:!1,buildSource:null,componentTimers:this.props.timers},this.inerval=5e3}componentDidMount(){this.mounted=!0,this.loadBuildSourceInfo(),this.fetchAppDiskAndMemory(),this.getVersionList(),this.load()}componentWillReceiveProps(e){var t=e.status,a=e.timers,l=this.props,n=l.status,s=l.timers;t!==n&&this.setState({status:t}),a!==s&&this.setState({componentTimers:a},()=>{a?this.load():this.closeTimer()})}componentWillUnmount(){this.mounted=!1,this.closeTimer()}fetchAppDiskAndMemory(){this.props.dispatch({type:"appControl/getAppResource",payload:{team_name:C.default.getCurrTeamName(),app_alias:this.props.appAlias},callback:e=>{e&&e.bean&&this.setState({disk:e.bean.disk||0,memory:e.bean.memory||0}),this.handleResourcesLoading()},handleError:e=>{this.handleResourcesLoading(),this.handleError(e)}})}getStartTime(){return(new Date).getTime()/1e3-3600}getStep(){return 60}render(){var e=this.props,t=e.status,a=e.componentPermissions,l=e.socket,n=e.appDetail,i=this.state,r=i.resourcesLoading,o=i.logList,d=i.memory,c=i.beanData,u=i.dataList,m=i.new_pods,p=i.old_pods,f=i.runLoading,h=i.more,g=i.disk,v=i.buildSource,_=i.isopenLog,E=i.recordLoading,w=i.has_next,M=i.current_version,C=i.pages,S=i.pageSize,O=i.total;return y.default.createElement(y.Fragment,null,y.default.createElement(x.default,{isThird:n&&n.is_third,buildSource:v,beanData:c,resourcesLoading:r,memory:d,disk:g,dataList:u,status:t,onPageChange:this.onPageChange,handleMore:this.handleMore,more:h,socket:l&&l}),h&&y.default.createElement(F.default,{componentPermissions:a,beanData:c,current_version:M,dataList:u,onPageChange:this.onPageChange,onShowSizeChange:this.onShowSizeChange,handleDel:this.handleDel,onRollback:this.handleRollback,socket:l&&l,pages:C,pageSize:S,total:O}),!h&&y.default.createElement(s.default,{loading:f,title:y.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.instance.title"}),style:{margin:"20px 0",minHeight:"170px"},bodyStyle:{padding:"0",background:"#F0F2F5"}},y.default.createElement(T.default,{status:t,runLoading:f,new_pods:m,old_pods:p,appAlias:this.props.appAlias,socket:l&&l,podType:n&&n.service&&n.service.extend_method})),!h&&y.default.createElement(D.default,{socket:l&&l,isopenLog:_,onLogPush:this.onLogPush,has_next:w,logList:o,recordLoading:E,handleNextPage:this.handleNextPage}))}},p.contextTypes={isActionIng:v.default.func,appRolback:v.default.func},m=f))||m);t.default=R},"760Q":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV"));a("y8nQ");var i,r,o,d=l(a("Vl3Y")),c=n(a("q1tI")),u=a("LLXN"),m=l(a("ll25")),p=d.default.Item,f=(i=d.default.create(),i((o=class extends c.PureComponent{constructor(){super(...arguments),this.onCancel=(()=>{this.props.onCancel()}),this.handleSubmit=(e=>{e.preventDefault();var t=this.props.form;t.validateFields((e,t)=>{e||this.props.onSubmit(t)})})}render(){var e=this.props.form.getFieldDecorator,t=this.props,a=t.actions,l=t.value;return c.default.createElement(s.default,{title:c.default.createElement(u.FormattedMessage,{id:"componentOverview.body.EditActions.edit"}),visible:!0,onOk:this.handleSubmit,maskClosable:!1,onCancel:this.onCancel},c.default.createElement(d.default,{onSubmit:this.handleSubmit},c.default.createElement(p,{label:""},e("perm_ids",{initialValue:l,rules:[{required:!0,message:(0,u.formatMessage)({id:"componentOverview.body.EditActions.not_yet"})}]})(c.default.createElement(m.default,{showGroupName:!1,hides:["".concat((0,u.formatMessage)({id:"componentOverview.body.EditActions.not_yet"}))],datas:a})))))}},r=o))||r);t.default=f},"8Drs":function(e,t,a){"use strict";var l=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var n=l(a("bx4M"));a("/xke");var s=l(a("TeRw")),i=l(a("p0pE"));a("y8nQ");var r,o,d,c,u=l(a("Vl3Y")),m=a("MuoO"),p=l(a("q1tI")),f=a("LLXN"),h=l(a("CQXj")),g=l(a("QDog")),v=l(a("Bg2k")),y=(r=(0,m.connect)(e=>{var t=e.user,a=e.appControl,l=e.teamControl;return{currUser:t.currentUser,innerEnvs:a.innerEnvs,startProbe:a.startProbe,runningProbe:a.runningProbe,ports:a.ports,baseInfo:a.baseInfo,appDetail:a.appDetail,teamControl:l,appControl:a}},null,null,{withRef:!0}),o=u.default.create(),r(d=o((c=class extends p.default.Component{constructor(e){super(e),this.handleParameter=(()=>{return{team_name:g.default.getCurrTeamName(),app_alias:this.props.appAlias}}),this.handleGetList=(()=>{var e=this.props.dispatch;e({type:"appControl/getInstanceList",payload:this.handleParameter(),callback:e=>{this.setState({list:e&&e.list||[],loading:!1})}})}),this.fetchInterface=(e=>{var t=this.props.dispatch;t({type:e,payload:this.handleParameter()})}),this.fetchBaseInfo=(()=>{this.fetchInterface("appControl/fetchBaseInfo")}),this.fetchPorts=(()=>{this.fetchInterface("appControl/fetchPorts")}),this.fetchTags=(()=>{this.fetchInterface("appControl/fetchTags")}),this.handleSubmitEdit=(e=>{this.setState({healthCheckLoading:!0});var t=this.props,a=t.startProbe,l=t.dispatch;l({type:"appControl/editStartProbe",payload:(0,i.default)({},this.handleParameter(),e,{old_mode:a.mode}),callback:e=>{this.handleCancel(),this.fetchStartProbe(),e&&e.status_code&&200===e.status_code&&s.default.info({message:(0,f.formatMessage)({id:"notification.hint.need_updata"})})}})}),this.handleCancel=(()=>{this.setState({showHealth:!1,healthCheckLoading:!1})}),this.openCancel=(()=>{this.setState({showHealth:!0})}),this.handleState=(()=>{var e=this.state.list||[{status:"-"}],t=0,a=0,l=0,n="";return e.map(e=>{var s=e.status;return"healthy"==s?t++:"unhealthy"==s?a++:"Unknown"==s||"unknown"==s?l++:n="-",e}),0!=t&&0==a&&0===l&&0===l&&""==n?p.default.createElement("span",null,"(",p.default.createElement("span",{style:{color:"green"}},p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.Members.health"})),")"):0==t||0==a&&0==l?0==t&&0!=a&&0==l&&""==n?p.default.createElement("span",null,"(",p.default.createElement("span",{style:{color:"red"}},p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.Members.unhealth"})),")"):0==t&&0==a&&0!=l&&""==n?p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.Members.unknown"}):"(-)":p.default.createElement("span",null,"(",p.default.createElement("span",{style:{color:"green"}},p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.Members.partial_health"})),")")}),this.handleStartProbeStart=(e=>{var t=this.props,a=t.startProbe,l=t.dispatch;l({type:"appControl/editStartProbe",payload:(0,i.default)({},this.handleParameter(),a,{is_used:e}),callback:e=>{e&&e.status_code&&200===e.status_code&&s.default.info({message:(0,f.formatMessage)({id:"notification.hint.need_updata"})}),this.fetchStartProbe()}})}),this.state={showHealth:!1,loading:!0,list:[]}}componentDidMount(){this.props.dispatch({type:"teamControl/fetchAllPerm"}),this.fetchStartProbe(),this.fetchPorts(),this.fetchBaseInfo(),this.fetchTags(),this.handleGetList()}fetchStartProbe(){this.fetchInterface("appControl/fetchStartProbe")}render(){var e=this.props,t=e.baseInfo,a=e.startProbe,l=e.ports;if("boolean"!==typeof t.build_upgrade)return null;var s=this.state,i=s.showHealth,r=s.loading,o=s.healthCheckLoading,d={readiness:(0,f.formatMessage)({id:"componentOverview.body.Members.offline"}),liveness:(0,f.formatMessage)({id:"componentOverview.body.Members.restart"})},c="{}"!=JSON.stringify(a),u={width:"33%",textAlign:"center"};return p.default.createElement("div",null,a&&p.default.createElement(n.default,{loading:r,title:p.default.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.setting.health"}),p.default.createElement("div",null,a&&p.default.createElement("a",{style:{marginRight:"5px",fontSize:"14px",fontWeight:400},onClick:()=>{this.openCancel()}},c?p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.setting.edit"}):p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.setting.set"})),c&&h.default.isStartProbeStart(a)?p.default.createElement("a",{onClick:()=>{this.handleStartProbeStart(!1)},style:{marginRight:"5px",fontSize:"14px",fontWeight:400},href:"javascript:;"},p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.setting.Disable"})):c&&p.default.createElement("a",{onClick:()=>{this.handleStartProbeStart(!0)},style:{marginRight:"5px",fontSize:"14px",fontWeight:400},href:"javascript:;"},p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.setting.Enable"}))))},a&&p.default.createElement("div",{style:{display:"flex"}},p.default.createElement("div",{style:u},p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.setting.state"}),this.handleState()),p.default.createElement("div",{style:u},p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.setting.method"}),a.scheme||p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.setting.Not_set"})),p.default.createElement("div",{style:u},p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.setting.unhealth"}),d[a.mode]||p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.setting.Not_set"})))),i&&p.default.createElement(v.default,{title:p.default.createElement(f.FormattedMessage,{id:"componentOverview.body.setting.health"}),types:"third",ports:l,loading:o,data:a,onOk:this.handleSubmitEdit,onCancel:this.handleCancel}))}},d=c))||d)||d);t.default=y},"8N5S":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("5Dmo");var s=l(a("3S7+"));a("IzEo");var i=l(a("bx4M"));a("g9YV");var r=l(a("wCAj"));a("+L6B");var o=l(a("2/Rp"));a("Pwec");var d=l(a("CtXQ"));a("14J3");var c=l(a("BMrR"));a("jCWc");var u=l(a("kPKH"));a("fOrg");var m=l(a("+KLJ"));a("/xke");var p,f,h,g=l(a("TeRw")),v=l(a("p0pE")),y=a("MuoO"),b=a("7DNP"),_=n(a("q1tI")),E=l(a("Zxzx")),w=l(a("7C1b")),M=l(a("q76B")),C=l(a("cUW5")),S=l(a("gOyy")),O=l(a("puxM")),k=a("xpXo"),A=l(a("QDog")),x=a("+n12"),D=a("LLXN"),F=(p=(0,y.connect)(e=>{var t=e.user,a=e.appControl;return{currUser:t.currentUser,volumes:a.volumes,appBaseInfo:a.baseInfo}},null,null,{withRef:!0}),p((h=class extends _.PureComponent{constructor(e){super(e),this.onDeleteMnt=(e=>{this.setState({toDeleteMnt:e})}),this.onDeleteVolume=(e=>{this.setState({toDeleteVolume:e})}),this.onEditVolume=(e=>{this.setState({showAddVar:e,editor:e})}),this.onCancelDeleteVolume=(()=>{this.setState({toDeleteVolume:null})}),this.getVolumeTypeShowName=(e=>{var t=this.state.volumeOpts;return(0,x.getVolumeTypeShowName)(t,e)}),this.handleOpenRelyComponent=(e=>{this.setState({relyComponent:!0,relyComponentList:e})}),this.handleCloseRelyComponent=(()=>{this.setState({relyComponent:!1,relyComponentList:[]})}),this.fetchVolumes=(()=>{this.props.dispatch({type:"appControl/fetchVolumes",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,is_config:!1}})}),this.fetchVolumeOpts=(()=>{this.props.dispatch({type:"appControl/fetchVolumeOpts",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias},callback:e=>{e&&this.setState({volumeOpts:e.list||[]})}})}),this.fetchBaseInfo=(()=>{var e=this.props.dispatch;e({type:"appControl/fetchBaseInfo",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias}})}),this.loadMntList=(()=>{(0,k.getMnt)({team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,page:1,page_size:1e3,volume_type:["share-file","memoryfs","local"],type:"mnt"}).then(e=>{e&&this.setState({mntList:e.list||[]})})}),this.handleAddVar=(()=>{this.setState({showAddVar:{new:!0}})}),this.handleCancelAddVar=(()=>{this.setState({showAddVar:null,editor:null})}),this.handleSubmitAddVar=(e=>{this.fetchBaseInfo();var t=this.state.editor;t?this.props.dispatch({type:"appControl/editorVolume",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,new_volume_path:e.volume_path,new_file_content:e.file_content,ID:t.ID},callback:()=>{this.fetchVolumes(),this.handleCancelAddVar(),this.props.onshowRestartTips(!0),this.remindInfo()}}):this.props.dispatch({type:"appControl/addVolume",payload:(0,v.default)({team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias},e),callback:()=>{this.fetchVolumes(),this.handleCancelAddVar(),this.props.onshowRestartTips(!0),this.remindInfo()}})}),this.remindInfo=(()=>{var e=this.props.appBaseInfo;e&&e.extend_method&&A.default.isStateComponent(e.extend_method)?g.default.warning({message:_.default.createElement("div",null,(0,D.formatMessage)({id:"notification.warn.state"}),_.default.createElement("br",null),(0,D.formatMessage)({id:"notification.warn.restart"}))}):g.default.success({message:(0,D.formatMessage)({id:"notification.success.succeeded"})})}),this.showAddRelation=(()=>{this.loadMntList(),this.setState({showAddRelation:!0})}),this.handleCancelAddRelation=(()=>{this.loadMntList(),this.setState({showAddRelation:!1})}),this.handleSubmitAddMnt=(e=>{(0,k.addMnt)({team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,body:e}).then(e=>{e&&(this.handleCancelAddRelation(),g.default.success({message:(0,D.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0))})}),this.handleDeleteVolume=(()=>{this.props.dispatch({type:"appControl/deleteVolume",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,volume_id:this.state.toDeleteVolume.ID},callback:()=>{this.onCancelDeleteVolume(),this.fetchVolumes(),g.default.success({message:(0,D.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0)}})}),this.handleDeleteMnt=(()=>{this.props.dispatch({type:"appControl/deleteMnt",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,dep_vol_id:this.state.toDeleteMnt.dep_vol_id},callback:()=>{this.cancelDeleteMnt(),this.loadMntList(),g.default.success({message:(0,D.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0)}})}),this.cancelDeleteMnt=(()=>{this.setState({toDeleteMnt:null})}),this.state={showAddVar:null,showAddRelation:!1,mntList:[],toDeleteMnt:null,toDeleteVolume:null,editor:null,volumeOpts:[],relyComponent:!1,relyComponentList:[]}}componentDidMount(){this.fetchVolumeOpts(),this.loadMntList(),this.fetchVolumes(),this.fetchBaseInfo()}canView(){var e=this.props.componentPermissions.isStorage;return e}render(){var e=this.state,t=e.mntList,a=e.relyComponent,l=e.relyComponentList,n=this.props.volumes;return this.canView()?_.default.createElement(_.Fragment,null,_.default.createElement(c.default,null,_.default.createElement(u.default,{span:12},_.default.createElement(m.default,{showIcon:!0,message:(0,D.formatMessage)({id:"componentOverview.body.mnt.Alert.message"}),type:"info",style:{marginBottom:24}}))),_.default.createElement(i.default,{style:{marginBottom:24},title:_.default.createElement("span",null,"  ",(0,D.formatMessage)({id:"componentOverview.body.mnt.save_setting"})),extra:_.default.createElement(o.default,{onClick:this.handleAddVar},_.default.createElement(d.default,{type:"plus"}),(0,D.formatMessage)({id:"componentOverview.body.mnt.add_storage"}))},_.default.createElement(O.default,{sm:650},_.default.createElement(r.default,{pagination:!1,columns:[{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.volume_name"}),dataIndex:"volume_name",render:(e,t)=>{return _.default.createElement("span",{style:{cursor:"pointer",color:t.dep_services&&"#1890ff"},onClick:()=>{t.dep_services&&this.handleOpenRelyComponent(t.dep_services)}},e)}},{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.volume_path"}),dataIndex:"volume_path"},{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.volume_type"}),dataIndex:"volume_type",render:e=>{return _.default.createElement("span",null,this.getVolumeTypeShowName(e))}},{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.volume_capacity"}),dataIndex:"volume_capacity",render:e=>{return 0==e?_.default.createElement("span",null,(0,D.formatMessage)({id:"componentOverview.body.mnt.unlimited"})):_.default.createElement("span",null,e,"GB")}},{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.status"}),dataIndex:"status",render:e=>{return"not_bound"==e?_.default.createElement("span",{style:{color:"red"}},(0,D.formatMessage)({id:"componentOverview.body.mnt.unmounted"})):_.default.createElement("span",{style:{color:"green"}},(0,D.formatMessage)({id:"componentOverview.body.mnt.mounted"}))}},{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.action"}),dataIndex:"action",render:(e,t)=>_.default.createElement("div",null,_.default.createElement("a",{onClick:()=>{this.onDeleteVolume(t)},href:"javascript:;"},(0,D.formatMessage)({id:"componentOverview.body.mnt.deldete"})),_.default.createElement("a",{onClick:()=>{this.onEditVolume(t)},href:"javascript:;"},(0,D.formatMessage)({id:"componentOverview.body.mnt.edit"})))}],dataSource:n}))),_.default.createElement(i.default,{title:_.default.createElement("span",null," ",(0,D.formatMessage)({id:"componentOverview.body.mnt.share"})," "),extra:_.default.createElement(o.default,{onClick:this.showAddRelation},_.default.createElement(d.default,{type:"plus"}),(0,D.formatMessage)({id:"componentOverview.body.mnt.mount"}))},_.default.createElement(O.default,{sm:850},_.default.createElement(r.default,{pagination:!1,columns:[{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.local_vol_path"}),dataIndex:"local_vol_path",key:"1",width:"20%",render:e=>_.default.createElement(s.default,{title:e},_.default.createElement("span",{style:{wordBreak:"break-all",wordWrap:"break-word"}},e))},{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.dep_vol_name"}),dataIndex:"dep_vol_name",key:"2",width:"15%",render:e=>_.default.createElement(s.default,{title:e},_.default.createElement("span",{style:{wordBreak:"break-all",wordWrap:"break-word"}},e))},{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.dep_vol_path"}),dataIndex:"dep_vol_path",key:"3",width:"15%",render:e=>_.default.createElement(s.default,{title:e},_.default.createElement("span",{style:{wordBreak:"break-all",wordWrap:"break-word"}},e))},{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.dep_vol_type"}),dataIndex:"dep_vol_type",key:"4",width:"10%",render:e=>{return _.default.createElement("span",null,this.getVolumeTypeShowName(e))}},{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.dep_app_name"}),dataIndex:"dep_app_name",key:"5",width:"10%",render:(e,t)=>_.default.createElement(b.Link,{to:"/team/".concat(A.default.getCurrTeamName(),"/region/").concat(A.default.getCurrRegionName(),"/components/").concat(t.dep_app_alias,"/overview")},e)},{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.dep_app_group"}),dataIndex:"dep_app_group",key:"6",width:"15%",render:(e,t)=>_.default.createElement(b.Link,{to:"/team/".concat(A.default.getCurrTeamName(),"/region/").concat(A.default.getCurrRegionName(),"/apps/").concat(t.dep_group_id)},e)},{title:(0,D.formatMessage)({id:"componentOverview.body.mnt.action"}),dataIndex:"action",key:"7",width:"15%",render:(e,t)=>_.default.createElement("a",{onClick:()=>{this.onDeleteMnt(t)},href:"javascript:;"},(0,D.formatMessage)({id:"componentOverview.body.mnt.unmount"}))}],dataSource:t}))),this.state.showAddVar&&_.default.createElement(E.default,{onCancel:this.handleCancelAddVar,onSubmit:this.handleSubmitAddVar,data:this.state.showAddVar,volumeOpts:this.state.volumeOpts,editor:this.state.editor}),this.state.showAddRelation&&_.default.createElement(w.default,{appAlias:this.props.appAlias,onCancel:this.handleCancelAddRelation,onSubmit:this.handleSubmitAddMnt,volume_type:["share-file","memoryfs","local"]}),this.state.toDeleteMnt&&_.default.createElement(M.default,{title:_.default.createElement(D.FormattedMessage,{id:"confirmModal.deldete.Unmount.title"}),desc:_.default.createElement(D.FormattedMessage,{id:"confirmModal.deldete.Unmount.desc"}),onCancel:this.cancelDeleteMnt,onOk:this.handleDeleteMnt}),this.state.toDeleteVolume&&_.default.createElement(M.default,{title:_.default.createElement(D.FormattedMessage,{id:"confirmModal.deldete.storage.title"}),desc:_.default.createElement(D.FormattedMessage,{id:"confirmModal.deldete.storage.desc"}),onCancel:this.onCancelDeleteVolume,onOk:this.handleDeleteVolume}),a&&_.default.createElement(S.default,{title:_.default.createElement(D.FormattedMessage,{id:"componentOverview.body.RelyComponentModal.title"}),relyComponentList:l,onCancel:this.handleCloseRelyComponent,onOk:this.handleCloseRelyComponent})):_.default.createElement(C.default,null)}},f=h))||f);t.default=F},"8kxS":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a("jehZ"));a("fOrg");var i=l(a("+KLJ"));a("5Dmo");var r=l(a("3S7+"));a("Awhp");var o=l(a("KrTs"));a("+L6B");var d=l(a("2/Rp"));a("/zsF");var c=l(a("PArb"));a("Pwec");var u=l(a("CtXQ")),m=l(a("p0pE"));a("5NDa");var p=l(a("5rEg"));a("2qtc");var f=l(a("kLXV"));a("/xke");var h=l(a("TeRw"));a("7Kak");var g=l(a("9yH6"));a("OaEy");var v=l(a("2fM7"));a("y8nQ");var y,b,_,E,w,M,C,S,O,k,A,x,D,F,T,P,N,R=l(a("Vl3Y")),I=a("MuoO"),L=a("7DNP"),V=l(a("17x9")),B=n(a("q1tI")),H=l(a("q76B")),q=l(a("e6Ls")),U=l(a("iPMB")),z=l(a("hJQD")),j=l(a("XZXw")),X=a("xpXo"),K=l(a("lpA0")),Q=l(a("DPVJ")),W=l(a("WTXe")),G=a("vSx2"),Y=l(a("J5jb")),J=l(a("QDog")),Z=l(a("rIpq")),$=l(a("hMqj")),ee=l(a("zcww")),te=l(a("+iC2")),ae=l(a("3A2o")),le=l(a("sC1O")),ne=l(a("ZwJH")),se=l(a("LrcT")),ie=l(a("+aXB")),re=l(a("8Drs")),oe=l(a("8N5S")),de=l(a("YoF6")),ce=l(a("6mLI")),ue=l(a("308x")),me=l(a("dhX0")),pe=l(a("Szue")),fe=l(a("Lo2C")),he=l(a("Lu99")),ge=l(a("vX3j")),ve=a("WDw0"),ye=a("LLXN"),be=R.default.Item,_e=v.default.Option,Ee=g.default.Group,we=(y=R.default.create(),b=(0,I.connect)(null,null,null,{withRef:!0}),y(_=b((E=class extends B.PureComponent{constructor(){super(...arguments),this.onCancel=(()=>{this.props.onCancel()}),this.handleSubmit=(e=>{e.preventDefault();var t=this.props,a=t.form,l=t.currGroup;a.validateFields((e,t)=>{e||(t.group_id!==l?this.props.onOk(t):h.default.warning({message:(0,ye.formatMessage)({id:"notification.warn.cannot_select"})}))})})}render(){var e=this.props,t=e.groups,a=void 0===t?[]:t,l=e.currGroup,n=e.form,s=e.loading,i=void 0!==s&&s,r=n.getFieldDecorator,o=l.toString();return B.default.createElement(f.default,{title:B.default.createElement(ye.FormattedMessage,{id:"componentOverview.MoveGroup.edit"}),visible:!0,className:q.default.TelescopicModal,onOk:this.handleSubmit,onCancel:this.onCancel,confirmLoading:i},B.default.createElement(R.default,{onSubmit:this.handleSubmit},B.default.createElement(be,{label:""},r("group_id",{initialValue:o||"",rules:[{required:!0,message:(0,ye.formatMessage)({id:"componentOverview.MoveGroup.edit"})}]})(B.default.createElement(v.default,{getPopupContainer:e=>e.parentNode},a&&a.length>0&&a.map(e=>{return B.default.createElement(_e,{key:e.group_id,value:e.group_id.toString()},e.group_name)}))))))}},_=E))||_)||_),Me=(w=R.default.create(),M=(0,I.connect)(null,null,null,{withRef:!0}),w(C=M((S=class extends B.PureComponent{constructor(){super(...arguments),this.onCancel=(()=>{this.props.onCancel()}),this.handleSubmit=(e=>{e.preventDefault();var t=this.props.form;t.validateFields((e,t)=>{e||this.props.onOk(t)})}),this.handleValiateNameSpace=((e,t,a)=>{if(!t)return a(new Error("".concat((0,ye.formatMessage)({id:"componentOverview.EditName.input_en_name"}))));if(t&&t.length<=32){var l=/^[a-z]([-a-z0-9]*[a-z0-9])?$/;if(!l.test(t))return a(new Error("".concat((0,ye.formatMessage)({id:"componentOverview.EditName.only"}))));a()}return t.length>32?a(new Error("".concat((0,ye.formatMessage)({id:"componentOverview.EditName.Cannot"})))):void 0})}render(){var e=this.props,t=e.title,a=e.name,l=e.loading,n=void 0!==l&&l,s=e.form,i=e.k8sComponentName,r=e.isEditEnglishName,o="closed"===r||"undeploy"===r,d=s.getFieldDecorator;return B.default.createElement(f.default,{title:t||B.default.createElement(ye.FormattedMessage,{id:"componentOverview.EditName.edit"}),visible:!0,className:q.default.TelescopicModal,confirmLoading:n,onOk:this.handleSubmit,onCancel:this.onCancel},B.default.createElement(R.default,{onSubmit:this.handleSubmit},B.default.createElement(be,{label:B.default.createElement(ye.FormattedMessage,{id:"componentOverview.EditName.name"})},d("service_cname",{initialValue:a||"",rules:[{required:!0,message:(0,ye.formatMessage)({id:"componentOverview.EditName.not_null"})},{max:24,message:(0,ye.formatMessage)({id:"componentOverview.EditName.max"})}]})(B.default.createElement(p.default,{placeholder:t?(0,ye.formatMessage)({id:"componentOverview.EditName.input_new_name"}):(0,ye.formatMessage)({id:"componentOverview.EditName.input_new_app_name"})}))),B.default.createElement(be,{label:B.default.createElement(ye.FormattedMessage,{id:"componentOverview.EditName.en_name"}),extra:(0,ye.formatMessage)({id:"componentOverview.EditName.close"})},d("k8s_component_name",{initialValue:i||"",rules:[{required:!0,validator:this.handleValiateNameSpace}]})(B.default.createElement(p.default,{placeholder:(0,ye.formatMessage)({id:"componentOverview.EditName.placeholder"}),disabled:!o})))))}},C=S))||C)||C),Ce=(O=R.default.create(),k=(0,I.connect)(e=>{var t=e.user,a=e.appControl,l=e.global,n=e.teamControl,s=e.enterprise,i=e.loading;return{currUser:t.currentUser,appDetail:a.appDetail,pods:a.pods,groups:l.groups,build_upgrade:a.build_upgrade,currentTeam:n.currentTeam,currentRegionName:n.currentRegionName,currentEnterprise:s.currentEnterprise,deleteAppLoading:i.effects["appControl/deleteApp"],reStartLoading:i.effects["appControl/putReStart"],startLoading:i.effects["appControl/putStart"],stopLoading:i.effects["appControl/putStop"],moveGroupLoading:i.effects["appControl/moveGroup"],editNameLoading:i.effects["appControl/editName"],updateRollingLoading:i.effects["appControl/putUpdateRolling"],deployLoading:i.effects["appControl/putUpgrade"],buildInformationLoading:i.effects["appControl/getBuildInformation"]}},null,null,{withRef:!0}),O(A=k((D=x=class extends B.PureComponent{constructor(e){var t;super(e),t=this,this.onDeleteApp=(()=>{this.setState({showDeleteApp:!0})}),this.getStatus=(e=>{var t=this.props.dispatch,a=this.state.componentTimer,l=this.fetchParameter(),n=l.team_name,s=l.app_alias;t({type:"appControl/fetchComponentState",payload:{team_name:n,app_alias:s},callback:t=>{t&&200===t.status_code&&this.setState({status:t.bean},()=>{e&&a&&this.handleTimers("timer",()=>{this.getStatus(!0)},5e3)})},handleError:t=>{this.handleError(t),e&&a&&404!==t.status&&this.handleTimers("timer",()=>{this.getStatus(!0)},1e4)}})}),this.getChildCom=(()=>{return this.ref?this.ref.getWrappedInstance({}):null}),this.handleTeamPermissions=(e=>{var t=this.props.currUser,a=te.default.getTeamByTeamPermissions(t.teams,J.default.getCurrTeamName());a&&0!==a.length?e():this.closeComponentTimer()}),this.handleError=(e=>{var t=this.state.componentTimer,a=this.props.dispatch,l=this.fetchParameter(),n=l.group_id;return this.handleTeamPermissions(()=>{return t?e&&404===e.status?(this.closeComponentTimer(),this.destroy||a(L.routerRedux.push("".concat(this.fetchPrefixUrl(),"apps/").concat(n))),null):void(e&&e.data&&e.data.msg_show&&h.default.warning({message:(0,ye.formatMessage)({id:"notification.warn.error"}),description:e.data.msg_show})):null}),null}),this.handleTimers=((e,t,a)=>{var l=this.state.componentTimer;if(!l)return null;this[e]=setTimeout(()=>{t()},a)}),this.handleTabChange=(e=>{var t=this.props.dispatch,a=this.fetchParameter(),l=a.app_alias;t(L.routerRedux.push("".concat(this.fetchPrefixUrl(),"components/").concat(l,"/").concat(e)))}),this.closeTimer=(()=>{this.timer&&clearInterval(this.timer)}),this.loadBuildState=((e,t)=>{var a=this.fetchParameter(),l=a.team_name,n=(a.serviceAlias,this.props.dispatch);t&&this.setState({BuildState:null}),e&&e.service&&"market"===e.service.service_source&&e.service.service_alias&&n({type:"appControl/getBuildInformation",payload:{team_name:l,app_alias:e.service.service_alias},callback:e=>{e&&200===e.status_code&&this.setState({BuildState:e.list&&e.list.length>0?e.list.length:null})}})}),this.fetchPrefixUrl=(()=>{var e=this.fetchParameter(),t=e.team_name,a=e.region_name;return"/team/".concat(t,"/region/").concat(a,"/")}),this.loadDetail=(e=>{var t=this.props.dispatch,a=this.fetchParameter(),l=a.app_alias,n=a.team_name,s=a.group_id,i=a.serviceAlias,r=this.fetchPrefixUrl();t({type:"appControl/fetchDetail",payload:{team_name:n,app_alias:l},callback:a=>{this.fetchAppDetail(),e?this.loadBuildState(a,e):this.loadBuildState(a),a.service.service_source&&this.setState({isShowThirdParty:!!a.is_third&&a.is_third,tabsShow:!0},()=>{this.setState({routerSwitch:!1})}),K.default.isCreateComplete(a)||K.default.isMarketApp(a)?this.getStatus(!1):a.service&&"complete"===a.service.create_status?(this.getStatus(!1),setTimeout(()=>{this.setState({routerSwitch:!1})},100)):K.default.isCreateFromCompose(a)?t(L.routerRedux.replace("".concat(r,"create/create-compose-check/").concat(s,"/").concat(a.service.compose_id))):(this.setState({routerSwitch:!1}),i&&t(L.routerRedux.replace("".concat(r,"create/create-check/").concat(i)))),this.getWebSocketUrl(a.service.service_id)},handleError:e=>{var a=this.state.componentTimer;return a?(404===e.status&&t(L.routerRedux.push("".concat(r,"exception/404"))),null):null}})}),this.fetchParameter=(()=>{var e=this.props,t=e.appDetail,a=e.match,l=t&&t.service;return{app_alias:a&&a.params&&a.params.appAlias,team_name:J.default.getCurrTeamName(),region_name:J.default.getCurrRegionName(),serviceAlias:l&&l.service_alias,group_id:l&&l.group_id,group_name:l&&l.group_name,service_cname:l&&l.service_cname,k8s_component_name:l&&l.k8s_component_name}}),this.fetchAppDetail=(()=>{var e=this.props,t=e.dispatch,a=e.appDetail,l=this.fetchParameter(),n=l.team_name,s=l.region_name,i=a&&a.service&&a.service.group_id;t({type:"application/fetchGroupDetail",payload:{team_name:n,region_name:s,group_id:i},callback:e=>{e&&200===e.status_code&&this.setState({groupDetail:e.bean,loadingDetail:!1})},handleError:e=>{e&&404===e.code&&t(L.routerRedux.push("".concat(this.fetchPrefixUrl(),"apps")))}})}),this.handleshowDeployTips=(e=>{this.setState({showDeployTips:e})}),this.handleDeploy=(e=>{this.setState({showDeployTips:!1,showreStartTips:!1});var t=this.props,a=t.build_upgrade,l=t.dispatch,n=t.appDetail;if(this.state.actionIng)h.default.warning({message:(0,ye.formatMessage)({id:"notification.warn.executing"})});else{var s=this.fetchParameter(),i=s.team_name,r=s.app_alias;l({type:e?"appControl/putUpgrade":"appControl/putDeploy",payload:{team_name:i,app_alias:r,group_version:e||"",is_upgrate:a},callback:e=>{if(e){this.handleCancelBuild(),this.loadBuildState(n),h.default.success({message:(0,ye.formatMessage)({id:"notification.success.deployment"})});var t=this.getChildCom();t&&t.onLogPush&&t.onLogPush(!0),t&&t.onAction&&t.onAction(e.bean)}this.handleOffHelpfulHints()}})}}),this.handleRollback=(e=>{if(this.state.actionIng)h.default.warning({message:(0,ye.formatMessage)({id:"notification.warn.executing"})});else{var t=this.fetchParameter(),a=t.team_name,l=t.app_alias;(0,X.rollback)({team_name:a,app_alias:l,deploy_version:e.build_version?e.build_version:e.deploy_version?e.deploy_version:"",upgrade_or_rollback:e.upgrade_or_rollback?e.upgrade_or_rollback:-1}).then(t=>{if(t){h.default.success({message:e.upgrade_or_rollback&&1==e.upgrade_or_rollback?(0,ye.formatMessage)({id:"notification.success.upgrade"}):(0,ye.formatMessage)({id:"notification.success.rollback"})});var a=this.getChildCom();a&&a.onAction&&a.onAction(t.bean)}})}}),this.handleshowRestartTips=(e=>{this.setState({showreStartTips:e})}),this.saveRef=(e=>{this.ref=e}),this.handleDropClick=(e=>{"deleteApp"===e&&(this.closeComponentTimer(),this.onDeleteApp()),"moveGroup"===e&&this.showMoveGroup(),"restart"===e&&this.setState({promptModal:"restart"})}),this.closeComponentTimer=(()=>{this.setState({componentTimer:!1}),this.closeTimer()}),this.openComponentTimer=(()=>{this.setState({componentTimer:!0},()=>{this.getStatus(!0)})}),this.cancelDeleteApp=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t.setState({showDeleteApp:!1}),e&&t.openComponentTimer()},this.handleDeleteApp=(()=>{var e=this.props.dispatch,t=this.fetchParameter(),a=t.team_name,l=t.app_alias,n=t.group_id;e({type:"appControl/deleteApp",payload:{team_name:a,app_alias:l},callback:()=>{this.closeComponentTimer(),this.cancelDeleteApp(!1),e({type:"global/fetchGroups",payload:{team_name:a}}),e(L.routerRedux.replace("".concat(this.fetchPrefixUrl(),"apps/").concat(n)))}})}),this.showEditName=(()=>{this.setState({showEditName:!0})}),this.hideEditName=(()=>{this.setState({showEditName:!1})}),this.handleEditName=(e=>{var t=this.fetchParameter(),a=t.team_name,l=t.serviceAlias,n=t.group_id,s=this.props.dispatch;s({type:"appControl/editName",payload:(0,m.default)({team_name:a,app_alias:l},e),callback:()=>{s({type:"application/editGroups",payload:{team_name:a,group_id:n},callback:e=>{h.default.success({message:(0,ye.formatMessage)({id:"notification.success.takeEffect"})})}}),this.handleUpDataHeader(),this.loadDetail(),this.hideEditName()}})}),this.handleUpDataHeader=(()=>{var e=this.props.dispatch;e({type:"global/IsUpDataHeader",payload:{isUpData:!0}})}),this.showMoveGroup=(()=>{this.setState({showMoveGroup:!0})}),this.hideMoveGroup=(()=>{this.setState({showMoveGroup:!1})}),this.handleMoveGroup=(e=>{var t=this.fetchParameter(),a=t.team_name,l=t.serviceAlias,n=this.props.dispatch;n({type:"appControl/moveGroup",payload:(0,m.default)({team_name:a,app_alias:l},e),callback:()=>{this.hideMoveGroup(),this.loadDetail(),n({type:"global/fetchGroups",payload:{team_name:a}}),h.default.success({message:(0,ye.formatMessage)({id:"notification.success.succeeded"})})}})}),this.handleOperation=(e=>{var t=this.props.dispatch,a=this.state.actionIng;if("putUpdateRolling"===e?this.setState({showDeployTips:!1,showreStartTips:!1}):"putReStart"===e&&this.setState({showreStartTips:!1}),a)h.default.warning({message:(0,ye.formatMessage)({id:"notification.warn.executing"})});else{var l={putReStart:(0,ye.formatMessage)({id:"notification.success.operationRestart"}),putStart:(0,ye.formatMessage)({id:"notification.success.operationStart"}),putStop:(0,ye.formatMessage)({id:"notification.success.operationClose"}),putUpdateRolling:(0,ye.formatMessage)({id:"notification.success.operationUpdata"})},n=this.fetchParameter(),s=n.team_name,i=n.app_alias;t({type:"appControl/".concat(e),payload:{team_name:s,app_alias:i},callback:t=>{if(t){h.default.success({message:l[e]});var a=this.getChildCom();a&&a.onAction&&a.onAction(t.bean)}this.handleOffHelpfulHints()}})}}),this.handleChecked=(e=>{var t=this.props.dispatch,a=this.fetchParameter(),l=a.team_name,n=a.app_alias;t({type:"appControl/changeApplicationState",payload:{build_upgrade:e,team_name:l,app_alias:n},callback:e=>{e&&h.default.info({message:(0,ye.formatMessage)({id:"notification.success.modified"})})}})}),this.handleOkBuild=(()=>{this.props.form.validateFields((e,t)=>{e||this.handleDeploy(t.group_version)})}),this.handleOpenBuild=(()=>{var e=this.props,t=e.appDetail,a=e.dispatch,l=t.service.service_source,n=t.rain_app_name,s=this.state.status,i=this.fetchParameter(),r=i.team_name,o=i.serviceAlias;"market"===l&&s&&"undeploy"!==s.status?a({type:"appControl/getBuildInformation",payload:{team_name:r,app_alias:o},callback:e=>{e&&200===e.status_code&&this.setState({BuildList:e.list,visibleBuild:!0,BuildText:n,BuildState:e.list&&e.list.length>0?e.list.length:null,showApp:{details:!1,group_name:n}})}}):this.handleOpenHelpfulHints("deploy")}),this.handleCancelBuild=(()=>{this.setState({visibleBuild:null,BuildText:""})}),this.hideMarketAppDetail=(()=>{this.setState({showMarketAppDetail:null})}),this.hideMarketOpenAppDetail=(()=>{this.setState({showMarketAppDetail:!0})}),this.handleOpenHelpfulHints=(e=>{this.setState({promptModal:e})}),this.handleOffHelpfulHints=(()=>{this.setState({promptModal:null})}),this.handleJumpAgain=(()=>{var e=this.state.promptModal;if("deploy"===e)return this.handleDeploy(),null;var t="stop"===e?"putStop":"start"===e?"putStart":"restart"===e?"putReStart":"rolling"===e?"putUpdateRolling":"";this.handleOperation(t)}),this.toWebConsole=(()=>{var e=this.props.dispatch,t=this.fetchParameter(),a=t.serviceAlias;e(L.routerRedux.replace("".concat(this.fetchPrefixUrl(),"components/").concat(a,"/webconsole")))}),this.state={actionIng:!1,groupDetail:{},loadingDetail:!0,status:{},showDeleteApp:!1,showEditName:!1,showMoveGroup:!1,visibleBuild:null,BuildText:"",BuildList:[],showMarketAppDetail:null,showApp:{},BuildState:null,isShowThirdParty:!1,promptModal:null,websocketURL:"",componentTimer:!0,tabsShow:!1,routerSwitch:!0},this.socket=null,this.destroy=!1}getChildContext(){return{isActionIng:e=>{this.setState({actionIng:e})},appRolback:e=>{this.handleRollback(e)}}}componentDidMount(){this.loadDetail(),setTimeout(()=>{this.getStatus(!0)},5e3)}componentWillUnmount(){this.closeComponentTimer(),this.props.dispatch({type:"appControl/clearPods"}),this.props.dispatch({type:"appControl/clearDetail"}),this.socket&&(this.socket.destroy(),this.socket=null),this.destroy=!0}getWebSocketUrl(e){var t=te.default.getTeamByTeamName(this.props.currUser,J.default.getCurrTeamName()),a=J.default.getCurrRegionName();if(t){var l=ee.default.getRegionByName(t,a);if(l){var n=Z.default.getNewWebSocketUrl(l,e);this.setState({websocketURL:n},()=>{this.createSocket()})}}}createSocket(){var e=this.props.appDetail,t=this.state.websocketURL;if(t){var a=Y.default.isWebSocketOpen(t);a&&"through"===a&&(this.socket=new Q.default({url:t,serviceId:e.service.service_id,isAutoConnect:!0,destroyed:!1}))}}renderTitle(e){var t=this.props,a=t.appDetail,l=t.componentPermissions,n=l.isRestart,s=l.isStop,i=l.isDelete,r=l.isEdit,o=t.appPermissions.isEdit,d=this.state,m=d.status,p=d.groupDetail,f=d.loadingDetail,h=JSON.parse(window.sessionStorage.getItem("name"))||"-",g=p&&p.app_type&&"helm"===p.app_type;return B.default.createElement(B.Fragment,null,B.default.createElement("div",{style:{display:"flex"}},B.default.createElement("div",{style:{marginTop:"3px"}},J.default.fetchSvg("component")),B.default.createElement("div",{style:{marginLeft:"14px"}},B.default.createElement("div",{className:se.default.contentTitle},h||"-",r&&B.default.createElement(u.default,{style:{cursor:"pointer"},onClick:this.showEditName,type:"edit"})),B.default.createElement("div",{className:se.default.content_Box},m&&m.status&&!a.is_third&&n&&!W.default.canStart(m)?B.default.createElement("a",{style:{cursor:W.default.canRestart(m)?"pointer":"no-drop"},onClick:()=>{W.default.canRestart(m)&&this.handleDropClick("restart")}},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.left.reset"})):s&&m&&m.status&&"succeeded"===m.status?B.default.createElement("a",{onClick:()=>{this.handleDropClick("restart")}},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.left.reset"})):null,m&&m.status&&!a.is_third&&n&&B.default.createElement(c.default,{type:"vertical"}),m&&m.status&&s&&!W.default.canStart(m)?B.default.createElement("span",null,B.default.createElement("a",{style:{cursor:W.default.canStop(m)?"pointer":"no-drop"},onClick:()=>{W.default.canStop(m)&&this.handleOpenHelpfulHints("stop")}},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.left.turnoff"})),B.default.createElement(c.default,{type:"vertical"})):s&&m&&m.status&&"upgrade"===m.status||"succeeded"===m.status?B.default.createElement("span",null,B.default.createElement("a",{onClick:()=>{this.handleOpenHelpfulHints("stop")}},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.left.turnoff"})),B.default.createElement(c.default,{type:"vertical"})):null,m&&m.status&&o&&!f&&!g&&B.default.createElement("a",{onClick:()=>{this.handleDropClick("moveGroup")},style:{cursor:"pointer"}},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.left.edit"})),m&&m.status&&r&&!f&&!g&&B.default.createElement(c.default,{type:"vertical"}),m&&m.status&&i&&B.default.createElement("a",{onClick:()=>{this.handleDropClick("deleteApp")},style:{cursor:"pointer"}},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.left.delete"}))))))}render(){var e=this.props,t=e.appDetail,a=e.currentEnterprise,l=e.currentTeam,n=e.currentRegionName,c=e.componentPermissions,u=c.isAccess,m=c.isStart,p=c.isVisitWebTerminal,h=c.isConstruct,v=c.isUpdate,y=c.isTelescopic,b=c.isEnv,_=c.isRely,E=c.isStorage,w=c.isPort,M=c.isPlugin,C=c.isSource,S=c.isDeploytype,O=c.isCharacteristic,k=c.isHealth,A=e.appPermissions,x=e.componentPermissions,D=e.groups,F=void 0===D?[]:D,T=e.form,P=e.deleteAppLoading,N=e.reStartLoading,I=e.startLoading,V=e.stopLoading,X=e.moveGroupLoading,K=e.editNameLoading,Q=e.updateRollingLoading,Y=e.deployLoading,J=e.buildInformationLoading,Z=this.state,$=Z.BuildList,ee=Z.componentTimer,te=Z.isShowThirdParty,be=Z.status,_e=Z.promptModal,Ce=Z.showDeleteApp,Se=Z.showEditName,Oe=Z.showMoveGroup,ke=Z.groupDetail,Ae=Z.tabsShow,xe=Z.routerSwitch,De=T.getFieldDecorator,Fe=te?B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.right.update"}):B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.right.update.roll"}),Te={start:(0,ye.formatMessage)({id:"componentOverview.header.right.start"}),restart:(0,ye.formatMessage)({id:"componentOverview.header.left.reset"}),stop:(0,ye.formatMessage)({id:"componentOverview.header.left.turnoff"}),deploy:(0,ye.formatMessage)({id:"componentOverview.header.right.build"}),rolling:Fe};if(xe)return null;t&&t.service&&t.service.service_cname&&window.sessionStorage.setItem("name",JSON.stringify(t.service.service_cname));var Pe=this.fetchParameter(),Ne=Pe.serviceAlias,Re=Pe.app_alias,Ie=Pe.group_id,Le=Pe.group_name,Ve=Pe.service_cname,Be=Pe.k8s_component_name,He=B.default.createElement(z.default,{timers:ee,btntype:"primary",app_alias:Re}),qe=be&&be.status&&B.default.createElement("div",null,m&&!W.default.canStop(be)&&B.default.createElement(d.default,{disabled:!W.default.canStart(be),onClick:()=>{this.handleOpenHelpfulHints("start")}},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.right.start"})),p&&!te&&B.default.createElement(d.default,null,B.default.createElement(L.Link,{to:"".concat(this.fetchPrefixUrl(),"components/").concat(Ne,"/webconsole"),target:"_blank"},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.right.web"}))),te?"":this.state.BuildState&&h?B.default.createElement(r.default,{title:B.default.createElement(ye.FormattedMessage,{id:"componentOverview.isShowThirdParty.New_version"})},B.default.createElement(d.default,{onClick:this.handleOpenBuild,loading:J},B.default.createElement(o.default,{className:se.default.badge,status:"success",text:"",count:B.default.createElement(ye.FormattedMessage,{id:"componentOverview.isShowThirdParty.updata"}),title:B.default.createElement(ye.FormattedMessage,{id:"componentOverview.isShowThirdParty.updata"})}),B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.right.build"}))):be&&"undeploy"===be.status&&h?B.default.createElement(d.default,{onClick:this.handleOpenBuild,loading:J},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.right.build"})):h&&B.default.createElement(d.default,{onClick:this.handleOpenBuild,loading:J},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.header.right.build"})),"undeploy"===be.status||"closed"===be.status||"stopping"===be.status||"succeeded"===be.status?"":v&&B.default.createElement(d.default,{onClick:()=>{this.handleOpenHelpfulHints("rolling")}},Fe),t&&t.service&&"market"===t.service.service_source&&W.default.canVisit(be)&&!te&&u&&He,t&&t.service&&"market"!==t.service.service_source&&W.default.canVisit(be)&&!te&&u&&He,te&&u&&He),Ue=[{key:"overview",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.overview"})},{key:"monitor",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.monitor"})},{key:"log",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.log"})}];y&&t&&t.service&&"job"!==t.service.extend_method&&"cronjob"!==t.service.extend_method&&Ue.push({key:"expansion",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.expansion"})}),b&&Ue.push({key:"environmentConfiguration",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.environmentConfiguration"})}),_&&Ue.push({key:"relation",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.relation"})}),E&&Ue.push({key:"mnt",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.mnt"})}),w&&Ue.push({key:"port",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.port"})}),M&&Ue.push({key:"plugin",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.plugin"})}),C&&Ue.push({key:"resource",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.resource"})}),(S||O||k)&&Ue.push({key:"setting",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.setting"})});var ze=te?[{key:"thirdPartyServices",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.overview"})},{key:"port",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.port"})},{key:"connectionInformation",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.connectionInformation"})},{key:"members",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.members"})}]:Ue,je=[{key:"overview",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.overview"})},{key:"port",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.port"})},{key:"connectionInformation",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.connectionInformation"})},{key:"members",tab:(0,ye.formatMessage)({id:"componentOverview.body.tab.bar.members"})}],Xe={thirdPartyServices:ge.default,connectionInformation:ae.default,members:re.default,overview:te?ge.default:ce.default,monitor:de.default,log:ie.default,expansion:ne.default,environmentConfiguration:le.default,relation:pe.default,mnt:oe.default,port:me.default,plugin:ue.default,resource:fe.default,setting:he.default},Ke=this.props.match.params.type;Ke||(Ke=te?"thirdPartyServices":"overview");var Qe=Xe[Ke],We={labelCol:{span:1},wrapperCol:{span:23}},Ge=[];return Ge=(0,G.createComponent)((0,G.createApp)((0,G.createTeam)((0,G.createEnterprise)(Ge,a),l,n),l,n,{appName:Le,appID:Ie}),l,n,{componentName:Ve,componentID:Ne}),B.default.createElement(ve.ResumeContext.Provider,{value:{loadBuildState:this.loadDetail}},B.default.createElement(j.default,{breadcrumbList:Ge,action:qe,title:this.renderTitle(Ve),onTabChange:this.handleTabChange,tabActiveKey:Ke,tabList:Ae?ze:je},this.state.showMarketAppDetail&&B.default.createElement(U.default,{onOk:this.hideMarketAppDetail,onCancel:this.hideMarketAppDetail,app:this.state.showApp}),_e&&B.default.createElement(f.default,{title:B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.tips"}),visible:_e,className:q.default.TelescopicModal,onOk:this.handleJumpAgain,onCancel:this.handleOffHelpfulHints,confirmLoading:"restart"===_e?N:"stop"===_e?V:"start"===_e?I:"deploy"===_e?Y:"rolling"===_e?Q:!_e},B.default.createElement("p",{style:{textAlign:"center"}},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.determine"}),Te[_e],B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.Current"}))),B.default.createElement(f.default,{title:[B.default.createElement("span",null,B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.Upgrade"}))],className:q.default.TelescopicModal,visible:this.state.visibleBuild,onOk:this.handleOkBuild,onCancel:this.handleCancelBuild,afterClose:()=>{this.setState({BuildList:[]})},footer:$&&$.length>0&&h?[B.default.createElement(d.default,{onClick:()=>{this.handleCancelBuild()}},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.cancel"})),B.default.createElement(d.default,{type:"primary",loading:Y,onClick:()=>{this.handleOkBuild()}},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.build"}))]:h&&[B.default.createElement(d.default,{onClick:()=>{this.handleCancelBuild()}},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.cancel"})),B.default.createElement(d.default,{type:"primary",loading:Y,onClick:()=>{this.handleOkBuild()}},B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.Force_build"}))]},B.default.createElement("div",null,$&&$.length>0&&v?B.default.createElement(R.default,{onSubmit:this.handleOkBuild},B.default.createElement(i.default,{message:[B.default.createElement("span",null," ",B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.app"})),B.default.createElement("a",{onClick:()=>{this.hideMarketOpenAppDetail()}},this.state.BuildText),B.default.createElement("span",null,B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.app_build"}))],type:"success",style:{marginBottom:"5px"}}),B.default.createElement(R.default.Item,(0,s.default)({},We,{label:""}),De("group_version",{initialValue:$[0],rules:[{required:!0,message:(0,ye.formatMessage)({id:"componentOverview.promptModal.choice"})}]})(B.default.createElement(Ee,null,$.map((e,t)=>{return B.default.createElement("div",null,B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.version"}),"\xa0",B.default.createElement(g.default,{key:t,value:e},B.default.createElement("a",null,e),B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.updata"})))}))))):B.default.createElement(i.default,{message:B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.cloud"}),type:"success",style:{marginBottom:"5px"}}))),Qe?B.default.createElement(Qe,(0,s.default)({groupDetail:ke,appPermissions:A,componentPermissions:x,timers:ee,status:be,ref:this.saveRef},this.props.match.params,this.props,{onshowDeployTips:e=>{this.handleshowDeployTips(e)},onshowRestartTips:e=>{this.handleshowRestartTips(e)},socket:this.socket,onChecked:this.handleChecked})):B.default.createElement(ye.FormattedMessage,{id:"componentOverview.promptModal.error"}),Ce&&B.default.createElement(H.default,{onOk:this.handleDeleteApp,onCancel:this.cancelDeleteApp,loading:P,title:B.default.createElement(ye.FormattedMessage,{id:"confirmModal.assembly.delete.title"}),desc:B.default.createElement(ye.FormattedMessage,{id:"confirmModal.assembly.delete.desc"}),subDesc:B.default.createElement(ye.FormattedMessage,{id:"confirmModal.assembly.delete.subDesc"})}),Se&&B.default.createElement(Me,{loading:K,name:Ve,onOk:this.handleEditName,onCancel:this.hideEditName,title:B.default.createElement(ye.FormattedMessage,{id:"componentOverview.EditName.title"}),k8sComponentName:Be,isEditEnglishName:be.status}),Oe&&B.default.createElement(we,{loading:X,currGroup:Ie,groups:F,onOk:this.handleMoveGroup,onCancel:this.hideMoveGroup})))}},x.childContextTypes={isActionIng:V.default.func,appRolback:V.default.func},A=D))||A)||A),Se=(F=R.default.create(),T=(0,I.connect)(e=>{var t=e.teamControl;return{currentTeamPermissionsInfo:t.currentTeamPermissionsInfo}},null,null,{pure:!1,withRef:!0}),F(P=T((N=class extends B.PureComponent{constructor(e){super(e),this.handlePermissions=(e=>{var t=this.props.currentTeamPermissionsInfo;return $.default.querySpecifiedPermissionsInfo(t,e)}),this.getAlias=(()=>{return this.props.match.params.appAlias}),this.flash=(()=>{this.setState({show:!1},()=>{this.setState({show:!0})})}),this.id="",this.state={show:!0,componentPermissions:this.handlePermissions("queryComponentInfo"),appPermissions:this.handlePermissions("queryAppInfo")}}componentWillMount(){var e=this.props.dispatch,t=this.state.componentPermissions.isAccess;t||J.default.withoutPermission(e)}componentDidMount(){}render(){return this.id!==this.getAlias()&&(this.id=this.getAlias(),this.flash()),this.state.show?B.default.createElement(Ce,(0,s.default)({},this.props,this.state)):null}},P=N))||P)||P);t.default=Se},"9/bS":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a("LLXN"),n=((0,l.formatMessage)({id:"utils.app-action-log-util.deploy"}),(0,l.formatMessage)({id:"utils.app-action-log-util.restart"}),(0,l.formatMessage)({id:"utils.app-action-log-util.delete"}),(0,l.formatMessage)({id:"utils.app-action-log-util.stop"}),(0,l.formatMessage)({id:"utils.app-action-log-util.HorizontalUpgrade"}),(0,l.formatMessage)({id:"utils.app-action-log-util.VerticalUpgrade"}),(0,l.formatMessage)({id:"utils.app-action-log-util.callback"}),(0,l.formatMessage)({id:"utils.app-action-log-util.create"}),(0,l.formatMessage)({id:"utils.app-action-log-util.own_money"}),(0,l.formatMessage)({id:"utils.app-action-log-util.expired"}),(0,l.formatMessage)({id:"utils.app-action-log-util.share-ys"}),(0,l.formatMessage)({id:"utils.app-action-log-util.share-yb"}),(0,l.formatMessage)({id:"utils.app-action-log-util.reboot"}),(0,l.formatMessage)({id:"utils.app-action-log-util.git-change"}),(0,l.formatMessage)({id:"utils.app-action-log-util.imageUpgrade"}),{isActioning(e){return!("complete"===e.final_status||"timeout"===e.final_status||!e.event_id)},getActionCN(e){return e.type_cn||""},getActionResultCN(e){var t,a={success:(0,l.formatMessage)({id:"utils.app-action-log-util.deploy"}),failure:(0,l.formatMessage)({id:"utils.app-action-log-util.failure"}),timeout:(0,l.formatMessage)({id:"utils.app-action-log-util.timeout"}),abnormal:(0,l.formatMessage)({id:"utils.app-action-log-util.abnormal"})},n={complate:(0,l.formatMessage)({id:"utils.app-action-log-util.complate"}),timeout:(0,l.formatMessage)({id:"utils.app-action-log-util.timeout"}),failure:(0,l.formatMessage)({id:"utils.app-action-log-util.failure"}),abnormal:(0,l.formatMessage)({id:"utils.app-action-log-util.abnormal"})};return t="complete"==e.final_status?a[e.status]:"timeout"==e.final_status?n[e.final_status]:"".concat((0,l.formatMessage)({id:"utils.app-action-log-util.ongoing"})),t},getActionUser(e){return e.user_name||""},isFail(e){return!(!this.isComplete(e)||"failure"!==e.status)},isTimeout(e){return!(!this.isComplete(e)||"timeout"!==e.status)},isSuccess(e){return!(!this.isComplete(e)||"success"!==e.status)},isComplete(e){return"complete"===e.final_status},getFailMessage(e){return e.message||""},getCommitUser(e){return e.code_version?e.code_version.user:""},getCodeVersion(e){return e.code_version?e.code_version.code_version:""},getCommitLog(e){return e.code_version?e.code_version.commit:""},isDeploy(e){return"deploy"===e.type},isShowCommitInfo(e){return this.isDeploy(e)&&e.code_version},canRollback(e){return!(this.isFail(e)||!this.isDeploy(e)||!e.code_version||!e.code_version.rollback)},getRollbackVersion(e){return e},getActionTime(e){return(e.start_time||"").split(" ")[1]},getActionDate(e){return(e.start_time||"").split(" ")[0]},getActionDateTime(e){return e.start_time||""}}),s=n;t.default=s},AFhn:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("g9YV");var i=l(a("wCAj"));a("14J3");var r=l(a("BMrR"));a("+L6B");var o=l(a("2/Rp"));a("jCWc");var d=l(a("kPKH"));a("fOrg");var c=l(a("+KLJ"));a("/xke");var u,m,p,f=l(a("TeRw")),h=l(a("p0pE")),g=l(a("QDog")),v=l(a("H6Z4")),y=l(a("q76B")),b=l(a("puxM")),_=l(a("hMqj")),E=a("MuoO"),w=a("LLXN"),M=n(a("q1tI")),C=(u=(0,E.connect)(e=>{var t=e.loading,a=e.teamControl,l=e.enterprise;return{deleteServiceMonitorLoading:t.effects["monitor/deleteServiceMonitor"],updateServiceMonitorLoading:t.effects["monitor/updateServiceMonitor"],addServiceMonitorLoading:t.effects["monitor/addServiceMonitor"],currentRegionName:a.currentRegionName,currentEnterprise:l.currentEnterprise,currentTeamPermissionsInfo:a.currentTeamPermissionsInfo}}),u((p=class extends M.PureComponent{constructor(e){super(e),this.onAddCustomMonitor=(()=>{this.setState({addCustomMonitor:!0})}),this.fetchServiceMonitor=(()=>{var e=this.props.dispatch,t=this.handleParameter();e({type:"monitor/fetchServiceMonitor",payload:t,callback:e=>{if(e&&200===e.status_code){var t=e.list;this.setState({loading:!1,monitors:t}),t&&0===t.length&&this.onAddCustomMonitor()}}})}),this.handlePermissions=(e=>{var t=this.props.currentTeamPermissionsInfo;return _.default.querySpecifiedPermissionsInfo(t,e)}),this.cancelAddCustomMonitor=(()=>{this.setState({addCustomMonitor:!1,editorData:{}})}),this.handleDelete=(e=>{this.setState({dleCustomMonitor:e})}),this.handleDeleteCustomMonitor=(()=>{var e=this.props.dispatch,t=this.state.dleCustomMonitor,a=this.handleParameter();e({type:"monitor/deleteServiceMonitor",payload:(0,h.default)({},a,{name:t}),callback:e=>{e&&(f.default.success({message:(0,w.formatMessage)({id:"notification.success.delete"})}),this.fetchServiceMonitor(),this.cancelDeleteCustomMonitor())}})}),this.cancelDeleteCustomMonitor=(()=>{this.setState({dleCustomMonitor:!1})}),this.handleEditor=(e=>{this.setState({editorData:e,addCustomMonitor:!0})}),this.handleAddCustomMonitor=(e=>{var t=this.props.dispatch,a=this.state.editorData,l=this.handleParameter();t({type:a.name?"monitor/updateServiceMonitor":"monitor/addServiceMonitor",payload:(0,h.default)({},l,e),callback:e=>{e&&(f.default.success({message:a.name?(0,w.formatMessage)({id:"notification.success.save"}):(0,w.formatMessage)({id:"notification.success.add"})}),this.fetchServiceMonitor(),this.cancelAddCustomMonitor())}})}),this.handleParameter=(()=>{var e=this.props.appDetail;return{team_name:g.default.getCurrTeamName(),app_alias:e.service.service_alias}}),this.state={monitors:[],addCustomMonitor:!1,loading:!0,editorData:{},dleCustomMonitor:!1,operationPermissions:this.handlePermissions("queryAppInfo")}}componentWillMount(){var e=this.props.dispatch,t=this.state.operationPermissions.isAccess;t||g.default.withoutPermission(e)}componentDidMount(){this.fetchServiceMonitor()}render(){var e=this.props,t=e.deleteServiceMonitorLoading,a=e.updateServiceMonitorLoading,l=e.addServiceMonitorLoading,n=e.onCancel,u=this.state,m=u.monitors,p=u.loading,f=u.editorData,h=u.addCustomMonitor,g=u.dleCustomMonitor,_=u.operationPermissions.isCreate;return M.default.createElement("div",null,M.default.createElement(r.default,null,M.default.createElement(d.default,{span:12},M.default.createElement(c.default,{message:M.default.createElement(w.FormattedMessage,{id:"componentOverview.body.tab.monitor.MonitoryPoint.standard"}),type:"info",showIcon:!0})),_&&M.default.createElement(o.default,{type:"primary",icon:"plus",style:{float:"right",marginBottom:"20px"},onClick:this.onAddCustomMonitor},M.default.createElement(w.FormattedMessage,{id:"componentOverview.body.tab.monitor.MonitoryPoint.add"})),M.default.createElement(o.default,{style:{float:"right",margin:"0 10px 20px 0"},onClick:n},M.default.createElement(w.FormattedMessage,{id:"componentOverview.body.tab.monitor.MonitoryPoint.back"}))),h&&M.default.createElement(v.default,{parameter:this.handleParameter(),data:f,loading:a||l,onCancel:this.cancelAddCustomMonitor,onOk:this.handleAddCustomMonitor}),M.default.createElement(s.default,{loading:p},g&&M.default.createElement(y.default,{ttitle:M.default.createElement(w.FormattedMessage,{id:"confirmModal.deldete.configure.title"}),desc:M.default.createElement(w.FormattedMessage,{id:"confirmModal.deldete.configure.desc"}),loading:t,onCancel:this.cancelDeleteCustomMonitor,onOk:this.handleDeleteCustomMonitor}),M.default.createElement(b.default,{sm:800},M.default.createElement(i.default,{pagination:!1,dataSource:m,columns:[{title:(0,w.formatMessage)({id:"componentOverview.body.tab.monitor.MonitoryPoint.name"}),dataIndex:"name"},{title:(0,w.formatMessage)({id:"componentOverview.body.tab.monitor.MonitoryPoint.collect"}),dataIndex:"service_show_name",align:"center"},{title:(0,w.formatMessage)({id:"componentOverview.body.tab.monitor.MonitoryPoint.path"}),dataIndex:"path",align:"center"},{title:(0,w.formatMessage)({id:"componentOverview.body.tab.monitor.MonitoryPoint.port"}),dataIndex:"port",align:"center"},{title:(0,w.formatMessage)({id:"componentOverview.body.tab.monitor.MonitoryPoint.time"}),dataIndex:"interval",align:"center"},{title:(0,w.formatMessage)({id:"componentOverview.body.tab.monitor.MonitoryPoint.handle"}),width:"200px",dataIndex:"backup_record_num",align:"center",render:(e,t)=>M.default.createElement(M.Fragment,null,M.default.createElement("a",{onClick:()=>this.handleDelete(t.name),style:{margintRight:10}},M.default.createElement(w.FormattedMessage,{id:"componentOverview.body.tab.monitor.MonitoryPoint.delete"})),M.default.createElement("a",{onClick:()=>{this.handleEditor(t)},style:{margintRight:10}},M.default.createElement(w.FormattedMessage,{id:"componentOverview.body.tab.monitor.MonitoryPoint.edit"})))}]}))))}},m=p))||m);t.default=C},AipW:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV")),i=l(a("jehZ"));a("OaEy");var r=l(a("2fM7"));a("y8nQ");var o,d,c,u,m=l(a("Vl3Y")),p=a("MuoO"),f=n(a("q1tI")),h=a("LLXN"),g=l(a("QDog")),v=l(a("ll25")),y=m.default.Item,b=(o=(0,p.connect)(e=>{var t=e.teamControl;return{teamControl:t}}),d=m.default.create(),o(c=d((u=class extends f.PureComponent{constructor(){super(...arguments),this.handleSubmit=(()=>{var e=this.props,t=e.onOk,a=e.form;a.validateFields((e,a)=>{!e&&t&&t(a)})}),this.loadMembers=(()=>{var e=this.props.dispatch;e({type:"teamControl/fetchMember",payload:{team_name:g.default.getCurrTeamName(),region_name:g.default.getCurrRegionName(),page_size:200}})})}componentDidMount(){this.loadMembers()}render(){var e=this.props,t=e.onCancel,a=e.actions,l=e.form,n=l.getFieldDecorator,o={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:14}}},d=a||[],c=this.props.members||[];return f.default.createElement(s.default,{title:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.SetMemberAppAction.member"}),visible:!0,width:800,onOk:this.handleSubmit,onCancel:t,maskClosable:!1},f.default.createElement(m.default,{onSubmit:this.handleSubmit},f.default.createElement(y,(0,i.default)({},o,{label:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.SetMemberAppAction.Select_member"}),hasFeedback:!0}),n("user_ids",{rules:[{required:!0,message:(0,h.formatMessage)({id:"componentOverview.body.SetMemberAppAction.team_memner"})}]})(f.default.createElement(r.default,{getPopupContainer:e=>e.parentNode,mode:"multiple"},c.map((e,t)=>{return f.default.createElement(r.default.Option,{key:t,value:e.user_id},e.user_name)})))),f.default.createElement(y,(0,i.default)({},o,{label:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.SetMemberAppAction.mode"})}),n("perm_ids",{initialValue:[],rules:[{required:!0,message:(0,h.formatMessage)({id:"componentOverview.body.SetMemberAppAction.palce_mode"})}]})(f.default.createElement(v.default,{showGroupName:!1,hides:["".concat((0,h.formatMessage)({id:"componentOverview.body.SetMemberAppAction.team"}))],datas:d})))))}},c=u))||c)||c),_=b;t.default=_},BBei:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV"));a("Pwec");var i=l(a("CtXQ"));a("/zsF");var r=l(a("PArb"));a("5NDa");var o=l(a("5rEg")),d=l(a("jehZ"));a("fOrg");var c=l(a("+KLJ"));a("OaEy");var u=l(a("2fM7"));a("y8nQ");var m,p,f,h=l(a("Vl3Y")),g=a("7DNP"),v=n(a("q1tI")),y=l(a("QDog")),b=a("LLXN"),_=l(a("8+Sn")),E=h.default.Item,w=u.default.Option,M=(m=h.default.create(),m((f=class extends v.PureComponent{constructor(e){super(e),this.handleSubmit=(e=>{e.preventDefault(),this.props.form.validateFields({force:!0},(e,t)=>{e||this.props.onOk&&this.props.onOk(t)})}),this.handleCancel=(()=>{this.props.onCancel&&this.props.onCancel()}),this.checkKey=((e,t,a)=>{var l=this.props.form.getFieldValue("protocol");"http"!=l?"http"!=l&&t?a():a(v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.callback"})):a()}),this.state={language:"zh-CN"===_.default.get("language")}}render(){var e=this.props.form,t=e.getFieldDecorator,a=e.getFieldValue,l=this.state.language,n={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}}},m={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:16}}},p=l?n:m,f=a("protocol")||"http",_=this.props,M=_.isAddLicense,C=_.certificates,S=_.addLicense;return v.default.createElement(s.default,{title:v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.title"}),onOk:this.handleSubmit,visible:!0,onCancel:this.handleCancel},v.default.createElement(c.default,{style:{textAlign:"center",marginBottom:16},message:v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.message"}),type:"warning"}),v.default.createElement(h.default,{onSubmit:this.handleSubmit},v.default.createElement(E,(0,d.default)({},p,{label:v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.title"})}),t("protocol",{initialValue:"http",rules:[{required:!0,message:(0,b.formatMessage)({id:"componentOverview.body.AddDomain.label_protocol.required"})}]})(v.default.createElement(u.default,{getPopupContainer:e=>e.parentNode},v.default.createElement(w,{value:"http"},"HTTP"),v.default.createElement(w,{value:"https"},"HTTPS"),v.default.createElement(w,{value:"httptohttps"},v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.httptohttps"})),v.default.createElement(w,{value:"httpandhttps"},v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.httpandhttps"}))))),v.default.createElement(E,(0,d.default)({},p,{label:v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.label_protocol.domain"})}),t("domain",{rules:[{required:!0,message:(0,b.formatMessage)({id:"componentOverview.body.AddDomain.label_protocol.requireds"})},{pattern:/^(?=^.{3,255}$)[a-zA-Z0-9*][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/,message:(0,b.formatMessage)({id:"componentOverview.body.AddDomain.label_protocol.pattern"})}]})(v.default.createElement(o.default,{placeholder:(0,b.formatMessage)({id:"componentOverview.body.AddDomain.label_protocol.placeholder"})}))),"http"==f?"":v.default.createElement(E,(0,d.default)({},p,{label:(0,b.formatMessage)({id:"componentOverview.body.AddDomain.lable_certificate_id"}),title:v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.lable_certificate_id"})}),t("certificate_id",{initialValue:"",rules:[{required:!0},{validator:this.checkKey}]})(v.default.createElement(u.default,{getPopupContainer:e=>e.parentNode,placeholder:(0,b.formatMessage)({id:"componentOverview.body.AddDomain.select.placeholder"}),dropdownRender:e=>v.default.createElement("div",null,e,M&&v.default.createElement("div",null,v.default.createElement(r.default,{style:{margin:"4px 0"}}),v.default.createElement("div",{style:{padding:"4px 8px",cursor:"pointer"},onMouseDown:e=>e.preventDefault(),onClick:()=>{S&&S()}},v.default.createElement(i.default,{type:"plus"}),v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.Load_more"}))))},v.default.createElement(w,{value:""},v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.select"})),C.map(e=>v.default.createElement(w,{key:e.id,value:e.id},e.alias)))),v.default.createElement("p",null,v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.no_available"}),v.default.createElement("a",{onClick:()=>{this.props.onCreateKey()},href:"javascript:;"},v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.new"})))),v.default.createElement("div",null,v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.setting"}),v.default.createElement(g.Link,{to:"/team/".concat(y.default.getCurrTeamName(),"/region/").concat(y.default.getCurrRegionName(),"/gateway/control/http/true"),style:{wordBreak:"break-all",wordWrap:"break-word",color:"#1890ff"}},v.default.createElement(b.FormattedMessage,{id:"componentOverview.body.AddDomain.into"})))))}},p=f))||p);t.default=M},Bg2k:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV")),i=l(a("jehZ"));a("5NDa");var r=l(a("5rEg"));a("7Kak");var o=l(a("9yH6"));a("OaEy");var d=l(a("2fM7"));a("y8nQ");var c,u,m,p=l(a("Vl3Y")),f=n(a("q1tI")),h=l(a("IhRX")),g=l(a("CQXj")),v=a("LLXN"),y=l(a("8+Sn")),b=p.default.Item,_=d.default.Option,E=o.default.Group,w=r.default.TextArea,M=(c=p.default.create(),c((m=class extends f.PureComponent{constructor(e){super(e),this.onChanges=(e=>{var t=e.target.value,a=this.props.form.setFieldsValue,l=this.handleUnhealthyTreatment(t),n={mode:t};l&&(n.success_threshold="1"),a(n),this.setState({isRestart:l})}),this.handleUnhealthyTreatment=(e=>{return"liveness"===e}),this.handleSubmit=(e=>{e.preventDefault();var t=this.props,a=t.form,l=t.onOk;a.validateFields({force:!0},(e,t)=>{!e&&l&&l(t)})}),this.checkPath=((e,t,a)=>{var l=this.props.form.getFieldValue("scheme");"tcp"!==l&&"cmd"!==l&&("tcp"===l&&"cmd"===l||!t)?a("".concat((0,v.formatMessage)({id:"componentOverview.body.EditHealthCheck.input_path"}))):a()}),this.checkNums=((e,t,a)=>{t&&t<1?a("".concat((0,v.formatMessage)({id:"componentOverview.body.EditHealthCheck.min"}))):a()}),this.handleHeavyList=(e=>{var t=[];return e.map(e=>{t.push(e.container_port)}),t}),this.handleList=(e=>{if(null!=e||""!==e){var t=this.state.list?this.state.list:[];if(e&&t.unshift("".concat(e)),!(t&&t.length>0&&"null"===t[0]||""===t[0])){for(var a=[t[0]],l=1;l<t.length;l++){for(var n=!1,s=0;s<a.length;s++)if(t[l]==a[s]){n=!0;break}n||a.push(t[l])}this.setState({list:a}),this.props.form.setFieldsValue({port:e})}}});var t=this.props,a=t.ports,l=t.data,n=a?this.handleHeavyList(a):[];this.state={isRestart:this.handleUnhealthyTreatment(l&&l.mode),list:n,prolist:n,showHTTP:"http"===l.scheme,language:"zh-CN"===y.default.get("language"),showCmd:"cmd"===l.scheme}}render(){var e=this.props,t=e.title,a=e.onCancel,l=e.form,n=e.types,c=e.loading,u=void 0!==c&&c,m=this.props.data||{},y={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},M={labelCol:{xs:{span:24},sm:{span:9}},wrapperCol:{xs:{span:24},sm:{span:15}}},C=l.getFieldDecorator,S=l.getFieldValue,O=this.state,k=O.list,A=O.prolist,x=O.isRestart,D=O.showHTTP,F=O.language,T=O.showCmd,P=F?y:M,N=(S("scheme"),f.default.createElement("span",{style:{marginLeft:8}},f.default.createElement(v.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.second"}))),R=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return f.default.createElement(r.default,{disabled:e,type:"number",min:1,style:{width:"80%"}})},I=[{validator:this.checkNums}];return f.default.createElement(s.default,{width:700,title:t,onOk:this.handleSubmit,maskClosable:!1,onCancel:a,visible:!0,confirmLoading:u},f.default.createElement(p.default,{onSubmit:this.handleSubmit},f.default.createElement(b,(0,i.default)({},P,{label:f.default.createElement(v.FormattedMessage,{id:"componentOverview.body.EditHealthCheck.port"})}),C("port",{initialValue:g.default.getPort(m)||(k&&k.length?k[0]:""),rules:[{required:!0,message:(0,v.formatMessage)({id:"componentOverview.body.EditHealthCheck.input"})}]})(f.default.createElement(d.default,{getPopupContainer:e=>e.parentNode,showSearch:!(A&&A.length>0),onSearch:e=>{this.handleList(e)}},k&&k.map(e=>f.default.createElement(_,{key:e,value:e},e))))),f.default.createElement(b,(0,i.default)({},P,{label:f.default.createElement(v.FormattedMessage,{id:"componentOverview.body.EditHealthCheck.agreement"})}),C("scheme",{initialValue:m.scheme||"tcp"})(f.default.createElement(E,{onChange:e=>{this.setState({showHTTP:"http"===e.target.value,showCmd:"cmd"===e.target.value})},options:[{label:"tcp",value:"tcp"},{label:"http",value:"http"},{label:"cmd",value:"cmd"}]}))),f.default.createElement(b,(0,i.default)({},P,{label:f.default.createElement(v.FormattedMessage,{id:"componentOverview.body.EditHealthCheck.unhealth"})}),C("mode",{initialValue:m.mode||"readiness",rules:[{required:!0,message:(0,v.formatMessage)({id:"componentOverview.body.EditHealthCheck.select"})}]})(f.default.createElement(E,{onChange:this.onChanges},f.default.createElement(o.default,{value:"readiness"},f.default.createElement(v.FormattedMessage,{id:"componentOverview.body.EditHealthCheck.Offline"})),!n&&f.default.createElement(o.default,{value:"liveness"},f.default.createElement(v.FormattedMessage,{id:"componentOverview.body.EditHealthCheck.restart"}))))),T&&f.default.createElement(b,(0,i.default)({},P,{label:(0,v.formatMessage)({id:"teamAdd.create.image.docker_cmd"})}),C("cmd",{initialValue:m.cmd||""})(f.default.createElement(w,null))),f.default.createElement(b,(0,i.default)({style:{display:D?"":"none"}},P,{label:f.default.createElement(v.FormattedMessage,{id:"componentOverview.body.EditHealthCheck.http"})}),C("http_header",{initialValue:m.http_header||""})(f.default.createElement(h.default,null))),f.default.createElement(b,(0,i.default)({style:{display:D?"":"none"}},P,{label:f.default.createElement(v.FormattedMessage,{id:"componentOverview.body.EditHealthCheck.path"})}),C("path",{initialValue:m.path||"",rules:[{validator:this.checkPath}]})(f.default.createElement(r.default,{placeholder:(0,v.formatMessage)({id:"componentOverview.body.EditHealthCheck.Response"})}))),f.default.createElement(b,(0,i.default)({},P,{label:f.default.createElement(v.FormattedMessage,{id:"componentOverview.body.EditHealthCheck.initialization"})}),C("initial_delay_second",{initialValue:m.initial_delay_second||"2",rules:[{required:!0,message:(0,v.formatMessage)({id:"componentOverview.body.EditHealthCheck.input_initialization"})},...I]})(R()),N),f.default.createElement(b,(0,i.default)({},P,{label:f.default.createElement(v.FormattedMessage,{id:"componentOverview.body.EditHealthCheck.time"})}),C("period_second",{initialValue:m.period_second||"3",rules:[{required:!0,message:(0,v.formatMessage)({id:"componentOverview.body.EditHealthCheck.input_time"})},...I]})(R()),N),f.default.createElement(b,(0,i.default)({},P,{label:f.default.createElement(v.FormattedMessage,{id:"componentOverview.body.EditHealthCheck.over_time"})}),C("timeout_second",{initialValue:m.timeout_second||"20",rules:[{required:!0,message:(0,v.formatMessage)({id:"componentOverview.body.EditHealthCheck.input_over_time"})},...I]})(R()),N),f.default.createElement(b,(0,i.default)({},P,{label:f.default.createElement(v.FormattedMessage,{id:"componentOverview.body.EditHealthCheck.success"})}),C("success_threshold",{initialValue:x?"1":m.success_threshold||"1",rules:[{required:!0,message:(0,v.formatMessage)({id:"componentOverview.body.EditHealthCheck.success_frequency"})},...I]})(R(x)))))}},u=m))||u);t.default=M},CQXj:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l={getInitWaitTime(e){return e.initial_delay_second},getIntervalTime(e){return e.period_second},getTimeoutTime(e){return e.timeout_second},getSuccessTimes(e){return e.success_threshold},getFailTimes(e){return e.failure_threshold},getPort(e){return e.port},getProtocol(e){return e.scheme},getHeaders(e){return e.http_header},getPath(e){return e.path},getcnName(e){return"readiness"===e.mode?"\u542f\u52a8\u65f6\u68c0\u6d4b":"liveness"===e.mode?"\u8fd0\u884c\u65f6\u68c0\u6d4b":""},isStartProbeUsed(e){return"readiness"===e.mode||"liveness"===e.mode},isStartProbeStart(e){return!0===e.is_used},isRunningProbeUsed(e){return"liveness"===e.mode},isRunningProbeStart(e){return!0===e.is_used},isUsed(e){return e.is_used}},n=l;t.default=n},DXno:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("g9YV");var i=l(a("wCAj"));a("14J3");var r=l(a("BMrR"));a("jCWc");var o=l(a("kPKH"));a("5Dmo");var d=l(a("3S7+"));a("Pwec");var c=l(a("CtXQ"));a("+L6B");var u,m,p,f=l(a("2/Rp")),h=a("KTCi"),g=l(a("puxM")),v=l(a("QDog")),y=l(a("YM/Z")),b=l(a("rIpq")),_=l(a("zcww")),E=l(a("+iC2")),w=a("MuoO"),M=l(a("ZhIB")),C=n(a("q1tI")),S=a("LLXN"),O=(f.default.Group,u=(0,w.connect)(e=>{var t=e.user,a=e.appControl;return{currUser:t.currentUser,appDetail:a.appDetail,onlineNumber:a.onlineNumber,onlineNumberRange:a.onlineNumberRange,appRequest:a.appRequest,appRequestRange:a.appRequestRange,requestTime:a.requestTime,requestTimeRange:a.requestTimeRange}}),u((p=class extends C.PureComponent{constructor(e){super(e),this.getSocketUrl=(()=>{var e=E.default.getTeamByTeamName(this.props.currUser,v.default.getCurrTeamName()),t=v.default.getCurrRegionName();if(e){var a=_.default.getRegionByName(e,t);if(a)return b.default.getMonitorWebSocketUrl(a)}return""}),this.inerval=5e3,this.state={logs:[]}}componentDidMount(){this.mounted=!0,this.fetchRequestTime(),this.fetchRequestTimeRange(),this.fetchRequest(),this.fetchRequestRange(),this.fetchOnlineNumber(),this.fetchOnlineNumberRange(),this.createSocket()}componentWillUnmount(){this.mounted=!1,this.props.dispatch({type:"appControl/clearOnlineNumberRange"}),this.props.dispatch({type:"appControl/clearRequestTime"}),this.props.dispatch({type:"appControl/clearRequestTimeRange"}),this.props.dispatch({type:"appControl/clearRequest"}),this.props.dispatch({type:"appControl/clearRequestRange"}),this.props.dispatch({type:"appControl/clearOnlineNumber"});var e=this.props.socket;e&&e.closeMonitorMessage()}getStartTime(){return(new Date).getTime()/1e3-3600}getStep(){return 60}fetchRequestTime(){this.mounted&&this.props.dispatch({type:"appControl/fetchRequestTime",payload:{team_name:v.default.getCurrTeamName(),app_alias:this.props.appAlias,serviceId:this.props.appDetail.service.service_id},complete:()=>{this.mounted&&setTimeout(()=>{this.fetchRequestTime()},this.inerval)}})}fetchRequestTimeRange(){this.mounted&&this.props.dispatch({type:"appControl/fetchRequestTimeRange",payload:{team_name:v.default.getCurrTeamName(),app_alias:this.props.appAlias,start:this.getStartTime(),serviceId:this.props.appDetail.service.service_id,step:this.getStep()},complete:()=>{this.mounted&&setTimeout(()=>{this.fetchRequestTimeRange()},this.inerval)}})}fetchRequest(){this.mounted&&this.props.dispatch({type:"appControl/fetchRequest",payload:{team_name:v.default.getCurrTeamName(),app_alias:this.props.appAlias,serviceId:this.props.appDetail.service.service_id},complete:()=>{this.mounted&&setTimeout(()=>{this.fetchRequest()},this.inerval)}})}fetchRequestRange(){this.mounted&&this.props.dispatch({type:"appControl/fetchRequestRange",payload:{team_name:v.default.getCurrTeamName(),app_alias:this.props.appAlias,start:this.getStartTime(),serviceId:this.props.appDetail.service.service_id,step:this.getStep()},complete:()=>{this.mounted&&setTimeout(()=>{this.fetchRequestRange()},this.inerval)}})}fetchOnlineNumber(){this.mounted&&this.props.dispatch({type:"appControl/fetchOnlineNumber",payload:{team_name:v.default.getCurrTeamName(),app_alias:this.props.appAlias,serviceId:this.props.appDetail.service.service_id},complete:()=>{this.mounted&&setTimeout(()=>{this.fetchOnlineNumber()},this.inerval)}})}fetchOnlineNumberRange(){this.mounted&&this.props.dispatch({type:"appControl/fetchOnlineNumberRange",payload:{team_name:v.default.getCurrTeamName(),app_alias:this.props.appAlias,start:this.getStartTime(),serviceId:this.props.appDetail.service.service_id,step:this.getStep()},complete:()=>{this.mounted&&setTimeout(()=>{this.fetchOnlineNumberRange()},this.inerval)}})}createSocket(){var e=this.props.socket;e&&e.setOnMonitorMessage(e=>{this.updateTable(e)})}updateTable(e){try{e=JSON.parse(e)}catch(e){}this.setState({logs:e})}render(){var e={xs:24,sm:12,md:12,lg:12,xl:8,style:{marginBottom:24}};return C.default.createElement(C.Fragment,null,C.default.createElement(r.default,{gutter:24},C.default.createElement(o.default,e,C.default.createElement(h.ChartCard,{title:C.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.now.time"}),action:C.default.createElement(d.default,{title:C.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.now.averageTime"})}," ",C.default.createElement(c.default,{type:"info-circle-o"})," "),total:(0,M.default)(y.default.queryTog2(this.props.requestTime)).format("0,0"),footer:C.default.createElement(h.Field,{label:"",value:""}),contentHeight:46},C.default.createElement(h.MiniArea,{color:"#975FE4",data:y.default.queryRangeTog2(this.props.requestTimeRange)}))),C.default.createElement(o.default,e,C.default.createElement(h.ChartCard,{title:C.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.now.throughput"}),action:C.default.createElement(d.default,{title:C.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.now.NumberOfRequests"})}," ",C.default.createElement(c.default,{type:"info-circle-o"})," "),total:(0,M.default)(y.default.queryTog2(this.props.appRequest)).format("0,0"),footer:C.default.createElement(h.Field,{label:"",value:""}),contentHeight:46},C.default.createElement(h.MiniArea,{color:"#4593fc",data:y.default.queryRangeTog2(this.props.appRequestRange)}))),C.default.createElement(o.default,e,C.default.createElement(h.ChartCard,{title:C.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.now.onlineNumber"}),action:C.default.createElement(d.default,{title:C.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.now.independent"})}," ",C.default.createElement(c.default,{type:"info-circle-o"})," "),total:(0,M.default)(y.default.queryTog2(this.props.onlineNumber)).format("0,0"),footer:C.default.createElement(h.Field,{label:"",value:""}),contentHeight:46},C.default.createElement(h.MiniBar,{data:y.default.queryRangeTog2(this.props.onlineNumberRange)})))),C.default.createElement(s.default,{title:C.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.now.ranking"})},C.default.createElement(g.default,{sm:700},C.default.createElement(i.default,{columns:[{title:"Url",dataIndex:"Key"},{title:(0,S.formatMessage)({id:"componentOverview.body.tab.monitor.now.cumulativeTime"}),dataIndex:"CumulativeTime",width:150},{title:(0,S.formatMessage)({id:"componentOverview.body.tab.monitor.now.AverageTime"}),dataIndex:"AverageTime",width:150},{title:(0,S.formatMessage)({id:"componentOverview.body.tab.monitor.now.requests"}),dataIndex:"Count",width:100},{title:(0,S.formatMessage)({id:"componentOverview.body.tab.monitor.now.abnormalTimes"}),dataIndex:"AbnormalCount",width:100}],pagination:!1,dataSource:this.state.logs}))))}},m=p))||m);t.default=O},GUlx:function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=n(a("kLXV")),i=n(a("jehZ"));a("+L6B");var r=n(a("2/Rp"));a("y8nQ");var o=n(a("Vl3Y")),d=l(a("q1tI")),c=n(a("CQXj")),u=o.default.Item;class m extends d.PureComponent{render(){var e=this.props,t=e.title,a=e.onCancel,l=this.props.data||{},n={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}};return d.default.createElement(s.default,{title:t,visible:!0,onCancel:a,footer:[d.default.createElement(r.default,{onClick:a}," ",d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.close"})," ")]},d.default.createElement(o.default,null,d.default.createElement(u,(0,i.default)({},n,{label:d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.Monitoring_port"})}),d.default.createElement("span",null,l.port)),d.default.createElement(u,(0,i.default)({},n,{label:d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.agreement"})}),d.default.createElement("span",null,l.scheme)),d.default.createElement(u,(0,i.default)({},n,{label:d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.unhealth"})}),d.default.createElement("span",null,"readiness"==l.mode?d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.OfflineOffline"}):"liveness"==l.mode?d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.restart"}):d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.setting"}))),"http"===l.scheme?d.default.createElement(d.Fragment,null,d.default.createElement(u,(0,i.default)({},n,{label:d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.http"})}),d.default.createElement("span",null,c.default.getHeaders(l))),d.default.createElement(u,(0,i.default)({},n,{label:d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.path"})}),d.default.createElement("span",null,c.default.getPath(l)))):null,d.default.createElement(u,(0,i.default)({},n,{label:d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.initialization"})}),d.default.createElement("span",null,c.default.getInitWaitTime(l),d.default.createElement("span",{style:{marginLeft:8}},d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.second"})))),d.default.createElement(u,(0,i.default)({},n,{label:d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.testing_time"})}),d.default.createElement("span",null,c.default.getIntervalTime(l),d.default.createElement("span",{style:{marginLeft:8}},d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.second"})))),d.default.createElement(u,(0,i.default)({},n,{label:d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.overtime"})}),d.default.createElement("span",null,c.default.getTimeoutTime(l),d.default.createElement("span",{style:{marginLeft:8}},d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.second"})))),d.default.createElement(u,(0,i.default)({},n,{label:d.default.createElement(FormattedMessage,{id:"componentOverview.body.ViewHealthCheck.success"})}),d.default.createElement("span",null,c.default.getSuccessTimes(l)))))}}t.default=m},H6Z4:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a("jehZ"));a("5NDa");var i=l(a("5rEg"));a("/xke");var r=l(a("TeRw")),o=l(a("p0pE"));a("2qtc");var d=l(a("kLXV"));a("OaEy");var c=l(a("2fM7"));a("y8nQ");var u,m,p,f,h=l(a("Vl3Y")),g=a("MuoO"),v=n(a("q1tI")),y=a("LLXN"),b=l(a("8+Sn")),_=l(a("e6Ls")),E=h.default.Item,w=c.default.Option,M=d.default.confirm,C=(u=h.default.create(),m=(0,g.connect)(),u(p=m((f=class extends v.PureComponent{constructor(e){super(e),this.onOk=(e=>{e.preventDefault();var t=this.props,a=t.form,l=t.onOk,n=this.state,s=n.unit,i=n.portList;n.language;a.validateFields({force:!0},(e,t)=>{if(!e&&l){t.interval+="".concat(s),t.port=Number(t.port);var a=i.filter(e=>{return"".concat(t.port)==="".concat(e.container_port)})[0];a.is_outer_service||a.is_inner_service?l(t):this.handleOpenInner(t)}})}),this.handleOpenInner=(e=>{var t=this.props,a=t.dispatch,l=t.parameter,n=t.onOk;M({title:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.port"}),content:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.Internally"}),okText:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.Open"}),cancelText:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.cancel"}),onOk(){return new Promise((t,s)=>{a({type:"appControl/openPortInner",payload:(0,o.default)({},l,{port:e.port}),callback:()=>{n(e),r.default.success({message:(0,y.formatMessage)({id:"notification.success.opened_successfully"})}),d.default.destroyAll()}}),setTimeout(Math.random()>.5?t:s,2e3)})},onCancel(){}})}),this.handleChange=(e=>{this.setState({unit:e})}),this.handlePorts=(()=>{var e=this.props,t=e.dispatch,a=e.parameter;t({type:"appControl/fetchPorts",payload:a,callback:e=>{e&&this.setState({portList:e.list})}})}),this.checkContent=((e,t,a)=>{var l=Number(t);if(l||0===l){if(l<1)return void a("".concat((0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.min"})));if(l>65535)return void a("".concat((0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.max"})))}a()});var t=this.props.data;this.state={portList:[],unit:t.interval?t.interval.slice(t.interval.length-1):"s",language:"zh-CN"===b.default.get("language")}}componentDidMount(){this.handlePorts()}render(){var e=this.props,t=e.title,a=e.onCancel,l=e.form,n=e.data,r=void 0===n?{}:n,o=e.loading,u=void 0!==o&&o,m=this.state,p=m.unit,f=m.portList,g=m.language,b=l.getFieldDecorator,M={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}},C={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},S=g?M:C,O=v.default.createElement(c.default,{getPopupContainer:e=>e.parentNode,defaultValue:p,style:{width:80},onChange:this.handleChange},v.default.createElement(w,{value:"s"},(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.second"})),v.default.createElement(w,{value:"m"},(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.minute"})),v.default.createElement(w,{value:"h"},(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.hour"}))),k="";r.interval&&(k=r.interval.slice(0,r.interval.length-1));var A={pattern:/^[a-zA-Z]+$/,message:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.Only"})},x={max:40,message:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.Maximum"})};return v.default.createElement(d.default,{title:t||r.name?(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.edit"}):(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.add"}),visible:!0,confirmLoading:u,className:_.default.TelescopicModal,onCancel:a,onOk:this.onOk,okText:r.name?(0,y.formatMessage)({id:"button.save"}):(0,y.formatMessage)({id:"button.add"})},v.default.createElement(h.default,{onSubmit:this.onOk},v.default.createElement(E,(0,s.default)({},S,{label:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.name"})}),b("name",{initialValue:r.name||"",rules:[{required:!0,message:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.input_name"})},A,x]})(v.default.createElement(i.default,{disabled:r.name,placeholder:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.input_name"})}))),v.default.createElement(E,(0,s.default)({},S,{label:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.collect"})}),b("service_show_name",{initialValue:r.service_show_name||"",rules:[{required:!0,message:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.collect_name"})},A,x]})(v.default.createElement(i.default,{placeholder:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.collect_name"})}))),v.default.createElement(E,(0,s.default)({},S,{label:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.collect_time"})}),b("interval",{initialValue:k||"10",rules:[{required:!0,message:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.collect_time"})},{validator:this.checkContent}]})(v.default.createElement(i.default,{type:"number",min:1,max:65535,addonAfter:O,defaultValue:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.collect_time"})}))),v.default.createElement(E,(0,s.default)({},S,{label:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.path"})}),b("path",{initialValue:r.path||"/metrics",rules:[{required:!0,message:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.input_path"})},{max:255,message:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.Maximum_length"})}]})(v.default.createElement(i.default,{placeholder:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.input_path"})}))),v.default.createElement(E,(0,s.default)({},S,{label:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.port_num"})}),b("port",{initialValue:r.port||(f.length>0?f[0].container_port:""),rules:[{required:!0,message:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.input_port"})}]})(v.default.createElement(c.default,{placeholder:(0,y.formatMessage)({id:"componentOverview.body.tab.AddCustomMonitor.input_port"}),getPopupContainer:e=>e.parentNode},f.map(e=>{var t=e.container_port,a=e.ID;return v.default.createElement(w,{value:t,key:a},t)}))))))}},p=f))||p)||p);t.default=C},"I/an":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l={getMemoryAndUnit(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(void 0===e)return"";if(e<1024)return"".concat(e,"M");var a=e/1024;return"".concat(a%1===0?a:a.toFixed(t,2),"G")},getDiskAndUnit(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return void 0===e?"":e<1024?"".concat(e.toFixed(t),"G"):"".concat((e/1024).toFixed(t),"T")},getNetAndUnit(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return void 0===e?"":"".concat(e.toFixed(t),"G")},getMonthlyAndUnit(e){return void 0===e?"":e<12?"".concat(e,"\u4e2a\u6708"):"".concat(e/12,"\u5e74")}},n=l;t.default=n},IhRX:function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var s=n(a("BMrR"));a("+L6B");var i=n(a("2/Rp"));a("jCWc");var r=n(a("kPKH"));a("5NDa");var o=n(a("5rEg")),d=l(a("q1tI")),c=a("LLXN");class u extends d.Component{constructor(e){super(e),this.add=(()=>{var e=this.state.values;this.setState({values:e.concat({key:"",value:""})})}),this.remove=(e=>{var t=this.state.values;t.splice(e,1),this.setValues(t),this.triggerChange(t)}),this.onKeyChange=((e,t)=>{var a=this.state.values;a[e].key=t.target.value,this.triggerChange(a),this.setValues(a)}),this.onValueChange=((e,t)=>{var a=this.state.values;a[e].value=t.target.value,this.triggerChange(a),this.setValues(a)}),this.state={values:[{key:"",value:""}]},this.initFromProps()}componentWillReceiveProps(e){if("value"in e){var t=e.value;this.initFromProps(t)}}initFromProps(e){e=e||this.props.value;if(e){for(var t=[],a=e.split(","),l=0;l<a.length;l++)""!==a[l].split("=")[0]&&t.push({key:a[l].split("=")[0],value:a[l].split("=")[1]});this.setValues(t)}}setValues(e){e=e||[],e.length||e.push({key:"",value:""}),this.setState({values:e})}triggerChange(e){for(var t=[],a=0;a<e.length;a++)""!==e[a].key&&t.push("".concat(e[a].key,"=").concat(e[a].value));var l=this.props.onChange;l&&l(t.join(","))}render(){var e=this.props.keyPlaceholder||(0,c.formatMessage)({id:"placeholder.contiguration.msg.key"}),t=this.props.valuePlaceholder||(0,c.formatMessage)({id:"placeholder.contiguration.msg.value"}),a=this.state.values;return d.default.createElement("div",null,a.map((a,l)=>{return d.default.createElement(s.default,{key:l},d.default.createElement(r.default,{span:8},d.default.createElement(o.default,{name:"key",onChange:this.onKeyChange.bind(this,l),value:a.key,placeholder:e})),d.default.createElement(r.default,{span:2,style:{textAlign:"center"}},"="),d.default.createElement(r.default,{span:8},d.default.createElement(o.default,{name:"value",onChange:this.onValueChange.bind(this,l),value:a.value,placeholder:t})),d.default.createElement(r.default,{span:6,style:{textAlign:"center"}},0==l?d.default.createElement(i.default,{onClick:this.add,type:"primary"},"\u6dfb\u52a0"):d.default.createElement(i.default,{onClick:this.remove.bind(this,l)},"\u5220\u9664")))}))}}var m=u;t.default=m},Lo2C:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("5NDa");var s=l(a("5rEg"));a("/zsF");var i=l(a("PArb"));a("DZo9");var r=l(a("8z0m"));a("2qtc");var o=l(a("kLXV"));a("Pwec");var d=l(a("CtXQ"));a("T2oS");var c=l(a("W9HT"));a("IzEo");var u=l(a("bx4M"));a("+L6B");var m=l(a("2/Rp")),p=l(a("jehZ")),f=l(a("p0pE"));a("/xke");var h=l(a("TeRw"));a("OaEy");var g=l(a("2fM7"));a("y8nQ");var v=l(a("Vl3Y"));a("Znn+");var y,b,_,E,w,M=l(a("ZTPi")),C=a("MuoO"),S=a("7DNP"),O=n(a("q1tI")),k=a("LLXN"),A=l(a("m+FX")),x=l(a("iPMB")),D=l(a("cUW5")),F=l(a("lpA0")),T=l(a("QDog")),P=l(a("mWxT")),N=a("+n12"),R=l(a("Oz9w")),I=l(a("ot6+")),L=l(a("0//z")),V=l(a("laTA")),B=(l(a("RdSn")),l(a("4ahh")),a("WDw0")),H=M.default.TabPane,q=v.default.Item,U=g.default.Option,z=g.default.OptGroup,j=(y=(0,C.connect)(e=>{var t=e.user,a=e.appControl,l=e.global;return{currUser:t.currentUser,createWay:a.createWay,rainbondInfo:l.rainbondInfo,enterprise:l.enterprise}},null,null,{withRef:!0}),b=v.default.create(),y(_=b((w=E=class extends O.PureComponent{constructor(e){var t;super(e),t=this,this.bindEvent=(()=>{document.addEventListener("click",this.handleClick,!1)}),this.unbindEvent=(()=>{document.removeEventListener("click",this.handleClick)}),this.handleClick=(e=>{var t=e.target;this.props&&this.props.appDetail&&this.props.appDetail.service;while(t){if(t===document.body)return;var a=t.getAttribute("action_type");if("modify_url"===a||"modify_repo"===a)return void this.setState({modifyUrl:a});if("modify_userpass"===a)return void this.setState({modifyUserpass:!0});t=t.parentNode}}),this.time=(()=>{setTimeout(()=>{this.props.appDetail&&this.props.appDetail.service&&this.props.appDetail.service.service_alias&&(this.setOauthService(),this.getRuntimeInfo(),this.loadBuildSourceInfo(),this.bindEvent())},2e3)}),this.handleUploadCancel=(()=>{this.setState({uploadFile:!1})}),this.handleUploadOk=(e=>{var t=this.props,a=t.dispatch,l=t.appDetail,n=this.state,s=n.existFileList,i=n.event_id,r=T.default.getCurrTeamName(),o=T.default.getCurrRegionName(),d=l&&l.service&&l.service.service_id;s.length>0?a({type:"createApp/createJarWarSubmit",payload:{team_name:r,event_id:i,service_id:d,region_name:o},callback:e=>{this.setState({uploadFile:!1}),this.loadBuildSourceInfo()}}):(this.loop=!0,this.handleJarWarUploadStatus(),h.default.error({message:(0,k.formatMessage)({id:"notification.error.notDetected"})}))}),this.handleJarWarUpload=(()=>{var e=T.default.getCurrTeamName(),t=T.default.getCurrRegionName(),a=this.props,l=a.dispatch,n=a.appDetail,s=n.service.service_id;l({type:"createApp/createJarWarServices",payload:{region:t,team_name:e,component_id:s},callback:e=>{e&&200===e.status_code&&this.setState({record:e.bean,event_id:e.bean.event_id},()=>{""!==e.bean.region&&(this.loop=!0,this.handleJarWarUploadStatus())})}})}),this.handleJarWarUploadRecord=(()=>{var e=this.props,t=e.dispatch,a=e.appDetail,l=a.service.service_id;t({type:"createApp/createJarWarUploadRecord",payload:{region:T.default.getCurrRegionName(),team_name:T.default.getCurrTeamName(),component_id:l,file_type:"jwar"},callback:e=>{e.bean&&e.bean.source_dir&&e.bean.source_dir.length>0?this.setState({existFileList:e.bean.source_dir,event_id:e.bean.event_id}):this.handleJarWarUpload()},handleError:()=>{}})}),this.handleJarWarUploadStatus=(()=>{var e=this.props.dispatch,t=this.state.event_id;e({type:"createApp/createJarWarUploadStatus",payload:{region:T.default.getCurrRegionName(),team_name:T.default.getCurrTeamName(),event_id:t},callback:e=>{e&&e.bean.package_name&&e.bean.package_name.length>0&&this.setState({existFileList:e.bean.package_name}),this.loop&&setTimeout(()=>{this.handleJarWarUploadStatus()},3e3)},handleError:()=>{}})}),this.handleJarWarUploadDelete=(()=>{var e=this.state.event_id,t=this.props.dispatch;t({type:"createApp/deleteJarWarUploadStatus",payload:{team_name:T.default.getCurrTeamName(),event_id:e},callback:e=>{"ok"==e.bean.res&&(this.setState({existFileList:[]}),h.default.success({message:(0,k.formatMessage)({id:"notification.success.delete_file"})}),this.handleJarWarUpload())}})}),this.onChangeUpload=(e=>{var t=e.fileList;t=t.filter(e=>{return!e.response||"success"===e.response.msg}),e&&e.event&&e.event.percent&&this.setState({percents:e.event.percent});var a=e.file.status;"done"===a&&this.setState({percents:!1}),this.setState({fileList:t})}),this.onRemove=(()=>{this.setState({fileList:[]})}),this.setOauthService=(()=>{var e=this.props,t=e.rainbondInfo,a=e.enterprise,l=[];P.default.OauthbEnable(t)&&P.default.OauthEnterpriseEnable(a)&&(a.oauth_services.value.map(e=>{var t=e.oauth_type,a=e.service_id,n=e.is_git,s=e.name,i=e.enable;return n&&l.push({name:s,type:t,enable:i,id:"".concat(a)}),e}),this.setState({tabList:l}))}),this.onChangeBuildSource=(()=>{this.hideBuildSource(),this.loadBuildSourceInfo();var e=this.context.loadBuildState;e(!0)}),this.getRuntimeInfo=(()=>{this.props.dispatch({type:"appControl/getRuntimeBuildInfo",payload:{team_name:T.default.getCurrTeamName(),app_alias:this.props.appDetail&&this.props.appDetail.service&&this.props.appDetail.service.service_alias},callback:e=>{e&&this.setState({runtimeInfo:e.bean?e.bean:{}})}})}),this.handleEditRuntime=(e=>{this.props.dispatch({type:"appControl/editRuntimeBuildInfo",payload:{team_name:T.default.getCurrTeamName(),app_alias:this.props.appDetail&&this.props.appDetail.service&&this.props.appDetail.service.service_alias,build_env_dict:e},callback:e=>{e&&200===e.status_code&&(h.default.success({message:(0,k.formatMessage)({id:"notification.success.modified"})}),this.getRuntimeInfo())}})}),this.handleEditInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.props.dispatch({type:"appControl/editAppCreateInfo",payload:(0,f.default)({team_name:T.default.getCurrTeamName(),app_alias:t.props.appDetail&&t.props.appDetail.service&&t.props.appDetail.service.service_alias},e),callback:e=>{e&&t.props.updateDetail()}})},this.changeBuildSource=(()=>{this.setState({changeBuildSource:!0})}),this.hideBuildSource=(()=>{this.setState({changeBuildSource:!1})}),this.changeEditOauth=(()=>{this.handleProvinceChange(),this.setState({editOauth:!0})}),this.hideEditOauth=(()=>{this.setState({editOauth:!1})}),this.loadBuildSourceInfo=(()=>{var e=this.props.dispatch,t=T.default.getCurrTeamName();e({type:"appControl/getAppBuidSource",payload:{team_name:t,service_alias:this.props.appDetail&&this.props.appDetail.service&&this.props.appDetail.service.service_alias},callback:e=>{if(e){var t=e.bean;if("package_build"===t.service_source){var a=t&&t.git_url,l=a.lastIndexOf("/"),n=a.substring(l+1,a.length);this.setState({event_id:n})}this.setState({buildSource:t},()=>{t&&t.code_from&&t.code_from.indexOf("oauth")>-1&&this.loadThirdInfo()})}}})}),this.loadThirdInfo=(()=>{var e=this.props.dispatch,t=this.state.buildSource;e({type:"global/codeThirdInfo",payload:{full_name:t.full_name,oauth_service_id:t.oauth_service_id},callback:e=>{e&&200===e.status_code&&this.setState({thirdInfo:e.bean})}})}),this.handleToDetect=(()=>{this.setState({languageBox:!0})}),this.handleToUpload=(()=>{this.setState({uploadFile:!0}),this.handleJarWarUploadRecord()}),this.handlelanguageBox=(()=>{this.setState({languageBox:!1,create_status:""})}),this.handleDetectGetLanguage=(()=>{var e=this.props.dispatch,t=this;e({type:"appControl/getLanguage",payload:{team_name:T.default.getCurrTeamName(),service_alias:this.props.appDetail&&this.props.appDetail.service&&this.props.appDetail.service.service_alias,check_uuid:this.state.check_uuid},callback:e=>{e&&200===e.status_code&&(e.bean&&"success"!=e.bean.check_status&&"failure"!=e.bean.check_status?setTimeout(function(){t.handleDetectGetLanguage()},3e3):(this.loadBuildSourceInfo(),this.setState({create_status:e.bean&&e.bean.check_status,service_info:e.bean&&e.bean.service_info,error_infos:e.bean&&e.bean.error_infos})))}})}),this.handleDetectPutLanguage=(()=>{var e=this.props.dispatch,t=this.state.event_id;e({type:"appControl/putLanguage",payload:{team_name:T.default.getCurrTeamName(),service_alias:this.props.appDetail&&this.props.appDetail.service&&this.props.appDetail.service.service_alias,eventId:t},callback:e=>{e&&this.setState({create_status:e.bean&&e.bean.create_status,check_uuid:e.bean&&e.bean.check_uuid},()=>{"failure"==this.state.create_status?h.default.warning({message:(0,k.formatMessage)({id:"notification.warn.update_language"})}):this.handleDetectGetLanguage()})}})}),this.hideMarketAppDetail=(()=>{this.setState({showApp:{},showMarketAppDetail:!1})}),this.handleCodeWarehouseType=(e=>{var t=e.dispatch,a=this.state,l=a.tabType,n=a.buildSource,s=this.props.form.getFieldValue("oauth_service_id"),i=this.props.form.getFieldValue("full_name");t({type:"global/codeWarehouseType",payload:{type:l,full_name:i||n.full_name,oauth_service_id:s||n.oauth_service_id},callback:e=>{e&&200===e.status_code&&this.setState({tags:e.bean?e.bean[l]:[],tagsLoading:!1,OauthLoading:!1})}})}),this.onTabChange=(e=>{this.setState({tabType:e,tagsLoading:!0},()=>{this.handleCodeWarehouseType(this.props)})}),this.onPagePre=(()=>{var e=this.state.page;if(e>1){var t=e-1,a=1==e;this.setState({firstPage:a,page:t},()=>{this.handleProvinceChange()})}}),this.onPageNext=(()=>{var e=this.state,t=e.lastPage,a=e.page;if(!t){var l=a+1;this.setState({page:l},()=>{this.handleProvinceChange()})}}),this.handleProvinceChange=(e=>{var t=this.props.dispatch,a=this.props.form.setFieldsValue,l=this.state,n=l.tabList,s=l.buildSource,i=l.page,r=this.props.form.getFieldValue("oauth_service_id");this.setState({OauthLoading:!0}),t({type:"global/codeWarehouseInfo",payload:{page:i,oauth_service_id:e||r||s&&s.oauth_service_id||(n.length>0?n[0].id:"")},callback:t=>{if(t&&200===t.status_code&&t.bean&&t.bean.repositories&&t.bean.repositories.length>0){var l=1==i,n=t.bean.repositories.length<10,s=t.bean.repositories[0].project_full_name,r=t.bean.repositories[0].project_url,o=t.bean.repositories[0].project_default_branch;e&&a({full_name:s,git_url:r,code_version:o}),this.setState({firstPage:l,lastPage:n,fullList:t.bean.repositories},()=>{this.handleCodeWarehouseType(this.props)})}else this.setState({tagsLoading:!1,OauthLoading:!1})}})}),this.handleProjectChange=(e=>{this.setState({OauthLoading:!0});var t=this.props.form.setFieldsValue,a=this.state.fullList;a.map(a=>{a.project_full_name===e&&t({git_url:a.project_url,code_version:a.project_default_branch},()=>{this.handleCodeWarehouseType(this.props),this.setState({OauthLoading:!1})})})}),this.handleSubmitOauth=(()=>{var e=this.props.form;e.validateFields((e,t)=>{e||this.props.dispatch({type:"appControl/putAppBuidSource",payload:{team_name:T.default.getCurrTeamName(),service_alias:this.props.appAlias,is_oauth:!0,oauth_service_id:t.oauth_service_id,full_name:t.full_name,git_url:t.git_url,code_version:t.code_version,service_source:"source_code"},callback:()=>{h.default.success({message:(0,k.formatMessage)({id:"notification.success.edit_deploy"})}),this.loadBuildSourceInfo(),this.hideEditOauth()}})})}),this.cancelModifyUrl=(()=>{this.setState({modifyUserpass:!1})}),this.handleCancelEdit=(()=>{this.setState({modifyUserpass:!1})}),this.handleModifyUrl=(e=>{var t=this.props&&this.props.appDetail&&this.props.appDetail.service,a=T.default.getCurrTeamName();this.props.dispatch({type:"appControl/editAppCreateInfo",payload:{service_cname:e.service_cname?e.service_cname:"",git_url:e.git_url?e.git_url:"",team_name:a,app_alias:t.service_alias,user_name:e.user_name,password:e.password},callback:e=>{e&&(this.handleDetectPutLanguage(),this.handleCancelEdit())}})}),this.state={runtimeInfo:"",changeBuildSource:!1,editOauth:!1,buildSource:null,showMarketAppDetail:!1,showApp:{},create_status:"",languageBox:!1,service_info:"",error_infos:"",thirdInfo:!1,tags:[],tagsLoading:!0,tabType:"branches",fullList:[],tabList:[],OauthLoading:!0,page:1,uploadFile:!1,fileList:[],record:{},event_id:"",percents:!1,existFileList:[],modifyUrl:!1,modifyUserpass:!1,showKey:!1,modifyImageName:!1,modifyImageCmd:!1}}componentDidMount(){this.props.appDetail&&this.props.appDetail.service&&this.props.appDetail.service.service_alias?(this.setOauthService(),this.getRuntimeInfo(),this.loadBuildSourceInfo(),this.bindEvent()):this.time()}componentWillUnmount(){this.loop=!1,this.statusloop=!1,this.unbindEvent()}getParams(){return{group_id:this.props.match.params.appID,compose_id:this.props.match.params.composeId}}canView(){var e=this.props.componentPermissions.isSource;return e}render(){if(!this.canView())return O.default.createElement(D.default,null);var e=this.props,t=e.form,a=e.match,l=e.appDetail,n=this.state,f=n.runtimeInfo,h=n.thirdInfo,y=n.buildSource,b=n.tags,_=n.tagsLoading,E=n.fullList,w=n.tabList,C=n.firstPage,T=n.lastPage,P=n.fileList,B=n.record,j=n.existFileList,X=(n.modifyUrl,n.modifyUserpass),K=(n.modifyImageName,n.modifyImageCmd,n.showKey,{}),Q=(F.default.getLanguage(l),{labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:21}}}),W={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},G=a.params,Y=G.teamName,J=G.regionName,Z=t.getFieldDecorator,$=y?y.language:"",ee=F.default.getCreateTypeCNByBuildSource(y),te=ee&&"\u672c\u5730\u5171\u4eab\u5e93"===ee,ae=$||"";return O.default.createElement(O.Fragment,null,y&&O.default.createElement(u.default,{title:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.Jianyuan"}),style:{marginBottom:24},extra:[F.default.isOauthByBuildSource(y)?O.default.createElement("a",{onClick:this.changeEditOauth,href:"javascript:;"},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.edit"})):O.default.createElement("a",{onClick:this.changeBuildSource,href:"javascript:;"},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.change"}))]},O.default.createElement("div",null,O.default.createElement(q,(0,p.default)({style:{marginBottom:0}},Q,{label:F.default.isOauthByBuildSource(y)&&h?O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.oauth"}):O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.type"})}),O.default.createElement(S.Link,{to:te&&"/team/".concat(Y,"/region/").concat(J,"/create/market"),style:{color:!te&&"rgba(0, 0, 0, 0.65)"}},F.default.isOauthByBuildSource(y)&&h?h.service_name:ee))),F.default.isImageAppByBuildSource(y)?O.default.createElement("div",null,O.default.createElement(q,(0,p.default)({style:{marginBottom:0}},Q,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.name"})}),y.image),O.default.createElement(q,(0,p.default)({style:{marginBottom:0}},Q,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.edition"})}),y.version),O.default.createElement(q,(0,p.default)({style:{marginBottom:0}},Q,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.command"})}),y.cmd||"")):"",F.default.isMarketAppByBuildSource(y)?O.default.createElement(O.Fragment,null,O.default.createElement(q,(0,p.default)({style:{marginBottom:0}},Q,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.template"})}),y.group_key?O.default.createElement("a",{href:"javascript:;",onClick:()=>{this.setState({showApp:{details:y.details,group_name:y.rain_app_name,group_key:y.group_key},showMarketAppDetail:!0})}},y.rain_app_name):O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.notfind"})),O.default.createElement(q,(0,p.default)({style:{marginBottom:0}},Q,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.edition"})}),y.version)):"",F.default.isOauthByBuildSource(y)&&O.default.createElement(q,(0,p.default)({style:{marginBottom:0}},Q,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.entry_name"})}),O.default.createElement("a",{href:y.git_url,target:"_blank"},y.full_name)),F.default.isCodeAppByBuildSource(y)?O.default.createElement(O.Fragment,null,O.default.createElement(q,(0,p.default)({style:{marginBottom:0}},Q,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.git_add"})}),O.default.createElement("a",{href:y.git_url,target:"_blank"},y.git_url)),O.default.createElement(q,(0,p.default)({style:{marginBottom:0}},Q,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.code_edition"})}),y.code_version),O.default.createElement(q,(0,p.default)({style:{marginBottom:0}},Q,{className:R.default.ant_form_item,label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.language"})}),"static"!=ae?O.default.createElement("a",{target:"blank",href:N.languageObj["".concat(ae)]},ae):O.default.createElement("a",{href:"javascript:void(0);"},ae),O.default.createElement(m.default,{size:"small",type:"primary",onClick:this.handleToDetect},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.Retest"})))):"",F.default.isUploadFilesAppSource(y)?O.default.createElement(O.Fragment,null,O.default.createElement(q,(0,p.default)({style:{marginBottom:0}},Q,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.file_name"})}),y.package_name,O.default.createElement(m.default,{size:"small",onClick:this.handleToUpload,style:{marginLeft:"6px"}},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.Re_upload_file"}))),O.default.createElement(q,(0,p.default)({style:{marginBottom:0}},Q,{className:R.default.ant_form_item,label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.language"})}),O.default.createElement(O.default.Fragment,null,ae),O.default.createElement(m.default,{size:"small",type:"primary",onClick:this.handleToDetect,style:{marginLeft:"6px"}},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.Retest"})))):""),y&&O.default.createElement(I.default,{app:this.props.appDetail,service_source:F.default.getCreateTypeCNByBuildSource(y)}),this.state.languageBox&&O.default.createElement(o.default,{visible:this.state.languageBox,onCancel:this.handlelanguageBox,title:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.Retest"}),footer:this.state.create_status?"success"==this.state.create_status?[O.default.createElement(m.default,{key:"back",onClick:this.handlelanguageBox},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.close"})),O.default.createElement(m.default,{key:"submit",type:"primary",onClick:this.handlelanguageBox},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.confirm"}))]:[O.default.createElement(m.default,{onClick:this.handlelanguageBox,key:"back"},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.close"}))]:[O.default.createElement(m.default,{key:"back",onClick:this.handlelanguageBox},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.close"})),O.default.createElement(m.default,{key:"submit",type:"primary",onClick:this.handleDetectPutLanguage},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.testing"}))]},O.default.createElement("div",null,"checking"==this.state.create_status||"complete"==this.state.create_status?O.default.createElement("div",null,O.default.createElement("p",{style:{textAlign:"center"}},O.default.createElement(c.default,null)),O.default.createElement("p",{style:{textAlign:"center",fontSize:"14px"}},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.Testing"}))):"","failure"==this.state.create_status?O.default.createElement("div",null,O.default.createElement("p",{style:{textAlign:"center",color:"#28cb75",fontSize:"36px"}},O.default.createElement(d.default,{style:{color:"#f5222d",marginRight:8},type:"close-circle-o"})),this.state.error_infos&&this.state.error_infos.map(e=>{return O.default.createElement("div",null,O.default.createElement("span",{dangerouslySetInnerHTML:{__html:"<span>".concat(e.error_info||""," ").concat(e.solve_advice||"","</span>")}}))})):"","success"==this.state.create_status?O.default.createElement("div",null,O.default.createElement("p",{style:{textAlign:"center",color:"#28cb75",fontSize:"36px"}},O.default.createElement(d.default,{type:"check-circle-o"})),this.state.service_info&&this.state.service_info.map(e=>{return O.default.createElement("p",{style:{textAlign:"center",fontSize:"14px"}},e.key,":",e.value," ")})):"","failed"==this.state.create_status?O.default.createElement("div",null,O.default.createElement("p",{style:{textAlign:"center",color:"999",fontSize:"36px"}},O.default.createElement(d.default,{type:"close-circle-o"})),O.default.createElement("p",{style:{textAlign:"center",fontSize:"14px"}},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.fail"}))):"",!this.state.create_status&&O.default.createElement("div",null,O.default.createElement("p",{style:{textAlign:"center",fontSize:"14px"}},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.testing_again"}))))),this.state.uploadFile&&O.default.createElement(o.default,{visible:!0,onCancel:this.handleUploadCancel,onOk:this.handleUploadOk,title:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.upload"})},O.default.createElement(r.default,{fileList:P,name:"packageTarFile",onChange:this.onChangeUpload,onRemove:this.onRemove,action:B.upload_url,headers:K,multiple:!0},O.default.createElement(m.default,null,O.default.createElement(d.default,{type:"upload"})," ",O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.upload"}))),O.default.createElement("div",{style:{display:"flex",marginTop:"20px"}},O.default.createElement("div",null,j.length>0?j.map(e=>{return O.default.createElement("div",{style:{padding:"12px 8px",border:"1px solid #d9d9d9"}},O.default.createElement(d.default,{style:{marginRight:"6px"},type:"inbox"}),O.default.createElement("span",{className:R.default.fileName},e))}):null),j.length>0&&O.default.createElement("div",{style:{display:"flex",alignItems:"center",background:"#ff7b7b",padding:"0px 12px",justifyContent:"center"}},O.default.createElement(d.default,{onClick:this.handleJarWarUploadDelete,style:{color:"#fff",cursor:"pointer"},type:"delete"})))),ae&&f&&O.default.createElement(A.default,{appDetail:this.props.appDetail,onSubmit:this.handleEditRuntime,language:ae,runtimeInfo:this.state.runtimeInfo}),this.state.changeBuildSource&&O.default.createElement(L.default,{onOk:this.onChangeBuildSource,buildSource:y,appAlias:this.props.appDetail.service.service_alias,title:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.Change_component_build_source"}),onCancel:this.hideBuildSource}),this.state.editOauth&&O.default.createElement(o.default,{visible:this.state.editOauth,onCancel:this.hideEditOauth,onOk:this.handleSubmitOauth,loading:this.state.OauthLoading,title:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.edit"})},O.default.createElement(c.default,{spinning:this.state.OauthLoading},O.default.createElement(v.default,{onSubmit:this.handleSubmitOauth},O.default.createElement(q,(0,p.default)({},W,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.oauth"})}),Z("oauth_service_id",{initialValue:h?"".concat(h.service_id):"",rules:[{required:!0,message:(0,k.formatMessage)({id:"componentOverview.body.Resource.choice_oauth"})}]})(O.default.createElement(g.default,{getPopupContainer:e=>e.parentNode,onChange:this.handleProvinceChange,placeholder:(0,k.formatMessage)({id:"componentOverview.body.Resource.choice_oauth"})},w.length>0&&w.map(e=>e.enable&&O.default.createElement(U,{key:e.id,value:e.id},e.name))))),O.default.createElement(q,(0,p.default)({},W,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.entry_name"})}),Z("full_name",{initialValue:y?y.full_name:E.length>0&&E[0].project_full_name,rules:[{required:!0,message:(0,k.formatMessage)({id:"componentOverview.body.Resource.choice_entry"})}]})(O.default.createElement(g.default,{getPopupContainer:e=>e.parentNode,onChange:this.handleProjectChange,dropdownRender:e=>O.default.createElement("div",null,e,!C&&O.default.createElement("div",null,O.default.createElement(i.default,{style:{margin:"4px 0"}}),O.default.createElement("div",{style:{padding:"4px 8px",cursor:"pointer"},onMouseDown:e=>e.preventDefault(),onClick:this.onPagePre},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.previous"}))),!T&&O.default.createElement("div",null,O.default.createElement(i.default,{style:{margin:"4px 0"}}),O.default.createElement("div",{style:{padding:"4px 8px",cursor:"pointer"},onMouseDown:e=>e.preventDefault(),onClick:this.onPageNext},O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.next"})))),placeholder:(0,k.formatMessage)({id:"componentOverview.body.Resource.choice_entry"})},E.length>0&&E.map(e=>O.default.createElement(U,{key:e.project_url,value:e.project_full_name},e.project_full_name))))),O.default.createElement(q,(0,p.default)({},W,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.git_add"})}),Z("git_url",{initialValue:y?y.git_url:E.length>0&&E[0].git_url,rules:[{required:!0,message:(0,k.formatMessage)({id:"componentOverview.body.Resource.placese_type"})}]})(O.default.createElement(s.default,{placeholder:(0,k.formatMessage)({id:"componentOverview.body.Resource.input_name"}),disabled:!0}))),O.default.createElement(v.default.Item,(0,p.default)({className:R.default.clearConform},W,{label:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.code_edition"})}),Z("code_version",{initialValue:y?y.code_version:"",rules:[{required:!0,message:(0,k.formatMessage)({id:"componentOverview.body.Resource.input_code"})}]})(O.default.createElement(g.default,{getPopupContainer:e=>e.parentNode,placeholder:(0,k.formatMessage)({id:"componentOverview.body.Resource.input_code"})},O.default.createElement(z,{label:O.default.createElement(M.default,{defaultActiveKey:"branches",onChange:this.onTabChange,className:R.default.selectTabs},O.default.createElement(H,{tab:O.default.createElement(k.FormattedMessage,{id:"componentOverview.body.Resource.branch"}),key:"branches"}),O.default.createElement(H,{tab:"Tags",key:"tags"}))},b.length>0?b.map(e=>{return O.default.createElement(U,{key:e,value:e},e)}):O.default.createElement(U,{value:"loading"},O.default.createElement(c.default,{spinning:_}))))))))," "),X&&O.default.createElement(V.default,{showUsernameAndPass:!0,isServiceCname:!0,data:y,service_cname:l&&l.service&&l.service.service_cname,onSubmit:this.handleModifyUrl,onCancel:this.cancelModifyUrl}),this.state.showMarketAppDetail&&O.default.createElement(x.default,{onOk:this.hideMarketAppDetail,onCancel:this.hideMarketAppDetail,app:this.state.showApp}))}},E.contextType=B.ResumeContext,_=w))||_)||_);t.default=j},Lu99:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV"));a("P2fV");var i=l(a("NJEC"));a("IzEo");var r=l(a("bx4M"));a("BoS7");var o=l(a("Sdc0"));a("+L6B");var d=l(a("2/Rp")),c=l(a("jehZ"));a("/xke");var u=l(a("TeRw")),m=l(a("p0pE"));a("7Kak");var p=l(a("9yH6"));a("y8nQ");var f,h,g,v,y=l(a("Vl3Y")),b=a("MuoO"),_=n(a("q1tI")),E=a("LLXN"),w=l(a("q76B")),M=l(a("iPMB")),C=l(a("cUW5")),S=l(a("AipW")),O=l(a("CQXj")),k=l(a("WTXe")),A=l(a("QDog")),x=l(a("UJxd")),D=l(a("18Tw")),F=l(a("Bg2k")),T=l(a("2RmR")),P=l(a("YTVB")),N=l(a("GUlx")),R=l(a("760Q")),I=l(a("qPtA")),L=l(a("sg1L")),V=l(a("8+Sn")),B=y.default.Item,H=p.default.Group,q=(f=(0,b.connect)(e=>{var t=e.user,a=e.appControl,l=e.teamControl;return{currUser:t.currentUser,startProbe:a.startProbe,runningProbe:a.runningProbe,ports:a.ports,baseInfo:a.baseInfo,appDetail:a.appDetail,teamControl:l,appControl:a}},null,null,{withRef:!0}),h=y.default.create(),f(g=h((v=class extends _.default.Component{constructor(e){super(e),this.onTransfer=(e=>{this.setState({transfer:e})}),this.onDeleteVar=(e=>{this.setState({deleteVar:e})}),this.fetchBaseInfo=(()=>{var e=this.props.dispatch;e({type:"appControl/fetchBaseInfo",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias}})}),this.fetchPorts=(()=>{var e=this.props.dispatch;e({type:"appControl/fetchPorts",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias}})}),this.fetchTags=(()=>{var e=this.props.dispatch;e({type:"appControl/fetchTags",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias},callback:e=>{e&&this.setState({tags:e.used_labels})}})}),this.fetchInnerEnvs=(()=>{var e=this.state,t=e.page,a=e.page_size,l=e.env_name;this.props.dispatch({type:"appControl/fetchInnerEnvs",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,page:t,page_size:a,env_name:l}})}),this.loadMembers=(()=>{var e=this.props.dispatch,t=A.default.getCurrTeamName();e({type:"teamControl/fetchMember",payload:{team_name:t,app_alias:this.props.appAlias},callback:e=>{e&&this.setState({memberslist:e.list})}})}),this.showAddMember=(()=>{this.setState({showAddMember:!0})}),this.hideAddMember=(()=>{this.setState({showAddMember:!1})}),this.handleAddMember=(e=>{this.props.dispatch({type:"appControl/setMemberAction",payload:(0,m.default)({team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias},e),callback:()=>{this.loadMembers(),this.hideAddMember()}})}),this.handleAddVar=(()=>{this.setState({showAddVar:!0})}),this.handleCancelAddVar=(()=>{this.setState({showAddVar:!1})}),this.handleSubmitAddVar=(e=>{this.props.dispatch({type:"appControl/addInnerEnvs",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,attr_name:e.attr_name,attr_value:e.attr_value,name:e.name},callback:()=>{this.handleCancelAddVar(),this.fetchInnerEnvs()}})}),this.cancelDeleteVar=(()=>{this.setState({deleteVar:null})}),this.cancelTransfer=(()=>{this.setState({transfer:null})}),this.handleDeleteVar=(()=>{this.props.dispatch({type:"appControl/deleteEnvs",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,ID:this.state.deleteVar.ID},callback:()=>{this.cancelDeleteVar(),this.fetchInnerEnvs(),u.default.success({message:(0,E.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0)}})}),this.handleTransfer=(()=>{var e=this.state.transfer;this.props.dispatch({type:"appControl/putTransfer",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,ID:e.ID,scope:"inner"==e.scope?"outer":"inner"},callback:()=>{this.cancelTransfer(),this.fetchInnerEnvs(),u.default.success({message:(0,E.formatMessage)({id:"notification.success.succeeded"})})}})}),this.onEditVar=(e=>{this.setState({showEditVar:e})}),this.cancelEditVar=(()=>{this.setState({showEditVar:null})}),this.handleEditVar=(e=>{var t=this.state.showEditVar;this.props.dispatch({type:"appControl/editEvns",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,ID:t.ID,attr_value:e.attr_value,name:e.name},callback:()=>{this.cancelEditVar(),this.fetchInnerEnvs()}})}),this.handleStartProbeStart=(e=>{var t=this.props.startProbe;this.props.dispatch({type:"appControl/editStartProbe",payload:(0,m.default)({team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias},t,{is_used:e}),callback:t=>{t&&t.status_code&&200===t.status_code&&(this.fetchStartProbe(),e?u.default.success({message:(0,E.formatMessage)({id:"notification.success.assembly_start"})}):u.default.success({message:(0,E.formatMessage)({id:"notification.success.assembly_disable"})}))}})}),this.handleRunProbeStart=(e=>{var t=this.props.runningProbe;this.props.dispatch({type:"appControl/editRunProbe",payload:(0,m.default)({team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias},t,{is_used:e}),callback:()=>{this.fetchRunningProbe()}})}),this.handleEditHealth=(e=>{var t=this.props.startProbe;this.setState({loading:!0}),O.default.isStartProbeUsed(this.state.editStartHealth)?this.props.dispatch({type:"appControl/editStartProbe",payload:(0,m.default)({team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias},e,{old_mode:t.mode}),callback:e=>{e&&e.status_code&&200===e.status_code&&(this.onCancelEditStartProbe(),this.fetchStartProbe(),u.default.success({message:(0,E.formatMessage)({id:"notification.success.assembly_edit"})}))}}):this.props.dispatch({type:"appControl/addStartProbe",payload:(0,m.default)({team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias},e),callback:e=>{e&&e.status_code&&200===e.status_code&&(this.onCancelEditStartProbe(),this.fetchStartProbe(),u.default.success({message:(0,E.formatMessage)({id:"notification.success.add"})}),u.default.info({message:(0,E.formatMessage)({id:"notification.hint.need_updata"})}))}})}),this.handleEditRunHealth=(e=>{O.default.isRunningProbeUsed(this.state.editRunHealth)?this.props.dispatch({type:"appControl/editRunProbe",payload:(0,m.default)({team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias},e),callback:()=>{this.onCancelEditRunProbe(),this.fetchRunningProbe()}}):this.props.dispatch({type:"appControl/addRunProbe",payload:(0,m.default)({team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias},e),callback:()=>{this.onCancelEditRunProbe(),this.fetchRunningProbe()}})}),this.showViewStartHealth=(e=>{this.setState({viewStartHealth:e})}),this.hiddenViewStartHealth=(()=>{this.setState({viewStartHealth:null})}),this.showViewRunningHealth=(e=>{this.setState({viewRunHealth:e})}),this.hiddenViewRunningHealth=(()=>{this.setState({viewRunHealth:null})}),this.onCancelEditStartProbe=(()=>{this.setState({editStartHealth:null,loading:!1})}),this.onCancelEditRunProbe=(()=>{this.setState({editRunHealth:null})}),this.handleRemoveTag=(e=>{this.props.dispatch({type:"appControl/deleteTag",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,label_id:e.label_id},callback:()=>{u.default.success({message:(0,E.formatMessage)({id:"notification.success.delete"})}),this.fetchTags()}})}),this.onAddTag=(()=>{this.props.dispatch({type:"appControl/getTagInformation",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias},callback:e=>{e&&this.setState({addTag:!0,tabData:e.list})}})}),this.cancelAddTag=(()=>{this.setState({addTag:!1,tabData:[]})}),this.handleAddTag=(e=>{this.props.dispatch({type:"appControl/addTag",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,label_ids:e},callback:()=>{this.cancelAddTag(),u.default.success({message:(0,E.formatMessage)({id:"notification.success.assembly_add"})}),this.fetchTags(),this.setState({tabData:[]})}})}),this.onEditAction=(e=>{this.setState({toEditAction:e})}),this.hideEditAction=(()=>{this.setState({toEditAction:null})}),this.handleEditAction=(e=>{var t=A.default.getCurrTeamName();this.props.dispatch({type:"appControl/editMemberAction",payload:(0,m.default)({team_name:t,user_id:this.state.toEditAction.user_id,app_alias:this.props.appAlias},e),callback:()=>{this.loadMembers(),this.hideEditAction()}})}),this.hideMarketAppDetail=(()=>{this.setState({showApp:{},showMarketAppDetail:!1})}),this.updateComponentDetail=(()=>{var e=this.props.match.params.teamName,t=this.props.appAlias;this.props.dispatch({type:"appControl/fetchDetail",payload:{team_name:e,app_alias:t},callback:e=>{this.setState({currentComponent:e.service})}})}),this.setupAttribute=(()=>{k.default.canVisit(this.props.status)?u.default.warning({message:(0,E.formatMessage)({id:"notification.warn.assembly_close"})}):this.setState({visibleAppSetting:!0})}),this.handleOk_AppSetting=(()=>{var e=this.props.dispatch;this.props.form.validateFields((t,a)=>{t||e({type:"appControl/updateComponentDeployType",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias,extend_method:a.extend_method},callback:e=>{e&&(u.default.success({message:e.msg_show||(0,E.formatMessage)({id:"notification.success.modified"})}),this.setState({visibleAppSetting:!1,isShow:!1},()=>{this.fetchBaseInfo(),this.updateComponentDetail()}))}})})}),this.handleChange=(e=>{var t=this.props.onChecked;t&&(t(e),setTimeout(()=>{this.fetchBaseInfo()},1e3))}),this.handleCancel_AppSetting=(()=>{this.setState({visibleAppSetting:!1,isShow:!1})}),this.onChange1=(e=>{var t=e.target.value!=(this.props.baseInfo&&this.props.baseInfo.extend_method||"stateless_multiple");this.setState({isShow:t})}),this.handleState=(e=>{return O.default.isStartProbeUsed(e)?O.default.isStartProbeStart(e)?"".concat((0,E.formatMessage)({id:"componentOverview.body.setting.Enabled"})):"".concat((0,E.formatMessage)({id:"componentOverview.body.setting.disabled"})):"".concat((0,E.formatMessage)({id:"componentOverview.body.setting.Not_set"}))}),this.onPageChange=(e=>{this.setState({page:e},()=>{this.fetchInnerEnvs()})}),this.handleSearch=(e=>{this.setState({page:1,env_name:e},()=>{this.fetchInnerEnvs()})}),this.state={isShow:!1,showAddVar:!1,showEditVar:null,deleteVar:null,transfer:null,viewStartHealth:null,editStartHealth:null,viewRunHealth:null,editRunHealth:null,addTag:!1,tabData:[],showAddMember:!1,toEditAction:null,memberslist:null,showMarketAppDetail:!1,showApp:{},visibleAppSetting:!1,tags:[],page:1,page_size:5,env_name:"",loading:!1,language:"zh-CN"===V.default.get("language")}}componentDidMount(){this.canView()&&(this.props.dispatch({type:"teamControl/fetchAllPerm"}),this.fetchInnerEnvs(),this.fetchStartProbe(),this.fetchRunningProbe(),this.fetchPorts(),this.fetchBaseInfo(),this.fetchTags(),this.loadMembers())}componentWillUnmount(){var e=this.props.dispatch;e({type:"appControl/clearTags"}),e({type:"appControl/clearPorts"}),e({type:"appControl/clearInnerEnvs"}),e({type:"appControl/clearStartProbe"}),e({type:"appControl/clearRunningProbe"}),e({type:"appControl/clearMembers"})}fetchStartProbe(){this.props.dispatch({type:"appControl/fetchStartProbe",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias}})}fetchRunningProbe(){this.props.dispatch({type:"appControl/fetchRunningProbe",payload:{team_name:A.default.getCurrTeamName(),app_alias:this.props.appAlias},callback:e=>{}})}canView(){var e=this.props.componentPermissions,t=e.isDeploytype,a=e.isCharacteristic,l=e.isHealth;return t||a||l}render(){if(!this.canView())return _.default.createElement(C.default,null);var e=this.props,t=e.startProbe,a=e.ports,l=e.baseInfo,n=e.teamControl,u=e.form,m=e.componentPermissions,f=m.isDeploytype,h=(m.isCharacteristic,m.isHealth),g=e.appDetail,v=this.props&&this.props.baseInfo&&this.props.baseInfo.extend_method||"stateless_multiple",b=this.state,k=b.viewStartHealth,V=(b.tags,b.tabData),q=b.isShow,U=b.loading,z=b.language,j=u.getFieldDecorator,X={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:18}}},K={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},Q=z?X:K,W={wrapperCol:{span:24}},G={display:"block",height:"30px",lineHeight:"30px"};return"boolean"!==typeof l.build_upgrade?null:_.default.createElement(_.Fragment,null,_.default.createElement(r.default,{style:{marginBottom:24},title:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.information"})},_.default.createElement(y.default,null,_.default.createElement(B,(0,c.default)({style:{marginBottom:0}},Q,{label:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.time"})}),l.create_time||""),_.default.createElement(B,(0,c.default)({style:{marginBottom:0}},Q,{label:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.type"})}),v&&A.default.getComponentType(v),f&&_.default.createElement(d.default,{onClick:this.setupAttribute,size:"small",style:{marginLeft:"10px"}},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.change"}))),_.default.createElement(B,(0,c.default)({style:{marginBottom:0}},Q,{label:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.upgrade"})}),_.default.createElement(o.default,{defaultChecked:l.build_upgrade,onChange:this.handleChange})))),h&&_.default.createElement(r.default,{style:{marginBottom:24},title:_.default.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.health"}),t&&_.default.createElement("div",null,_.default.createElement("a",{onClick:()=>{this.setState({editStartHealth:t})},style:{marginRight:"5px",fontSize:"14px",fontWeight:400}},"{}"!=JSON.stringify(t)?_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.edit"}):_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.set"})),"{}"!=JSON.stringify(t)&&O.default.isStartProbeStart(t)?_.default.createElement("a",{onClick:()=>{this.handleStartProbeStart(!1)},style:{fontSize:"14px",fontWeight:400}},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.Disable"})):"{}"!=JSON.stringify(t)&&_.default.createElement("a",{onClick:()=>{this.handleStartProbeStart(!0)},style:{fontSize:"14px",fontWeight:400}},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.Enable"}))))},t&&_.default.createElement("div",{style:{display:"flex"}},_.default.createElement("div",{style:{width:"33%",textAlign:"center"}},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.state"}),this.handleState(t)),_.default.createElement("div",{style:{width:"33%",textAlign:"center"}},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.method"}),t.scheme?t.scheme:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.Not_set"})),_.default.createElement("div",{style:{width:"33%",textAlign:"center"}},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.unhealth"}),"readiness"===t.mode?_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.OfflineOffline"}):"liveness"===t.mode?_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.restart"}):_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.Not_set"})))),("job"===(g&&g.service&&g.service.extend_method)||"cronjob"===(g&&g.service&&g.service.extend_method))&&_.default.createElement(L.default,{extend_method:g.service.extend_method,service_alias:g&&g.service&&g.service.service_alias}),_.default.createElement(x.default,{service_alias:g&&g.service&&g.service.service_alias}),this.state.addTag&&_.default.createElement(D.default,{tags:V||[],onCancel:this.cancelAddTag,onOk:this.handleAddTag}),this.state.showAddVar&&_.default.createElement(P.default,{onCancel:this.handleCancelAddVar,onSubmit:this.handleSubmitAddVar,isShowRestartTips:e=>{this.props.onshowRestartTips(e)}}),this.state.showEditVar&&_.default.createElement(P.default,{onCancel:this.cancelEditVar,onSubmit:this.handleEditVar,data:this.state.showEditVar,isShowRestartTips:e=>{this.props.onshowRestartTips(e)}}),this.state.deleteVar&&_.default.createElement(w.default,{onOk:this.handleDeleteVar,onCancel:this.cancelDeleteVar,title:_.default.createElement(E.FormattedMessage,{id:"confirmModal.deldete.env.title"}),desc:_.default.createElement(E.FormattedMessage,{id:"confirmModal.deldete.env.desc"}),subDesc:_.default.createElement(E.FormattedMessage,{id:"confirmModal.deldete.env.subDesc"})}),this.state.transfer&&_.default.createElement(w.default,{onOk:this.handleTransfer,onCancel:this.cancelTransfer,title:_.default.createElement(E.FormattedMessage,{id:"confirmModal.deldete.transfer.title"}),desc:_.default.createElement(E.FormattedMessage,{id:"confirmModal.deldete.transfer.determine"}),subDesc:""}),k&&_.default.createElement(N.default,{title:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.health_examination"}),data:k,onCancel:()=>{this.setState({viewStartHealth:null})}}),this.state.editStartHealth&&_.default.createElement(F.default,{ports:a,onOk:this.handleEditHealth,title:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.health"}),data:this.state.editStartHealth,onCancel:this.onCancelEditStartProbe,loading:U}),this.state.toEditAction&&_.default.createElement(R.default,{onSubmit:this.handleEditAction,onCancel:this.hideEditAction,actions:n.actions,value:this.state.toEditAction.service_perms.map(e=>e.id)}),this.state.viewRunHealth&&_.default.createElement(I.default,{title:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.see"}),data:this.state.viewRunHealth,onCancel:()=>{this.setState({viewRunHealth:null})}}),this.state.editRunHealth&&_.default.createElement(T.default,{ports:a,onOk:this.handleEditRunHealth,title:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.inspect"}),data:this.state.editRunHealth,onCancel:this.onCancelEditRunProbe}),this.state.showAddMember&&_.default.createElement(S.default,{members:this.state.memberslist,actions:n.actions,onOk:this.handleAddMember,onCancel:this.hideAddMember}),this.state.showMarketAppDetail&&_.default.createElement(M.default,{onOk:this.hideMarketAppDetail,onCancel:this.hideMarketAppDetail,app:this.state.showApp}),this.state.visibleAppSetting&&_.default.createElement(s.default,{title:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.deployment"}),visible:this.state.visibleAppSetting,width:600,onCancel:this.handleCancel_AppSetting,footer:q?[_.default.createElement(i.default,{title:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.Modify"}),onConfirm:this.handleOk_AppSetting,onCancel:this.handleCancel_AppSetting,okText:"Yes",cancelText:"No"},_.default.createElement(d.default,{type:"primary"},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.determine"}))),_.default.createElement(d.default,{onClick:this.handleCancel_AppSetting},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.cancel"}))]:_.default.createElement("div",null,_.default.createElement(d.default,{type:"primary",onClick:this.handleCancel_AppSetting},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.determine"})),_.default.createElement(d.default,{onClick:this.handleCancel_AppSetting},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.setting.cancel"})))},_.default.createElement(y.default.Item,W,j("extend_method",{initialValue:v||"stateless_multiple",rules:[{required:!0,message:(0,E.formatMessage)({id:"componentOverview.body.setting.select"})}]})(_.default.createElement(H,{onChange:this.onChange1},A.default.getSupportComponentTyps().map(e=>{return _.default.createElement("div",{key:e.type},_.default.createElement(p.default,{style:G,value:e.type},e.name),_.default.createElement("p",{style:{color:"#999999",paddingLeft:"26px"}},e.desc))}))))))}},g=v))||g)||g);t.default=q},LzeT:function(e,t,a){e.exports={customCard:"customCard___3BuzB"}},OSFV:function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=n(a("kLXV"));a("Pwec");var i=n(a("CtXQ"));a("+L6B");var r=n(a("2/Rp")),o=l(a("q1tI")),d=a("xpXo"),c=n(a("QDog")),u=a("LLXN");class m extends o.PureComponent{constructor(e){super(e),this.state={list:[],loading:!0}}componentDidMount(){this.loadData()}loadData(){(0,d.getHistoryLog)({team_name:c.default.getCurrTeamName(),app_alias:this.props.appAlias}).then(e=>{e&&this.setState({loading:!1,list:e.list||[]})})}render(){var e=this.state,t=e.loading,a=e.list;return o.default.createElement(s.default,{title:o.default.createElement(u.FormattedMessage,{id:"componentOverview.body.tab.log.HistoryLog.title"}),visible:!0,width:700,onCancel:this.props.onCancel,footer:[o.default.createElement(r.default,{onClick:this.props.onCancel},o.default.createElement(u.FormattedMessage,{id:"componentOverview.body.tab.log.HistoryLog.close"}))]},t?o.default.createElement("div",{style:{textAlign:"center"}},o.default.createElement(i.default,{type:"loading",style:{marginTop:100,marginBottom:100}})):"",t?"":o.default.createElement("div",{style:{textAlign:"left"}},a.length>0?o.default.createElement("div",null,a.map(e=>{return o.default.createElement("p",{key:e.file_name},o.default.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:e.file_url},e.file_name))})):o.default.createElement("p",{style:{textAlign:"center"}},o.default.createElement(u.FormattedMessage,{id:"componentOverview.body.tab.log.HistoryLog.null"}))))}}t.default=m},Oz9w:function(e,t,a){e.exports={ant_form_item:"ant_form_item___IsEuZ",ant_radio_disabled:"ant_radio_disabled___26CQv",selectTabs:"selectTabs___3ppt5",update:"update___1LxKH",delete:"delete___ykGEe"}},P5R6:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAABNklEQVQ4T2P8////fwYoePv+A8PilRsZ9h0+wfD46XOwqKy0JIOTrQVDbLg/g7CgAEwpAyNM4469hxnq2icyeLnaM/h7uTCoKcuDFd26+4Bh47a9DNt2H2Roqsxn8HC2BYuDNYI0NfdOY5jR08igq6UGNxWZcfnaLYaMknqG2uIssGbGN+/e//cMTWGYO6kNRdP2vYfA+jyd7eD6QZqT86oYtq+ew8DYP33B/w8fPzE0lOei2NQ9eS6YX5qbjCLe0DmZQYCfj4HRNyrjf2NFHoOhriZRGs9fvsZQ3zGZgdHA3v//kW3LGLi5uIjS+PXbNwYbrygKNOJy6smzl8AuMDfWQ3EJ3Km4Auf1m3cMDIwMDKLCQtgDB1d07Nx/BKzB3dEGe3SAEgAozlp6p5OWAChKcuQkcgDSq8inQDppLQAAAABJRU5ErkJggg=="},Pp4N:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV"));a("T2oS");var i=l(a("W9HT"));a("IzEo");var r=l(a("bx4M")),o=l(a("jehZ"));a("O3gP");var d=l(a("lrIw"));a("5NDa");var c=l(a("5rEg"));a("fOrg");var u=l(a("+KLJ"));a("+L6B");var m=l(a("2/Rp"));a("y8nQ");var p,f,h,g,v=l(a("Vl3Y")),y=n(a("q1tI")),b=a("MuoO"),_=l(a("LzeT")),E=l(a("e6Ls")),w=l(a("UTiu")),M=a("LLXN"),C=v.default.Item,S=(p=v.default.create(),f=(0,b.connect)(e=>{var t=e.user,a=e.appControl,l=e.loading;return{currUser:t.currentUser,appDetail:a.appDetail,addLoading:l.effects["monitor/addServiceMonitorFigure"],editLoading:l.effects["monitor/editServiceMonitorFigure"]}}),p(h=f((g=class extends y.PureComponent{constructor(e){super(e),this.fetchComponentMetrics=(()=>{var e=this.props,t=e.dispatch,a=e.serviceId,l=e.teamName,n=e.appAlias;t({type:"monitor/fetchComponentMetrics",payload:{team_name:l,service_alias:n,serviceId:a},callback:e=>{var t=e.list.map(e=>e.metric);this.setState({indicators:t})}})}),this.onOk=(e=>{e.preventDefault();var t=this.props,a=t.form,l=t.onOk;a.validateFields({force:!0},(e,t)=>{!e&&l&&l(t)})}),this.handleSearch=(()=>{var e=this.props.form;e.validateFields({force:!0},(e,t)=>{e||this.setState({RangeData:[t],isRender:!0},()=>{this.setState({isRender:!1})})})}),this.handleSubmitDelete=(()=>{this.cancalDelete()}),this.state={indicators:[],RangeData:this.props.info.graph_id?[this.props.info]:[],loading:!1,isRender:!1}}componentDidMount(){this.fetchComponentMetrics()}render(){var e=this.props,t=e.form,a=e.onCancel,l=e.dispatch,n=e.appDetail,p=e.appAlias,f=e.info,h=void 0===f?{}:f,g=e.addLoading,b=e.editLoading,S=t.getFieldDecorator,O=this.state,k=O.loading,A=O.indicators,x=O.RangeData,D=O.isRender,F={moduleName:"CustomMonitor",start:(new Date).getTime()/1e3-3600,end:(new Date).getTime()/1e3,dispatch:l,appDetail:n,appAlias:p};return y.default.createElement(s.default,{title:h&&h.ID?y.default.createElement(M.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitoring.editChart"}):y.default.createElement(M.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitoring.addChart"}),visible:!0,width:600,confirmLoading:k,className:E.default.TelescopicModal,onCancel:a,onOk:this.onOk,footer:[y.default.createElement(m.default,{style:{marginTop:"10px"},onClick:a},y.default.createElement(M.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitoring.cancel"})),y.default.createElement(m.default,{style:{marginTop:"10px"},type:"primary",loading:g||b,onClick:this.onOk},h&&h.graph_id?y.default.createElement(M.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitoring.preservation"}):y.default.createElement(M.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitoring.add"}))]},y.default.createElement(y.Fragment,null,y.default.createElement(v.default,{onSubmit:this.onOk},y.default.createElement(i.default,{spinning:k},y.default.createElement(u.default,{style:{marginBottom:"10px"},message:y.default.createElement(M.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitoring.input"}),type:"info",showIcon:!0}),y.default.createElement(r.default,{className:_.default.customCard,headStyle:{padding:"0 24px"},title:y.default.createElement(C,null,S("title",{initialValue:h.title||"",rules:[{required:!0,message:(0,M.formatMessage)({id:"componentOverview.body.tab.monitor.CustomMonitoring.title"})},{max:64,message:(0,M.formatMessage)({id:"componentOverview.body.tab.monitor.CustomMonitoring.max"})}]})(y.default.createElement(c.default,{style:{width:"calc(100% - 15px)"},placeholder:(0,M.formatMessage)({id:"componentOverview.body.tab.monitor.CustomMonitoring.title"})})))},y.default.createElement("div",null,y.default.createElement(C,null,S("promql",{initialValue:h.promql||"",rules:[{required:!0,message:(0,M.formatMessage)({id:"componentOverview.body.tab.monitor.CustomMonitoring.queryCriteria"})},{max:255,message:(0,M.formatMessage)({id:"componentOverview.body.tab.monitor.CustomMonitoring.maxLength"})}]})(y.default.createElement(d.default,{style:{width:"calc(100% - 75px)",marginRight:"5px"},dataSource:A,filterOption:(e,t)=>-1!==t.props.children.toUpperCase().indexOf(e.toUpperCase()),placeholder:(0,M.formatMessage)({id:"componentOverview.body.tab.monitor.CustomMonitoring.queryCriteria"})})),y.default.createElement(m.default,{onClick:this.handleSearch},y.default.createElement(M.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitoring.query"}))),y.default.createElement("div",{style:{minHeight:"300px"}},x.length>0&&x.map(e=>{var t=e.title,a=e.promql;return y.default.createElement(w.default,(0,o.default)({moduleName:"CustomMonitor",isEdit:!1,key:t,isRender:D},F,{title:t,type:a}))}))))))))}},h=g))||h)||h);t.default=S},QKd8:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAALCAYAAABGbhwYAAAAoUlEQVQoU9WQMQrEIBBFv6QJpk5t5VGEXCBFriDY5RIeICmtBQv7QK4iWAW8gxgMu4GwucBO9WfmMfz5pJRSAOA4DmzbVuVVlFKM43j3xDlX9n3Hh78XX0EIgRACpF6UUiLn/APVQdM0WNf1CU7TBGst2rbFMAzw3r+DSiksy4Ku6y5/xpj/BRljiDGiZtf3PVJKz2e01gghvObIOcc8zzgBRWqW6sMFhjYAAAAASUVORK5CYII="},SgVc:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV"));a("14J3");var i=l(a("BMrR"));a("jCWc");var r=l(a("kPKH")),o=l(a("jehZ"));a("5NDa");var d=l(a("5rEg"));a("OaEy");var c=l(a("2fM7"));a("y8nQ");var u,m,p,f=l(a("Vl3Y")),h=n(a("q1tI")),g=a("LLXN"),v=f.default.Item,y=(c.default.Option,d.default.TextArea,u=f.default.create(),u((p=class extends h.PureComponent{constructor(e){super(e),this.handleSubmit=(e=>{e.preventDefault(),this.props.form.validateFields({force:!0},(e,t)=>{e||this.props.onOk&&this.props.onOk(t)})}),this.handleCancel=(()=>{this.props.onCancel&&this.props.onCancel()}),this.state={}}render(){var e=this.props.form,t=e.getFieldDecorator,a=(e.getFieldValue,{labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}});return h.default.createElement(s.default,{title:h.default.createElement(g.FormattedMessage,{id:"omponentOverview.body.SubDomain.title"}),onOk:this.handleSubmit,visible:!0,onCancel:this.handleCancel},h.default.createElement(i.default,{gutter:24},h.default.createElement(r.default,{className:"gutter-row",span:12},h.default.createElement(f.default,{onSubmit:this.handleSubmit},h.default.createElement(v,(0,o.default)({},a,{l:!0,label:h.default.createElement(g.FormattedMessage,{id:"omponentOverview.body.SubDomain.domain"})}),t("domain",{rules:[{required:!0,message:(0,g.formatMessage)({id:"componentOverview.body.SubDomain.required"})},{pattern:/^[0-9a-zA-Z.]*$/,message:(0,g.formatMessage)({id:"componentOverview.body.SubDomain.pattern"})}]})(h.default.createElement(d.default,{placeholder:(0,g.formatMessage)({id:"componentOverview.body.SubDomain.placeholder"})}))))),h.default.createElement(r.default,{className:"gutter-row",span:12,style:{lineHeight:"36px"}},".",this.props.sld_suffix)))}},m=p))||m);t.default=y},Szue:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("g9YV");var i=l(a("wCAj"));a("Pwec");var r=l(a("CtXQ"));a("/xke");var o=l(a("TeRw"));a("2qtc");var d=l(a("kLXV"));a("+L6B");var c,u,m,p=l(a("2/Rp")),f=a("MuoO"),h=a("7DNP"),g=n(a("q1tI")),v=l(a("8hm0")),y=l(a("MXRY")),b=l(a("cUW5")),_=l(a("puxM")),E=a("xpXo"),w=l(a("QDog")),M=a("LLXN");class C extends g.PureComponent{render(){var e=this.props,t=e.appAlias,a=e.onCancel;return g.default.createElement(d.default,{title:g.default.createElement(M.FormattedMessage,{id:"componentOverview.body.Relation.ViewRelationInfo.title"}),width:1e3,visible:!0,onCancel:a,footer:[g.default.createElement(p.default,{onClick:a},g.default.createElement(M.FormattedMessage,{id:"componentOverview.body.Relation.ViewRelationInfo.close"}))]},g.default.createElement(y.default,{title:"",type:"OuterEnvs",autoQuery:!0,appAlias:t}))}}var S=(c=(0,f.connect)(null,null,null,{withRef:!0}),c((m=class extends g.PureComponent{constructor(e){super(e),this.onViewRelationInfo=(e=>{this.setState({viewRelationInfo:e})}),this.onPageChange=(e=>{this.setState({page:e},()=>{this.loadRelationedApp()})}),this.loadRelationedApp=(()=>{var e=this.state,t=e.page,a=e.pageSize;(0,E.getRelationedApp)({team_name:w.default.getCurrTeamName(),app_alias:this.props.appAlias,page:t,pageSize:a}).then(e=>{if(e){var t=e.bean.port_list;e.list&&e.list.length>0&&e.list.map(e=>{var a=e.ports_list;return t=t.concat(a),e}),t=this.isRepeat(t),this.setState({relationList:e.list||[],showText:t,total:e.bean.total})}})}),this.isRepeat=(e=>{var t={};for(var a in e){if(t[e[a]])return!0;t[e[a]]=!0}return!1}),this.showAddRelation=(()=>{this.setState({showAddRelation:!0})}),this.handleCancelAddRelation=(()=>{this.setState({showAddRelation:!1})}),this.handleSubmitAddRelation=(e=>{(0,E.batchAddRelationedApp)({team_name:w.default.getCurrTeamName(),app_alias:this.props.appAlias,dep_service_ids:e}).then(e=>{e&&(o.default.info({message:(0,M.formatMessage)({id:"notification.hint.toUpdata"})}),this.loadRelationedApp(),this.handleCancelAddRelation())})}),this.handleRemoveRelationed=(e=>{(0,E.removeRelationedApp)({team_name:w.default.getCurrTeamName(),app_alias:this.props.appAlias,dep_service_id:e.service_id}).then(e=>{e&&this.loadRelationedApp()})}),this.cancelViewRelationInfo=(()=>{this.setState({viewRelationInfo:null})}),this.state={showAddRelation:!1,relationList:[],viewRelationInfo:null,showText:null,page:1,pageSize:8,total:0}}componentDidMount(){this.loadRelationedApp()}shouldComponentUpdate(){return!0}canView(){var e=this.props.componentPermissions.isRely;return e}render(){var e=this.state,t=e.showText,a=e.relationList,l=this.props.appAlias;return this.canView()?g.default.createElement(g.Fragment,null,g.default.createElement(y.default,{title:g.default.createElement(M.FormattedMessage,{id:"componentOverview.body.Relation.EnvironmentVariable.title"}),type:"Outer",autoQuery:!0,appAlias:l}),g.default.createElement(s.default,{title:[g.default.createElement("span",null,g.default.createElement(M.FormattedMessage,{id:"componentOverview.body.Relation.EnvironmentVariable.information"})),g.default.createElement("span",{style:{color:"red"}},t&&(0,M.formatMessage)({id:"componentOverview.body.Relation.EnvironmentVariable.conflict"}))],extra:g.default.createElement(p.default,{onClick:this.showAddRelation},g.default.createElement(r.default,{type:"plus"})," ",g.default.createElement(M.FormattedMessage,{id:"componentOverview.body.Relation.EnvironmentVariable.add"})),style:{borderRadius:5}},g.default.createElement(_.default,{sm:650},g.default.createElement(i.default,{pagination:this.state.total>this.state.pageSize&&{current:this.state.page,pageSize:this.state.pageSize,total:this.state.total,onChange:this.onPageChange},columns:[{title:(0,M.formatMessage)({id:"componentOverview.body.Relation.table.service_cname"}),dataIndex:"service_cname",render:(e,t)=>g.default.createElement(h.Link,{to:"/team/".concat(w.default.getCurrTeamName(),"/region/").concat(w.default.getCurrRegionName(),"/components/").concat(t.service_alias,"/overview")},e)},{title:(0,M.formatMessage)({id:"componentOverview.body.Relation.table.group_name"}),dataIndex:"group_name",render:(e,t)=>g.default.createElement(h.Link,{to:"/team/".concat(w.default.getCurrTeamName(),"/region/").concat(w.default.getCurrRegionName(),"/apps/").concat(t.group_id)},e)},{title:(0,M.formatMessage)({id:"componentOverview.body.Relation.table.operation"}),dataIndex:"var",render:(e,t)=>g.default.createElement(g.Fragment,null,g.default.createElement("a",{onClick:()=>this.onViewRelationInfo(t),href:"javascript:;",style:{margintRight:10}},g.default.createElement(M.FormattedMessage,{id:"componentOverview.body.Relation.table.connection"})),g.default.createElement("a",{onClick:()=>{this.handleRemoveRelationed(t)},href:"javascript:;",style:{margintRight:10}},g.default.createElement(M.FormattedMessage,{id:"componentOverview.body.Relation.table.cancel"})))}],dataSource:a}))),this.state.showAddRelation&&g.default.createElement(v.default,{appAlias:this.props.appAlias,onCancel:this.handleCancelAddRelation,onSubmit:this.handleSubmitAddRelation}),this.state.viewRelationInfo&&g.default.createElement(C,{appAlias:this.state.viewRelationInfo.service_alias,onCancel:this.cancelViewRelationInfo})):g.default.createElement(b.default,null)}},u=m))||u);t.default=S},UJxd:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("R9oj");var i=l(a("ECub"));a("5Dmo");var r=l(a("3S7+"));a("bbsP");var o=l(a("/wGt"));a("BoS7");var d=l(a("Sdc0"));a("5NDa");var c=l(a("5rEg"));a("14J3");var u=l(a("BMrR"));a("jCWc");var m=l(a("kPKH"));a("+L6B");var p=l(a("2/Rp"));a("Pwec");var f=l(a("CtXQ"));a("/xke");var h=l(a("TeRw"));a("y8nQ");var g=l(a("Vl3Y"));a("OaEy");var v,y,b,_,E=l(a("2fM7")),w=n(a("q1tI")),M=a("MuoO"),C=a("LLXN"),S=a("xpXo"),O=l(a("48xL")),k=l(a("QDog")),A=l(a("q76B")),x=l(a("v65o")),D=l(a("8+Sn")),F=l(a("ZNrE")),T=E.default.Option,P=E.default.OptGroup,N=(v=g.default.create(),y=(0,M.connect)(e=>{var t=e.user,a=e.appControl;return{currUser:t.currentUser,appDetail:a.appDetail}}),v(b=y((_=class extends w.PureComponent{constructor(e){super(e),this.handleGetKubernetes=(()=>{var e=k.default.getCurrTeamName(),t=this.props.service_alias||"";(0,S.getKubernetes)({team_name:e,service_alias:t}).then(e=>{var t=[];e.list.filter((e,a)=>{return t.push(e.name)});this.setState({allData:e.list,havevalArr:t})}).catch(e=>{})}),this.onClose=(()=>{var e=this.state.drawerSwitch,t="";t="add"==e?"change":"add",this.setState({visible:!1,drawerSwitch:t})}),this.addAttribute=(e=>{var t=this.state;t.selectArr,t.havevalArr;this.setState({visible:!0,drawerTitle:(0,C.formatMessage)({id:"componentOverview.body.Kubernetes.add"}),drawerSwitch:e,selectVal:void 0,jsonValue:"",strValue:""})}),this.changeBtn=((e,t,a)=>{var l=this.state,n=l.allData,s=l.TooltipValueArr;"yaml"==e.save_type?this.setState({yamlValue:e.attribute_value}):"json"==e.save_type?this.setState({jsonValue:e.attribute_value}):"string"==e.save_type&&this.setState({strValue:e.attribute_value}),this.setState({minArr:n[a],visible:!0,drawerTitle:(0,C.formatMessage)({id:"componentOverview.body.Kubernetes.edit_attribute"}),drawerSwitch:t,selectVal:e.name,TooltipValue:s[e.name]})}),this.deleteBtn=((e,t)=>{var a=this.state.selectVal,l=k.default.getCurrTeamName(),n=this.props.service_alias||"";(0,S.deleteKubernetes)({team_name:l,service_alias:n,value_name:a}).then(e=>{e&&e.response_data&&200==e.response_data.code&&(this.setState({showDeletePort:!this.state.showDeletePort}),h.default.success({message:(0,C.formatMessage)({id:"notification.success.attribute_delete"})}),this.handleGetKubernetes())})}),this.cancalDeletePort=(e=>{null!=e?this.setState({selectVal:e.name,showDeletePort:!this.state.showDeletePort}):this.setState({showDeletePort:!this.state.showDeletePort})}),this.handleChange=(e=>{var t=this.state,a=(t.selectVal,t.TooltipValueArr);this.setState({selectVal:e,yamlValue:a[e],TooltipValue:a[e]})}),this.notificationFun=(()=>{h.default.error({message:(0,C.formatMessage)({id:"componentOverview.body.Kubernetes.null"})})}),this.handleSubmit=(e=>{e.preventDefault();var t=this.state,a=t.selectVal,l=(t.drawerSwitch,t.minArr,t.TooltipValue),n=this.props,s=n.form;n.dispatch,k.default.getCurrTeamName(),this.props.service_alias;s.validateFields((e,t)=>{if(!e)switch(a){case"nodeSelector":if(t.nodeSelector[0].key&&t.nodeSelector[0].value){var n={name:a,save_type:"json",attribute_value:t.nodeSelector||[]};this.handelAddOrEdit(n)}else this.notificationFun();break;case"labels":if(t.labels[0].key&&t.labels[0].value){var s={name:a,save_type:"json",attribute_value:t.labels||[]};this.handelAddOrEdit(s)}else this.notificationFun();break;case"volumeMounts":if(null!=t.volumeMounts&&t.volumeMounts.length>0&&t.volumeMounts!=l){var i={name:a,save_type:"yaml",attribute_value:t.volumeMounts||[]};this.handelAddOrEdit(i)}else this.notificationFun();break;case"volumeClaimTemplate":if(null!=t.volumeClaimTemplate&&t.volumeClaimTemplate.length>0&&t.volumeClaimTemplate!=l){var r={name:a,save_type:"yaml",attribute_value:t.volumeClaimTemplate||[]};this.handelAddOrEdit(r)}else this.notificationFun();break;case"envFromSource":if(null!=t.envFromSource&&t.envFromSource.length>0&&t.envFromSource!=l){var o={name:a,save_type:"yaml",attribute_value:t.envFromSource||[]};this.handelAddOrEdit(o)}else this.notificationFun();break;case"volumes":if(null!=t.volumes&&t.volumes.length>0&&t.volumes!=l){var d={name:a,save_type:"yaml",attribute_value:t.volumes||[]};this.handelAddOrEdit(d)}else this.notificationFun();break;case"affinity":if(null!=t.affinity&&t.affinity.length>0){var c={name:a,save_type:"yaml",attribute_value:t.affinity||[]};this.handelAddOrEdit(c)}else this.notificationFun();break;case"tolerations":if(null!=t.tolerations&&t.tolerations.length>0&&t.tolerations!=l){var u={name:a,save_type:"yaml",attribute_value:t.tolerations||[]};this.handelAddOrEdit(u)}else this.notificationFun();break;case"env":if(null!=t.env&&t.env.length>0&&t.env!=l){var m={name:a,save_type:"yaml",attribute_value:t.env||[]};this.handelAddOrEdit(m)}else this.notificationFun();break;case"serviceAccountName":if(null!=t.serviceAccountName&&t.serviceAccountName.length>0){var p={name:a,save_type:"string",attribute_value:t.serviceAccountName||[]};this.handelAddOrEdit(p)}else this.notificationFun();break;case"privileged":if(null!=t.privileged){var f={name:a,save_type:"string",attribute_value:"".concat(t.privileged)||"false"};this.handelAddOrEdit(f)}else this.notificationFun();break;case"shareProcessNamespace":if(null!=t.shareProcessNamespace){var h={name:a,save_type:"string",attribute_value:"".concat(t.shareProcessNamespace)||"false"};this.handelAddOrEdit(h)}else this.notificationFun();break;case"dnsPolicy":if(null!=t.dnsPolicy){var g={name:a,save_type:"string",attribute_value:"".concat(t.dnsPolicy)||"false"};this.handelAddOrEdit(g)}else this.notificationFun();break;case"dnsConfig":if(null!=t.dnsConfig&&t.dnsConfig.length>0&&t.dnsConfig!=l){var v={name:a,save_type:"yaml",attribute_value:"".concat(t.dnsConfig)||[]};this.handelAddOrEdit(v)}else this.notificationFun();break;case"hostIPC":if(null!=t.hostIPC){var y={name:a,save_type:"string",attribute_value:"".concat(t.hostIPC)||"false"};this.handelAddOrEdit(y)}else this.notificationFun();break;case"resources":if(null!=t.resources&&t.resources.length>0&&t.resources!=l){var b={name:a,save_type:"yaml",attribute_value:"".concat(t.resources)||[]};this.handelAddOrEdit(b)}else this.notificationFun();break;case"lifecycle":if(null!=t.lifecycle&&t.lifecycle.length>0&&t.lifecycle!=l){var _={name:a,save_type:"yaml",attribute_value:"".concat(t.lifecycle)||[]};this.handelAddOrEdit(_)}else this.notificationFun();break}})}),this.handleCancel=(()=>{this.setState({visible:!1})}),this.handelAddOrEdit=(e=>{var t=k.default.getCurrTeamName(),a=this.props.service_alias||"",l=this.state,n=l.selectVal,s=l.drawerSwitch;"add"==s?(0,S.addKubernetes)({team_name:t,service_alias:a,value_name:n,attribute:e}).then(e=>{e&&e.response_data&&200==e.response_data.code&&(h.default.success({message:(0,C.formatMessage)({id:"notification.success.attribute_add"})}),this.handleGetKubernetes()),this.setState({visible:!1})}):"change"==s&&(0,S.editKubernetes)({team_name:t,service_alias:a,value_name:n,attribute:e}).then(e=>{e&&e.response_data&&200==e.response_data.code&&(h.default.success({message:(0,C.formatMessage)({id:"notification.success.attribute_edit"})}),this.handleGetKubernetes()),this.setState({visible:!1})})}),this.state={allData:[],minArr:{},visible:!1,drawerTitle:(0,C.formatMessage)({id:"componentOverview.body.Kubernetes.add"}),selectArr:["nodeSelector","labels","volumes","volumeMounts","affinity","tolerations","serviceAccountName","privileged","env","shareProcessNamespace","dnsPolicy","hostIPC","resources","lifecycle","dnsConfig","volumeClaimTemplate","envFromSource"],selectVal:void 0,havevalArr:[],drawerSwitch:"add",jsonValue:"",yamlValue:"",strValue:"",showDeletePort:!1,TooltipValueArr:{affinity:"#sample\n#nodeAffinity:\n#      preferredDuringSchedulingIgnoredDuringExecution:\n#      - weight: 1\n#        preference:\n#          matchExpressions:\n#          - key: disktype\n#            operator: In\n#            values:\n#           - ssd\n",tolerations:'#sample\n#- key: "test"\n#  operator: "Equal"\n#  value: "yk"\n#  effect: "NoSchedule"\n',env:"#sample\n#- name: NGINX_USERNAEM\n#  valueFrom:\n#    secretKeyRef:\n#      key: username\n#      name: test-secret\n#      optional: false\n#- name: NGINX_PASSWORD\n#  valueFrom:\n#    secretKeyRef:\n#      key: password\n#      name: test-secret\n#      optional: false\n#- name: MY_POD_IP\n#  valueFrom:\n#   fieldRef:\n#     fieldPath: status.podIP\n",volumes:"#sample\n#- hostPath:\n#    path: /test\n#  name: data\n#- name: mydata\n#  persistentVolumeClaim:\n#    claimName: test-pvc\n#- configMap:\n#    name: test\n#  name: config\n",volumeMounts:"#sample\n#- mountPath: /opt\n#  name: data\n#- mountPath: /etc/test/conf/aa\n#  name: mydata\n#  subPath: aa\n#- mountPath: /etc/test/conf/nginx.conf\n#  name: config\n#  subPath: test.conf\n",dnsConfig:"#sample\n #nameservers:\n #searches:\n #options:\n #  - name:\n #    value: ",resources:"#sample\n#  limits:\n#    hugepages-2Mi:\n#    memory: \n#  requests:\n#    memory: ",lifecycle:"#sample\n#postStart:\n#  exec:\n#    command:\n #preStop:\n#  exec:\n#    command: ",volumeClaimTemplate:"#sample\n#- metadata: \n# name: database-data \n# spec:\n# accessModes:  \n# - ReadWriteOnce: \n# resources: \n# requests: \n# storage: ",envFromSource:"#sample\n#- configMapRef:\n#    name: \n#- secretRef:\n#    name: "},TooltipValue:"",language:"zh-CN"===D.default.get("language"),yamlShow:!1}}componentDidMount(){this.handleGetKubernetes()}render(){var e=this.props.form,t=w.default.createElement("svg",{t:"1658480171057",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1600",width:"48",height:"48"},w.default.createElement("path",{d:"M354.40128 0c-87.04 0-157.44 70.55872-157.44 157.59872v275.68128H78.72c-21.6576 0-39.36256 17.69984-39.36256 39.36256v236.31872c0 21.6576 17.69984 39.35744 39.36256 39.35744h118.24128v118.08256c0 87.04 70.4 157.59872 157.44 157.59872h472.63744c87.04 0 157.59872-70.55872 157.59872-157.59872V315.0336c0-41.74848-38.9888-81.93024-107.52-149.27872l-29.11744-29.12256L818.87744 107.52C751.5392 38.9888 711.39328 0 669.59872 0H354.4064z m0 78.72h287.20128c28.35456 7.0912 27.99616 42.1376 27.99616 76.8v120.16128c0 21.6576 17.69984 39.35744 39.36256 39.35744h118.07744c39.38816 0 78.87872-0.0256 78.87872 39.36256v512c0 43.32032-35.55328 78.87872-78.87872 78.87872H354.4064c-43.32544 0-78.72-35.5584-78.72-78.87872v-118.08256h393.91744c21.66272 0 39.36256-17.69472 39.36256-39.35744V472.64256c0-21.66272-17.69984-39.36256-39.36256-39.36256H275.68128V157.59872c0-43.32032 35.39456-78.87872 78.72-78.87872zM261.2736 506.39872h20.16256l65.28 176.64h-23.04l-19.2-54.71744h-65.28l-19.2 54.71744h-23.04l64.31744-176.64z m-181.43744 0.96256h23.99744l40.32 89.27744 41.28256-89.27744h23.99744l-53.76 107.52v68.15744h-22.07744v-67.2l-53.76-108.47744z m290.87744 0h32.64l49.92 143.03744h0.96256l48.95744-143.03744h33.60256v175.67744h-22.08256v-106.55744c0-10.88 0.32256-26.56256 0.96256-47.04256h-0.96256l-52.79744 153.6h-19.2l-52.80256-153.6h-0.95744c1.28 22.4 1.92 38.72256 1.92 48.96256v104.63744h-20.16256V507.36128z m214.08256 0h22.07744v155.52h69.12v20.15744H584.8064V507.36128z m-312.96 23.04c-1.92 8.96-4.80256 18.23744-8.64256 27.83744l-17.28 50.88256h51.84l-18.23744-50.88256c-3.84-10.88-6.4-20.15744-7.68-27.83744z","p-id":"1601","data-spm-anchor-id":"a313x.7781069.0.i0",class:"selected",fill:"#707070"})),a=this.state,l=a.drawerTitle,n=a.selectArr,h=a.selectVal,v=a.havevalArr,y=a.drawerSwitch,b=(a.type,a.allData),_=a.jsonValue,M=a.yamlValue,S=a.strValue,k=(a.boolvalue,a.TooltipValue),D=a.language,N=e.getFieldDecorator,R=e.setFieldsValue,I="add"==y,L=[],V=[];n.map((e,t)=>{return 1==v.includes(e)&&L.push(e),L}),n.map((e,t)=>{return 0==v.includes(e)&&V.push(e),V});var B=["Default","ClusterFirst","ClusterFirstWithHostNet","None"],H={labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},q={labelCol:{xs:{span:8},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16}}};return w.default.createElement("div",null,w.default.createElement(s.default,{title:w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.attribute"}),style:{marginBottom:"24px"},extra:w.default.createElement(p.default,{onClick:()=>this.addAttribute("add")},w.default.createElement(f.default,{type:"plus"}),w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.add"}))},w.default.createElement(o.default,{title:l,placement:"right",closable:!1,onClose:this.onClose,visible:this.state.visible,width:500},w.default.createElement("div",{className:x.default.selectstyle},w.default.createElement(u.default,null,w.default.createElement(m.default,{span:D?4:6},w.default.createElement("p",{style:D?{}:{whiteSpace:"nowrap",fontWeight:600,marginTop:5}},w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.name"}))),w.default.createElement(m.default,{span:D?20:18},w.default.createElement(E.default,{style:{width:220},onChange:this.handleChange,placeholder:(0,C.formatMessage)({id:"componentOverview.body.Kubernetes.choice"}),disabled:"change"===y,value:h},w.default.createElement(P,{label:w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.added"})},V.map((e,t)=>{return w.default.createElement(T,{key:t,value:e},e)})),w.default.createElement(P,{label:w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.Cannot"})},L.map((e,t)=>{return w.default.createElement(T,{key:t,value:e,disabled:!0},e)}))))),w.default.createElement(g.default,{onSubmit:this.handleSubmit},h&&("nodeSelector"==h||"labels"==h)&&w.default.createElement(g.default.Item,q,w.default.createElement("div",{style:D?{width:"100%"}:{marginLeft:38,width:"100%"}},w.default.createElement("p",{style:{whiteSpace:"nowrap"}},w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.key"})),w.default.createElement("div",{className:x.default.nodeSelector_sytle},N("".concat(h),{initialValue:_||[],rules:[{required:!1,message:(0,C.formatMessage)({id:"componentOverview.body.Kubernetes.msg"},{selectVal:h})}]})(w.default.createElement(O.default,{setspan:12}))))),h&&"dnsPolicy"==h&&w.default.createElement(g.default.Item,q,w.default.createElement("div",{style:D?{}:{marginLeft:38}},w.default.createElement("p",{style:{whiteSpace:"nowrap",paddingBottom:5}},(0,C.formatMessage)({id:"componentOverview.body.Kubernetes.dnsPolicy"})),N("".concat(h),{initialValue:S||!1,rules:[{required:!1}]})(w.default.createElement(E.default,{placeholder:(0,C.formatMessage)({id:"componentOverview.body.Kubernetes.dnsPolicy"}),style:{width:220,marginLeft:56},onSelect:this.dnsPolicyYamlShow},B.map((e,t)=>{return w.default.createElement(T,{key:t,value:e},e)}))))),h&&("volumeMounts"==h||"volumes"==h||"affinity"==h||"tolerations"==h||"env"==h||"volumeClaimTemplate"==h||"dnsConfig"==h||"resources"==h||"lifecycle"==h||"envFromSource"==h)&&w.default.createElement(w.default.Fragment,null,w.default.createElement("p",{style:{padding:"10px 0"}}," ","dnsConfig"==h?(0,C.formatMessage)({id:"componentOverview.body.Kubernetes.onlyDnsPolicy"}):" "),w.default.createElement(F.default,{setFieldsValue:R,formItemLayout:H,Form:g.default,style:{marginBottom:"20px"},getFieldDecorator:N,name:h,message:w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.content"}),data:M||"",mode:"yaml",bool:I,TooltipValue:k})),h&&"serviceAccountName"==h&&w.default.createElement(g.default.Item,q,w.default.createElement("div",{style:D?{}:{marginLeft:38}},w.default.createElement("p",{style:{whiteSpace:"nowrap"}},w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.input"})),w.default.createElement("div",{className:D?x.default.accountName_style:x.default.en_accountName_style},N("".concat(h),{initialValue:S||"",rules:[{required:!1,message:(0,C.formatMessage)({id:"componentOverview.body.Kubernetes.input"})}]})(w.default.createElement(c.default,{placeholder:(0,C.formatMessage)({id:"componentOverview.body.Kubernetes.input"})}))))),h&&("privileged"==h||"shareProcessNamespace"==h||"hostIPC"==h)&&w.default.createElement(g.default.Item,q,w.default.createElement("div",{style:D?{}:{marginLeft:38}},w.default.createElement("p",{style:{whiteSpace:"nowrap"}},w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.privileged",values:{type:h}})),N("".concat(h),{initialValue:S||!1,rules:[{required:!1}]})(w.default.createElement(d.default,{defaultChecked:S||!1,style:{margin:"20px 0  0 50px"}})))))),w.default.createElement("div",{className:x.default.handleBtn_style},w.default.createElement(p.default,{style:{marginRight:"10px"},onClick:this.handleCancel},w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.Cancel"})),w.default.createElement(p.default,{type:"primary",onClick:this.handleSubmit},w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.Confirm"})))),w.default.createElement("div",{className:x.default.pageValue_style},b&&b.length>0?b.map((e,a)=>{return w.default.createElement(u.default,{key:a},"volumes"==e.name||"volumeMounts"==e.name||"volumeClaimTemplate"==e.name||"affinity"==e.name||"tolerations"==e.name||"env"==e.name||"dnsConfig"==e.name||"resources"==e.name||"lifecycle"==e.name||"envFromSource"==e.name?w.default.createElement(m.default,{span:4,className:x.default.yamlTitle_style},e.name,":"):w.default.createElement(m.default,{span:4},e.name,":"),w.default.createElement(m.default,{span:18},e.name&&("nodeSelector"==e.name||"labels"==e.name)&&e.attribute_value.length>0&&e.attribute_value.map((e,t)=>{return w.default.createElement(r.default,{key:t,placement:"top",title:w.default.createElement("div",null,w.default.createElement("p",null,"Key: ",e.key),w.default.createElement("p",null,"Value: ",e.value))},w.default.createElement("div",{className:x.default.tipText_style},w.default.createElement("span",null,e.key),w.default.createElement("span",null,e.value)))}),e.name&&("volumes"==e.name||"volumeMounts"==e.name||"volumeClaimTemplate"==e.name||"affinity"==e.name||"tolerations"==e.name||"env"==e.name||"dnsConfig"==e.name||"resources"==e.name||"lifecycle"==e.name||"envFromSource"==e.name)&&e.attribute_value.length>0&&w.default.createElement("div",{className:x.default.yamlValue_style},t," \xa0\xa0\xa0\xa0",w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.yaml"})),e.name&&"serviceAccountName"==e.name&&e.attribute_value.length>0&&w.default.createElement("div",{style:{padding:"10px 15px",backgroundColor:"#f0f4f8",borderRadius:"10px"}},w.default.createElement(r.default,{key:a,placement:"top",title:e.attribute_value},e.attribute_value)),e.name&&("privileged"==e.name||"shareProcessNamespace"==e.name||"hostIPC"==e.name)&&e.attribute_value.length>0&&w.default.createElement("span",{style:{paddingTop:"6px"}},w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.current"}),"true"==e.attribute_value?w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.Opened"}):w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.Closed"})),e.name&&"dnsPolicy"==e.name&&e.attribute_value.length>0&&w.default.createElement("span",{style:{paddingTop:"6px"}}," ",(0,C.formatMessage)({id:"componentOverview.body.Kubernetes.is"})," ",e.attribute_value," ")),w.default.createElement(m.default,{span:2},w.default.createElement("span",{onClick:()=>this.changeBtn(e,"change",a)},w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.edit"})),"\xa0\xa0\xa0\xa0",w.default.createElement("span",{onClick:()=>this.cancalDeletePort(e)},w.default.createElement(C.FormattedMessage,{id:"componentOverview.body.Kubernetes.deldete"}))))}):w.default.createElement(i.default,{image:i.default.PRESENTED_IMAGE_SIMPLE})),this.state.showDeletePort&&w.default.createElement(A.default,{title:w.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.attribute.title"}),desc:w.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.attribute.desc"}),subDesc:w.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.attribute.subDesc"}),onOk:this.deleteBtn,onCancel:this.cancalDeletePort})))}},b=_))||b)||b),R=N;t.default=R},UTiu:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var s=l(a("W9HT"));a("IzEo");var i=l(a("bx4M"));a("/xke");var r,o,d,c=l(a("TeRw")),u=l(a("p0pE")),m=l(a("QDog")),p=l(a("YM/Z")),f=a("yP6+"),h=a("MuoO"),g=l(a("wd/R")),v=n(a("q1tI")),y=a("LLXN"),b=l(a("YUe+")),_=(r=(0,h.connect)(e=>{var t=e.application;return{curAppDetail:t.groupDetail}}),r((d=class extends v.PureComponent{constructor(e){var t;super(e),t=this,this.loadPerformanceAnalysis=function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.setState({loading:!0});var l=e.dispatch,n=e.appAlias;l({type:"appControl/fetchPerformanceAnalysis",payload:Object.assign({},t.handleParameter(e,a),{app_alias:n}),callback:e=>{t.setState({loading:!1}),e.bean&&e.bean.result&&e.bean.result.length>0&&t.setState({memoryRange:e.bean.result,performanceObj:e.bean})}})},this.loadRangeData=(e=>{this.setState({loading:!0});var t=e.appDetail,a=e.dispatch;a({type:"monitor/getMonitorRangeData",payload:Object.assign({},this.handleParameter(e),{componentAlias:t.service.service_alias}),callback:e=>{this.setState({loading:!1}),e.bean&&e.bean.result&&e.bean.result.length>0&&this.setState({memoryRange:e.bean.result})}})}),this.handleParameter=function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=e.moduleName,n=e.type,s=e.start,i=e.end;return{query:"CustomMonitor"===l?n:t.getQueryByType(n),start:a?(new Date).getTime()/1e3-3600:s,end:a?(new Date).getTime()/1e3:i,step:Math.ceil((i-s)/100)||15,teamName:m.default.getCurrTeamName(),disable_auto_label:!0}},this.getQueryByType=(e=>{var t=this.props,a=t.appDetail,l=t.baseInfo;if(a&&a.service){var n=a.service,s=n.service_id,i=(n.service_alias,n.k8s_component_name),r=this.props.curAppDetail.k8s_app;m.default.isStateComponent(l&&l.extend_method);switch(e){case"containerMem":return'sum(container_memory_rss{name=~".*'.concat(r,"-").concat(i,'.*"}/1024/1024) by (pod, namespace)');case"containerCpu":return'sum(irate(container_cpu_usage_seconds_total{name=~".*'.concat(r,"-").concat(i,'.*"}[5m])*100)by(pod,namespace)');case"containerNetR":return'rate(container_network_receive_bytes_total{name=~".*'.concat(r,"-").concat(i,'.*"}[1m])/1024');case"containerNetT":return'rate(container_network_transmit_bytes_total{name=~".*'.concat(r,"-").concat(i,'.*"}[1m])/1024');case"responseTime":return'ceil(avg(app_requesttime{mode="avg",service_id="'.concat(s,'"}))');case"throughput":return'sum(ceil(increase(app_request{service_id="'.concat(s,'",method="total"}[1m])/12))');case"numberOnline":return'max(app_requestclient{service_id="'.concat(s,'"})');default:return""}}return""}),this.getMeta=(()=>{var e=this.props,t=e.type,a=e.title,l=e.moduleName;if("CustomMonitor"===l)return{title:a,label:a,unit:""};switch(t){case"containerMem":return{title:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.containerMem.title"}),label:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.containerMem.label"}),unit:" MB"};case"containerCpu":return{title:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.containerCpu.title"}),label:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.containerCpu.label"}),unit:"%"};case"containerNetR":return{title:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.containerNetR.title"}),label:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.containerNetR.label"}),unit:" KB/s"};case"containerNetT":return{title:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.containerNetT.title"}),label:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.containerNetT.label"}),unit:" KB/s"};case"responseTime":return{title:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.responseTime.title"}),label:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.responseTime.label"}),unit:" ms"};case"throughput":return{title:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.throughput.title"}),label:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.throughput.label"}),unit:" dps"};case"numberOnline":return{title:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.numberOnline.title"}),label:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.numberOnline.label"}),unit:""};default:return{title:"",label:"",unit:""}}}),this.converData=(e=>{var t=[];return e&&e.map(e=>{var a=Object.assign({},e.metric),l="";a&&a.__name__&&(delete a.__name__,l=e.metric.__name__+JSON.stringify(a)),a&&a.pod&&(l=e.metric.pod+JSON.stringify(a)),e.values&&e.values.map(e=>{t.push({cid:l,time:1e3*e[0],value:Math.floor(100*Number(e[1]))/100})})}),t}),this.loadRefresh=(()=>{var e=this.props.moduleName;"PerformanceAnalysis"===e||"CustomMonitor"===e?this.loadPerformanceAnalysis(this.props,!0):this.loadRangeData(this.props)}),this.handleSubmit=(e=>{var t=this.props,a=t.dispatch,l=t.appAlias,n=t.CustomMonitorInfo,s=t.upData;n&&n.graph_id&&s&&a({type:"monitor/editServiceMonitorFigure",payload:(0,u.default)({app_alias:l,team_name:m.default.getCurrTeamName()},e,{graph_id:n.graph_id,sequence:n.sequence}),callback:e=>{e&&200===e.status_code&&(c.default.success({message:(0,y.formatMessage)({id:"notification.success.save"})}),s(),this.onCancelCustomMonitoring())}})}),this.state={memoryRange:[],performanceObj:{}}}componentWillMount(){var e=this.props.moduleName;"PerformanceAnalysis"===e||"CustomMonitor"===e?this.loadPerformanceAnalysis(this.props):this.loadRangeData(this.props)}componentWillReceiveProps(e){var t=this.props,a=t.start,l=t.end,n=t.step,s=t.moduleName,i=e.start,r=e.end,o=e.step,d=e.isRender,c=a!==i||l!==r||n!==o;"CustomMonitor"===s&&c&&d&&this.loadPerformanceAnalysis(e),"PerformanceAnalysis"===s&&c?this.loadPerformanceAnalysis(e):c&&"CustomMonitor"!==s&&this.loadRangeData(e)}render(){var e=this.props,t=e.moduleName,a=e.onDelete,l=e.onEdit,n=e.CustomMonitorInfo,r=e.isEdit,o=void 0===r||r,d=this.state,c=d.memoryRange,u=d.performanceObj,m=d.loading,h="CustomMonitor"===t,_=this.getMeta(),E=_.title,w=_.label,M=_.unit,C="PerformanceAnalysis"===t?p.default.queryRangeTog2F(u,E):this.converData(c),S={time:{alias:(0,y.formatMessage)({id:"componentOverview.body.tab.monitor.history.time"}),tickCount:10,type:"time",formatter:e=>(0,g.default)(new Date(e)).locale("zh-cn").format("HH:mm")},value:{alias:{label:w},tickCount:5,formatter:e=>{return e>1e3?"".concat(e/1e3,"k"):e}},cid:{type:"cat"}};return v.default.createElement(v.Fragment,null,v.default.createElement(s.default,{spinning:m},v.default.createElement(i.default,{className:h&&b.default.rangeChart,title:E,extra:o&&v.default.createElement("div",null,h&&v.default.createElement("span",null,v.default.createElement("a",{onClick:e=>{e.preventDefault(),l(e,n)},style:{marginRight:"10px"}},v.default.createElement(y.FormattedMessage,{id:"componentOverview.body.tab.monitor.history.edit"})),v.default.createElement("a",{onClick:e=>{e.preventDefault(),a(n)},style:{marginRight:"10px"}},v.default.createElement(y.FormattedMessage,{id:"componentOverview.body.tab.monitor.history.delete"}))),v.default.createElement("a",{onClick:this.loadRefresh},v.default.createElement(y.FormattedMessage,{id:"componentOverview.body.tab.monitor.history.refresh"})))},v.default.createElement(f.Chart,{height:h?222:400,data:C,scale:S,forceFit:!0},v.default.createElement(f.Legend,{useHtml:!0,containerTpl:'<div class="g2-legend" style="position:absolute;top:20px;right:60px;width:100%;margin-top:-2px;">\n                      <h4 class="g2-legend-title"></h4>\n                      <div class='.concat(b.default.ov,'><ul class="g2-legend-list" style="list-style-type:none;margin:0;padding:0;"></ul></div>\n                    </div>\n               '),itemTpl:'\n                  <li class="g2-legend-list-item item-{index} {checked}" data-color="{originColor}" data-value="{originValue}" style="cursor: pointer;font-size: 14px;">\n                  <i class="g2-legend-marker" style="width:10px;height:10px;border-radius:50%;display:inline-block;margin-right:10px;background-color: {color};"></i>\n                  <span title={value} class="g2-legend-text" style="display:inline-block;max-width:94%;white-space:nowrap;font-size:80%;">{value}</span>\n                  </li>',"g2-legend":{overflow:"hidden",marginTop:"-2px"},"g2-legend-list":{marginTop:"-5px",border:"none",height:"50px"},"g2-legend-list-item":{display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:"center",marginRight:0}}),v.default.createElement(f.Axis,{name:"value",label:{offset:75,htmlTemplate:e=>{var t=M?"50px":"75px";return"<div \n                                title=".concat(e,'\n                                style="width:75px;display: flex;align-items: center;"\n                            >\n                              <div style="width:').concat(t,';text-align: right;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;">').concat(e,"</div>\n                              <div>").concat(M,"</div>\n                            </div>")}}}),v.default.createElement(f.Axis,{name:"time"}),v.default.createElement(f.Tooltip,{shared:!0,follow:!0,"g2-tooltip":{zIndex:99,width:"80%",overflow:"hidden"},crosshairs:{type:"y"},containerTpl:'<div class="g2-tooltip"> <p class="g2-tooltip-title"></p> <table class="g2-tooltip-list" style="display: block;width: 400px;"></table></div>',itemTpl:'<tr class="g2-tooltip-list-item" style="display: flex;justify-content: space-between;">\n                    <td style="font-size:80%;color:{color};width:90%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;">{name}</td>\n                    <td style="margin-left: 5px;">{value}</td>\n                  </tr>'}),v.default.createElement(f.Geom,{type:"line",position:"time*value",color:"cid",shape:"smooth",size:1})))))}},o=d))||o);t.default=_},WDw0:function(e,t,a){"use strict";var l=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.ResumeContext=void 0;var n=l(a("q1tI")),s=n.default.createContext("");t.ResumeContext=s},WTXe:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l={canDeploy(e){if(!e)return!1;var t=e.activeAction||[];return t.indexOf("deploy")>-1},canRestart(e){if(!e)return!1;var t=e.activeAction||[];return t.indexOf("reboot")>-1},canStart(e){if(!e)return!1;var t=e.activeAction||[];return t.indexOf("restart")>-1},canVisit(e){if(!e)return!1;var t=e.activeAction||[];return t.indexOf("visit")>-1},canStop(e){if(!e)return!1;var t=e.activeAction||[];return t.indexOf("stop")>-1},canManageDocker(e){if(!e)return!1;var t=e.activeAction||[];return t.indexOf("manage_container")>-1}},n=l;t.default=n},"X+Fk":function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=n(a("iLo2")),i=l(a("q1tI"));class r extends i.PureComponent{render(){return i.default.createElement(i.Fragment,null,i.default.createElement(s.default,{RangeData:["containerMem","containerCpu","containerNetR","containerNetT"],moduleName:"ResourceMonitoring"}))}}t.default=r},YAxI:function(e,t,a){e.exports={table:"table___32H57",label:"label___VFMAB",lr:"lr___3fcJL",ul:"ul___CpWTW",tdPadding:"tdPadding___tN2Gs"}},"YM/Z":function(e,t,a){"use strict";var l=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(a("wd/R")),s={queryTog2(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return e.result&&e.result.length&&e.result[0].value?t?t(e.result[0].value[1]):e.result[0].value[1]:0},queryRangeTog2(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];return e.result&&e.result.length&&e.result[0].values&&(t=e.result[0].values.map(e=>({x:(0,n.default)(new Date(1e3*e[0])).locale("zh-cn").format("HH:mm:ss"),y:Number(e[1]),y1:Number(e[1]),y2:Number(e[1])}))),t},queryRangeTog2F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=[];return e.result&&e.result.length&&e.result[0].values&&(a=e.result[0].values.map(e=>({cid:t,time:Number(1e3*e[0]),value:Math.round(Number(e[1]))}))),a}},i=s;t.default=i},YTVB:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV")),i=l(a("jehZ"));a("5NDa");var r=l(a("5rEg"));a("/xke");var o=l(a("TeRw"));a("OaEy");var d=l(a("2fM7"));a("y8nQ");var c,u,m,p,f=l(a("Vl3Y")),h=n(a("q1tI")),g=a("LLXN"),v=a("MuoO"),y=l(a("QDog")),b=f.default.Item,_=(d.default.Option,c=(0,v.connect)(e=>{var t=e.user,a=e.appControl,l=e.teamControl;return{currUser:t.currentUser,innerEnvs:a.innerEnvs,startProbe:a.startProbe,runningProbe:a.runningProbe,ports:a.ports,baseInfo:a.baseInfo,tags:a.tags,teamControl:l,appControl:a}},null,null,{withRef:!0}),u=f.default.create(),c(m=u((p=class extends h.PureComponent{constructor(e){super(e),this.handleSubmit=(e=>{e.preventDefault();var t=this.props,a=t.form,l=t.onSubmit,n=t.isShowRestartTips;a.validateFields((e,t)=>{e||(l&&l(t),n&&n(!0))})}),this.handleCancel=(()=>{this.props.onCancel&&this.props.onCancel()}),this.handleList=((e,t)=>{if(null==e&&null==t)return!1;var a=this.props.dispatch;a({type:"appControl/getVariableList",payload:{team_name:y.default.getCurrTeamName(),attr_name:e,attr_value:t},callback:a=>{var l=a&&a.list?a.list:[];l.unshift("".concat(e||t)),Array.from(new Set(l)),l&&l.length>0&&"null"==l[0]||(this.setState({list:l}),e&&form.setFieldsValue({attr_name:e}),t&&form.setFieldsValue({attr_value:t}))},handleError:e=>{if(e&&e.data&&10401==e.data.code)return null;e&&e.data&&e.data.msg_show&&o.default.warning({message:(0,g.formatMessage)({id:"notification.warn.error"}),description:e.data.msg_show})}})}),this.state={fontSizeVal:"",list:[]}}render(){var e=this.props.form.getFieldDecorator,t=this.props.data||"",a={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}};this.state.list;return h.default.createElement(s.default,{title:t?h.default.createElement(g.FormattedMessage,{id:"componentOverview.body.AddVarModal.edit"}):h.default.createElement(g.FormattedMessage,{id:"componentOverview.body.AddVarModal.add"}),onOk:this.handleSubmit,maskClosable:!1,onCancel:this.handleCancel,visible:!0},h.default.createElement(f.default,{onSubmit:this.handleSubmit},h.default.createElement(b,(0,i.default)({},a,{label:h.default.createElement(g.FormattedMessage,{id:"componentOverview.body.AddVarModal.name"})}),e("attr_name",{initialValue:t&&t.attr_name||"",rules:[{required:!0,message:(0,g.formatMessage)({id:"componentOverview.body.AddVarModal.input_name"})},{pattern:/[-._a-zA-Z][-._a-zA-Z0-9]/,message:(0,g.formatMessage)({id:"componentOverview.body.AddVarModal.only"})}]})(h.default.createElement(r.default,{disabled:!(!t||!t.attr_name),placeholder:(0,g.formatMessage)({id:"componentOverview.body.AddVarModal.input_name"})}))),h.default.createElement(b,(0,i.default)({},a,{label:h.default.createElement(g.FormattedMessage,{id:"componentOverview.body.AddVarModal.Variable_value"})}),e("attr_value",{initialValue:t&&t.attr_value||"",rules:[{required:!0,message:(0,g.formatMessage)({id:"componentOverview.body.AddVarModal.input_value"})}]})(h.default.createElement(r.default,{placeholder:(0,g.formatMessage)({id:"componentOverview.body.AddVarModal.input_value"})}))),h.default.createElement(b,(0,i.default)({},a,{label:"\u8bf4\u660e",label:h.default.createElement(g.FormattedMessage,{id:"componentOverview.body.AddVarModal.explain"})}),e("name",{initialValue:t&&t.name||"",rules:[{required:!1,message:(0,g.formatMessage)({id:"componentOverview.body.AddVarModal.input_explain"})}]})(h.default.createElement(r.default,{placeholder:(0,g.formatMessage)({id:"componentOverview.body.AddVarModal.input_explain"})})))))}},m=p))||m)||m);t.default=_},"YUe+":function(e,t,a){e.exports={rangeChart:"rangeChart___3yniD",ov:"ov___1gyx6",tooltips:"tooltips___2Len0",RangeChartBox:"RangeChartBox___3tyZx",customBox:"customBox___1YJPM"}},YoF6:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var s=l(a("BMrR"));a("jCWc");var i=l(a("kPKH"));a("lUTK");var r=l(a("BvKs"));a("IzEo");var o=l(a("bx4M"));a("+L6B");var d,c,u,m=l(a("2/Rp")),p=a("MuoO"),f=a("7DNP"),h=n(a("q1tI")),g=l(a("cUW5")),v=l(a("lpA0")),y=l(a("QDog")),b=l(a("nIwP")),_=l(a("pybC")),E=l(a("DXno")),w=l(a("X+Fk")),M=l(a("0oB1")),C=a("LLXN"),S=m.default.Group,O=(d=(0,p.connect)(e=>{var t=e.user;return{currUser:t.currentUser}},null,null,{withRef:!0}),d((u=class extends h.PureComponent{constructor(e){super(e),this.fetchBaseInfo=(()=>{var e=this.props,t=e.dispatch,a=e.appAlias;t({type:"appControl/fetchBaseInfo",payload:{team_name:y.default.getCurrTeamName(),app_alias:a}})}),this.changeType=(e=>{e!==this.state.type&&this.setState({type:e})}),this.changeMenu=(e=>{this.setState({showMenu:e.key})}),this.state={type:"now",showMenu:"pm",anaPlugins:null}}componentWillMount(){this.fetchBaseInfo()}componentDidMount(){this.canView()&&this.getAnalyzePlugins()}getAnalyzePlugins(){this.props.dispatch({type:"appControl/getAnalyzePlugins",payload:{team_name:y.default.getCurrTeamName(),app_alias:this.props.appAlias},callback:e=>{var t=e&&e.list||[];this.setState({anaPlugins:t})}})}canView(){return v.default.canManageAppMonitor(this.props.appDetail)}renderPM(){var e=this.state,t=e.type,a=e.anaPlugins,l=this.props.appDetail,n=a&&a.length>0;return n?h.default.createElement(h.Fragment,null,h.default.createElement("div",{style:{padding:"10px",border:"1px solid #e8e8e8",borderRadius:"5px"}},h.default.createElement("div",{style:{textAlign:"left",marginBottom:25}},h.default.createElement(S,null,h.default.createElement(m.default,{onClick:()=>{this.changeType("now")},type:"now"===t?"primary":""},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.monitor.now"})),h.default.createElement(m.default,{onClick:()=>{this.changeType("history")},type:"history"===t?"primary":""},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.monitor.history"})))),"now"===t?h.default.createElement(E.default,this.props):h.default.createElement(_.default,this.props))):h.default.createElement(o.default,null,h.default.createElement("div",{style:{textAlign:"center",fontSize:18,padding:"30px 0"}},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.monitor.analysis"}),h.default.createElement("p",{style:{paddingTop:8}},h.default.createElement(f.Link,{to:"/team/".concat(y.default.getCurrTeamName(),"/region/").concat(y.default.getCurrRegionName(),"/components/").concat(l&&l.service&&l.service.service_alias,"/plugin")},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.monitor.open"})))))}render(){if(!this.canView())return h.default.createElement(g.default,null);var e=this.state.showMenu,t=this.props,a=t.appDetail,l=t.componentPermissions.isServiceMonitor,n=["pm"],o=a&&a.service&&a.service.language&&a.service.language.toLowerCase().indexOf("java")>-1;return h.default.createElement(s.default,null,h.default.createElement(i.default,{span:4},h.default.createElement("div",{style:{paddingRight:"16px"}},h.default.createElement(r.default,{onSelect:this.changeMenu,defaultSelectedKeys:n,style:{height:"590px",border:"1px solid #e8e8e8",borderRadius:5}},h.default.createElement(r.default.Item,{key:"pm"},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.monitor.performanceAnalysis"})),h.default.createElement(r.default.Item,{key:"resource"},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.monitor.monitoring"})),o&&h.default.createElement(r.default.Item,{key:"trace"},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.monitor.tracking"})),l&&h.default.createElement(r.default.Item,{key:"custom"},h.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.monitor.business"}))))),h.default.createElement(i.default,{span:20},"pm"===e&&this.renderPM(),"trace"===e&&h.default.createElement(M.default,null),"resource"===e&&h.default.createElement(w.default,null),"custom"===e&&h.default.createElement(b.default,{appDetail:a})))}},c=u))||c);t.default=O},ZwJH:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var s=l(a("wCAj"));a("Pwec");var i=l(a("CtXQ"));a("BoS7");var r=l(a("Sdc0"));a("fOrg");var o=l(a("+KLJ"));a("IzEo");var d=l(a("bx4M"));a("14J3");var c=l(a("BMrR"));a("jCWc");var u=l(a("kPKH"));a("+L6B");var m=l(a("2/Rp"));a("5NDa");var p=l(a("5rEg"));a("/zsF");var f=l(a("PArb"));a("T2oS");var h=l(a("W9HT"));a("/xke");var g=l(a("TeRw"));a("y8nQ");var v=l(a("Vl3Y"));a("OaEy");var y,b,_,E,w=l(a("2fM7")),M=a("MuoO"),C=a("7DNP"),S=l(a("wd/R")),O=n(a("q1tI")),k=a("P5Jw"),A=l(a("QKd8")),x=l(a("4NES")),D=l(a("q76B")),F=l(a("cUW5")),T=a("xpXo"),P=l(a("QDog")),N=l(a("zQST")),R=l(a("I/an")),I=l(a("giye")),L=l(a("LrcT")),V=a("LLXN"),B=l(a("8+Sn")),H=w.default.Option,q=(y=(0,M.connect)(e=>{var t=e.user,a=e.appControl,l=e.teamControl;return{currUser:t.currentUser,baseInfo:a.baseInfo,extendInfo:a.extendInfo,instances:a.pods,scaling:a.scalingRules,features:l.features}},null,null,{pure:!1,withRef:!0}),b=v.default.create(),y(_=b((E=class extends O.PureComponent{constructor(e){super(e),this.handleVertical=(()=>{var e=this.props,t=e.form,a=e.appAlias,l=t.getFieldValue,n=l("memory"),s=Number(l("gpu")),i=Number(l("new_cpu"));(0,T.vertical)({team_name:P.default.getCurrTeamName(),app_alias:a,new_memory:n,new_gpu:s,new_cpu:i}).then(e=>{e&&!e.status&&g.default.success({message:(0,V.formatMessage)({id:"notification.success.operationImplement"})})})}),this.handleHorizontal=(()=>{var e=this.props.form.getFieldValue("node");(0,T.horizontal)({team_name:P.default.getCurrTeamName(),app_alias:this.props.appAlias,new_node:e}).then(e=>{e&&!e.status&&g.default.success({message:(0,V.formatMessage)({id:"notification.success.operationImplement"})})})}),this.openEditModal=(e=>{var t=this.props,a=t.dispatch,l=t.appDetail;if("add"===e)this.setState({showEditAutoScaling:!0});else{var n=this.state.id;a({type:"appControl/telescopic",payload:{team_name:P.default.getCurrTeamName(),rule_id:n,service_alias:l.service.service_alias},callback:t=>{t&&("close"===e?this.setState({rulesInfo:t.bean},()=>{this.shutDownAutoScaling()}):this.setState({rulesInfo:t.bean},()=>{this.changeAutoScaling(this.state.rulesInfo)}))}})}}),this.cancelEditAutoScaling=(()=>{this.setState({showEditAutoScaling:!1,addindicators:!1,rulesInfo:!1})}),this.handlePodClick=((e,t)=>{var a=window.open("about:blank"),l=this.props.appAlias;e&&t&&this.props.dispatch({type:"appControl/managePod",payload:{team_name:P.default.getCurrTeamName(),app_alias:l,pod_name:e,manage_name:t},callback:()=>{a.location.href="/console/teams/".concat(P.default.getCurrTeamName(),"/apps/").concat(l,"/docker_console/")}})}),this.fetchExtendInfo=(()=>{var e=this.props.dispatch;e({type:"appControl/fetchExtendInfo",payload:{team_name:P.default.getCurrTeamName(),app_alias:this.props.appAlias},handleError:e=>{e&&403===e.status&&this.props.dispatch(C.routerRedux.push("/exception/403"))}})}),this.fetchInstanceInfo=(()=>{var e=this.props.dispatch;e({type:"appControl/fetchPods",payload:{team_name:P.default.getCurrTeamName(),app_alias:this.props.appAlias},callback:e=>{e&&200===e.status_code?this.setState({instances:(e.list.new_pods||[]).concat(e.list.old_pods||[]),loading:!1}):this.setState({loading:!1})}})}),this.openAutoScaling=(e=>{this.addScalingRules(e)}),this.changeAutoScaling=(e=>{this.changeScalingRules(e)}),this.shutDownAutoScaling=(()=>{this.setState({automaLoading:!0});var e=this.props,t=e.dispatch,a=e.appDetail,l=this.state,n=l.rulesInfo,s=l.id,i=P.default.getCurrTeamName(),r=a.service.service_alias;t({type:"appControl/changeScalingRules",payload:{xpa_type:"hpa",metrics:n.metrics,maxNum:n.max_replicas,minNum:n.min_replicas,tenant_name:i,service_alias:r,enable:!1,rule_id:s},callback:e=>{e&&200===e.status_code?(g.default.success({message:(0,V.formatMessage)({id:"notification.success.close"})}),this.setState({showEditAutoScaling:!1,addindicators:!1,id:"",enable:!1},()=>{this.getScalingRules()})):g.default.success({message:(0,V.formatMessage)({id:"notification.error.close"})})}})}),this.addScalingRules=(e=>{this.setState({automaLoading:!0});var t=this.props,a=t.dispatch,l=t.appDetail,n=P.default.getCurrTeamName(),s=l.service.service_alias,i=[{metric_type:"resource_metrics",metric_name:e.selectMemory.indexOf("cpu")>-1?"cpu":"memory",metric_target_type:e.selectMemory.indexOf("utilization")>-1?"utilization":"average_value",metric_target_value:e.value?parseInt(e.value):0}];a({type:"appControl/addScalingRules",payload:{enable:!0,metrics:i,maxNum:parseInt(e.maxNum),minNum:parseInt(e.minNum),tenant_name:n,service_alias:s},callback:e=>{e&&200===e.status_code?(g.default.success({message:(0,V.formatMessage)({id:"notification.success.open"})}),this.setState({showEditAutoScaling:!1,addindicators:!1},()=>{this.getScalingRules()})):this.setState({showEditAutoScaling:!1,addindicators:!1,loading:!1})}})}),this.changeScalingRules=(e=>{this.setState({automaLoading:!0});var t=this.props,a=t.dispatch,l=t.appDetail,n=this.state,s=n.id,i=n.addindicators,r=n.rulesInfo,o=n.toDeleteMnt,d=n.automaticTelescopic,c=P.default.getCurrTeamName(),u=l.service.service_alias,m=r&&r.metrics;i&&m.push({metric_type:"resource_metrics",metric_name:e.selectMemory.indexOf("cpu")>-1?"cpu":"memory",metric_target_type:e.selectMemory.indexOf("utilization")>-1?"utilization":"average_value",metric_target_value:e.value?parseInt(e.value):0});var p=this;s&&a({type:"appControl/changeScalingRules",payload:{xpa_type:"hpa",enable:!0,maxNum:e.max_replicas?Number(e.max_replicas):Number(r.max_replicas),minNum:e.min_replicas?Number(e.min_replicas):Number(r.min_replicas),metrics:i?m:e.metrics,tenant_name:c,service_alias:u,rule_id:s},callback:e=>{e&&200===e.status_code?(g.default.success({message:o?(0,V.formatMessage)({id:"notification.success.delete"}):d?i?(0,V.formatMessage)({id:"notification.success.add"}):(0,V.formatMessage)({id:"notification.success.edit"}):(0,V.formatMessage)({id:"notification.success.open"})}),p.setState({showEditAutoScaling:!1,addindicators:!1,toDeleteMnt:!1,id:e.bean.id},()=>{p.getScalingRules()})):(g.default.success({message:(0,V.formatMessage)({id:"notification.success.Failed"})}),p.setState({showEditAutoScaling:!1,addindicators:!1}))}})}),this.getScalingRules=(()=>{var e=this.props,t=e.dispatch,a=e.appDetail;t({type:"appControl/getScalingRules",payload:{tenant_name:P.default.getCurrTeamName(),service_alias:a&&a.service&&a.service.service_alias},callback:e=>{if(e&&200===e.status_code){var t=e.list,a=!!(t&&t.length>0);this.setState({enable:a,rulesList:a?t:[],id:t&&a?t[0].rule_id:"",editRules:!(!a||!t[0].enable),automaticTelescopic:!(!a||!t[0].enable),loading:!1,automaLoading:!1})}else this.setState({loading:!1,automaLoading:!1})}})}),this.onPageChange=(e=>{this.setState({page_num:e},()=>{this.getScalingRecord()})}),this.getScalingRecord=(()=>{var e=this.props,t=e.dispatch,a=e.appDetail,l=this.state,n=l.page_num,s=l.page_size;t({type:"appControl/getScalingRecord",payload:{tenant_name:P.default.getCurrTeamName(),service_alias:a&&a.service&&a.service.service_alias,page:n,page_size:s},callback:e=>{e&&200===e.status_code&&this.setState({total:e.bean.total,sclaingRecord:e.bean.data})}})}),this.saveForm=(e=>{this.form=e;var t=this.state,a=t.rulesList,l=t.enable;l&&this.form&&this.form.setFieldsValue(a[0])}),this.setMetric_target_value=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=0;return e&&e.length>0&&e.map(e=>{var n=e.metric_name,s=e.metric_target_value,i=e.metric_target_type;if(t===n)return l=a?i:s,s}),void 0===l?0:l},this.setMetric_target_show=function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var a=!1;return e&&e.length>0&&e.map(e=>{var l=e.metric_name;t===l&&(a=!0)}),a},this.onChangeAutomaticTelescopic=(()=>{var e=this.state,t=e.enable,a=e.automaticTelescopic;this.openEditModal(a?"close":t?"edit":"add")}),this.handleSubmit=(e=>{e.preventDefault();var t=this.state.enable;this.props.form.validateFields((e,a)=>{e||(t?this.changeAutoScaling(a):this.openAutoScaling(a))})}),this.handleAddIndicators=(e=>{var t=this.props,a=t.dispatch,l=t.appDetail,n=this.state,s=n.id,i=n.deleteType,r=n.editInfo;a({type:"appControl/telescopic",payload:{team_name:P.default.getCurrTeamName(),rule_id:s,service_alias:l&&l.service&&l.service.service_alias},callback:t=>{if(t)if("add"===e)this.setState({rulesInfo:t.bean,showEditAutoScaling:!0,addindicators:!0});else if("delete"===e){var a=t.bean;a.metrics.splice(a.metrics.findIndex(e=>e.metric_name===i),1),this.changeScalingRules(a)}else if(r){var l=t.bean;l.max_replicas=Number(r.maxNum),l.min_replicas=Number(r.minNum);var n=t.bean.metrics;r.cpuValue&&n.map((e,t)=>{"cpu"==e.metric_name&&(l.metrics[t].metric_target_value=Number(r.cpuValue))}),r.memoryValue&&n.map((e,t)=>{"memory"==e.metric_name&&(l.metrics[t].metric_target_value=Number(r.memoryValue))}),this.changeScalingRules(l)}}})}),this.cancelDeleteMnt=(()=>{this.setState({toDeleteMnt:null,deleteType:""})}),this.handleDeleteMnt=(e=>{this.setState({deleteType:e,toDeleteMnt:!0})}),this.handlerules=(e=>{var t=this.props.form,a=this.state.rulesList,l=t.getFieldValue,n=t.validateFields,s=a&&a.length>0&&a[0],i=l(e),r=Number(l("maxNum")),o=Number(l("minNum")),d=Number(l("cpuValue")),c=Number(l("memoryValue")),u=s&&Number(s.max_replicas),m=s&&Number(s.min_replicas),p=1,f=1;s&&s.metrics&&s.metrics.length>0&&s.metrics.map(e=>{"cpu"==e.metric_name&&(p=Number(e.metric_target_value)),"memory"==e.metric_name&&(f=Number(e.metric_target_value))});var h="",g="maxNum"===e?"errorMaxNum":"minNum"===e?"errorMinNum":"cpuValue"===e?"errorCpuValue":"errorMemoryValue";if(""==i||null==i)return this.setState({errorDesc:(0,V.formatMessage)({id:"componentOverview.body.Expansion.empty"}),[g]:h,errorType:e}),!1;i=Number(i);var v=s&&this.setMetric_target_show(s.metrics,"cpu"),y=s&&this.setMetric_target_show(s.metrics,"memory"),b=!0;r!==u||o!==m||v&&d!==p||y&&c!==f||(b=!1);var _=/^[0-9]+.?[0-9]*/;_.test(i)?i<=0||i>65535?h="".concat((0,V.formatMessage)({id:"componentOverview.body.Expansion.Input"})):"minNum"===e&&i>Number(r)?h="".concat((0,V.formatMessage)({id:"componentOverview.body.Expansion.max"})):"maxNum"===e&&i<Number(o)?h="".concat((0,V.formatMessage)({id:"componentOverview.body.Expansion.min"})):this.setState({[g]:"",errorType:e},()=>{var e=this.state,t=e.errorMinNum,a=e.errorMaxNum,l=e.errorCpuValue,s=e.errorMemoryValue;return b&&""===t&&""===a&&""===l&&""===s&&n((e,t)=>{this.setState({editInfo:t},()=>{this.handleAddIndicators("edit")})}),null}):h="".concat((0,V.formatMessage)({id:"componentOverview.body.Expansion.enter"})),this.setState({[g]:h,errorType:e})}),this.state={new_pods:this.props.instances&&this.props.instances.new_pods?this.props.instances.new_pods:[],old_pods:this.props.instances&&this.props.instances.old_pods?this.props.instances.old_pods:[],instances:[],loading:!1,showEditAutoScaling:!1,editRules:!1,rulesList:[],sclaingRecord:[],page_num:1,page_size:10,enable:!1,rulesInfo:!1,total:0,automaticTelescopic:!1,addindicators:!1,toDeleteMnt:!1,deleteType:"",editInfo:!1,automaLoading:!0,errorMinNum:"",errorMaxNum:"",errorCpuValue:"",errorMemoryValue:"",enableGPU:N.default.haveFeature(this.props.features,"GPU"),language:"zh-CN"===B.default.get("language")}}componentWillReceiveProps(e){e.instances.new_pods!==this.state.new_pods||e.instances.old_pods!==this.state.old_pods?this.setState({new_pods:e.instances.new_pods||[],old_pods:e.instances.old_pods||[],instances:(e.instances.new_pods||[]).concat(e.instances.old_pods||[]),loading:!1}):this.setState({loading:!1})}componentDidMount(){this.canView()&&(this.props.appDetail&&this.props.appDetail.service&&this.props.appDetail.service.service_alias?(this.getScalingRules(),this.getScalingRecord(),this.fetchInstanceInfo(),this.fetchExtendInfo(),this.timeClick=setInterval(()=>{this.fetchInstanceInfo()},6e4)):setTimeout(()=>{this.props.appDetail&&this.props.appDetail.service&&this.props.appDetail.service.service_alias&&(this.getScalingRules(),this.getScalingRecord(),this.fetchInstanceInfo(),this.fetchExtendInfo(),this.timeClick=setInterval(()=>{this.fetchInstanceInfo()},6e4))},2e3))}componentWillUnmount(){var e=this.props.dispatch;e({type:"appControl/clearExtendInfo"}),this.timeClick&&clearInterval(this.timeClick)}canView(){var e=this.props.componentPermissions.isTelescopic;return e}render(){if(!this.canView())return O.default.createElement(F.default,null);var e=this.props,t=e.extendInfo,a=e.appAlias,l=e.form,n=e.appDetail,y=!1;n&&P.default.isSingletonComponent(n&&n.service&&n.service.extend_method)&&(y=!0);var b=this.props.match.params,_=b.teamName,E=b.regionName,M=l.getFieldDecorator,T=l.getFieldValue,N=this.state,B=N.page_num,q=N.page_size,U=N.total,z=N.loading,j=N.rulesList,X=N.sclaingRecord,K=N.rulesInfo,Q=N.editRules,W=N.enable,G=N.automaticTelescopic,Y=N.showEditAutoScaling,J=N.addindicators,Z=N.errorMinNum,$=N.errorMaxNum,ee=N.errorCpuValue,te=N.errorMemoryValue,ae=N.enableGPU,le=N.language;if(!t)return null;var ne=T("minNum")||0,se="grctl service get ".concat(a," -t ").concat(P.default.getCurrTeamName()),ie=[],re=j&&j.length>0&&this.setMetric_target_show(j[0].metrics,"cpu"),oe=j&&j.length>0&&this.setMetric_target_show(j[0].metrics,"memory");re||ie.push({value:"cpuaverage_value",name:(0,V.formatMessage)({id:"componentOverview.body.Expansion.cup_usage"})},{value:"cpuutilization",name:(0,V.formatMessage)({id:"componentOverview.body.Expansion.cpu_use"})}),oe||ie.push({value:"memoryaverage_value",name:(0,V.formatMessage)({id:"componentOverview.body.Expansion.usage"})},{value:"memoryutilization",name:(0,V.formatMessage)({id:"componentOverview.body.Expansion.use"})});var de=e=>O.default.createElement("div",{className:L.default.remindDesc},e);return O.default.createElement("div",null,O.default.createElement(d.default,{className:L.default.InstancesCard,title:O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.instance"}),extra:O.default.createElement("a",{style:{marginRight:"22px",color:"#1790FF"},onClick:()=>{this.setState({loading:!0},()=>{this.fetchInstanceInfo()})}},O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.refresh"}))},z?O.default.createElement(h.default,{tip:"Loading..."},O.default.createElement("div",{style:{minHeight:"190px"}})):O.default.createElement("div",null,O.default.createElement(x.default,{handlePodClick:this.handlePodClick,list:this.state.instances,serviceID:this.props.appDetail&&this.props.appDetail.service&&this.props.appDetail.service.service_id,k8s_component_name:this.props.appDetail.service.k8s_component_name}),O.default.createElement(f.default,null),O.default.createElement("div",null,O.default.createElement(c.default,null,O.default.createElement(u.default,{span:24,style:{display:"flex"}},O.default.createElement("span",{className:L.default.commandText},O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.query"})),O.default.createElement("div",{className:L.default.commandWidth},O.default.createElement(p.default,{value:se,style:{background:"#F9FAFC",textAlign:"center"}}),O.default.createElement("div",{className:L.default.remindDesc},O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.copyCommand"}))),O.default.createElement(k.CopyToClipboard,{text:se,onCopy:()=>{g.default.success({message:(0,V.formatMessage)({id:"notification.success.copy"})})}},O.default.createElement(m.default,{type:"primary",style:{marginLeft:19}},O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.copy"})))))))),y&&O.default.createElement(o.default,{style:{marginTop:"16px"},message:O.default.createElement("p",{style:{marginBottom:0}},O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.modify"})," ",O.default.createElement(C.Link,{to:"/team/".concat(_,"/region/").concat(E,"/components/").concat(a,"/setting")},O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.set"}))),type:"warning"}),O.default.createElement(d.default,{className:L.default.clerBorder,border:!1,title:O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.telescopic"})},!ae&&O.default.createElement(o.default,{style:{marginBottom:"16px"},type:"warning",closable:!0,message:O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.empower"})}),O.default.createElement(v.default,{layout:"inline",hideRequiredMark:!0,className:L.default.fromItem},O.default.createElement(c.default,{gutter:16},O.default.createElement(u.default,{lg:8,md:8,sm:24},O.default.createElement(v.default.Item,{labelCol:le?{span:5}:{span:6},wrapperCol:le?{span:19}:{span:18},label:O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.memory"}),className:L.default.customFormItem},M("memory",{initialValue:"".concat(t.current_memory)||0})(O.default.createElement(w.default,{getPopupContainer:e=>e.parentNode,className:L.default.memorySelect},O.default.createElement(H,{key:0,value:0},O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.unlimited"})),(t.memory_list||[]).map(e=>O.default.createElement(H,{key:e,value:e},R.default.getMemoryAndUnit(e)))))),de("".concat((0,V.formatMessage)({id:"componentOverview.body.Expansion.algorithm"})))),O.default.createElement(u.default,{lg:8,md:8,sm:24},O.default.createElement(v.default.Item,{labelCol:le?{span:6}:{span:8},wrapperCol:le?{span:18}:{span:16},className:L.default.customFormItem,label:O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.video"})},M("gpu",{initialValue:"".concat(t.current_gpu)})(O.default.createElement(p.default,{disabled:!ae,type:"number",addonAfter:"MiB"}))),de("".concat((0,V.formatMessage)({id:"componentOverview.body.Expansion.resources"})))),O.default.createElement(u.default,{lg:8,md:8,sm:24},O.default.createElement(v.default.Item,{label:"CPU",labelCol:le?{span:5}:{span:6},wrapperCol:le?{span:19}:{span:18},className:L.default.customFormItem},M("new_cpu",{initialValue:t.current_cpu||0,rules:[{required:!0,message:(0,V.formatMessage)({id:"componentOverview.body.Expansion.input_cup"})},{pattern:new RegExp(/^[0-9]\d*$/,"g"),message:(0,V.formatMessage)({id:"componentOverview.body.Expansion.onlyAllowed"})}]})(O.default.createElement(p.default,{type:"number",min:0,addonAfter:"m",placeholder:(0,V.formatMessage)({id:"componentOverview.body.Expansion.input_cup"})})),O.default.createElement(m.default,{onClick:this.handleVertical,size:"default",type:"primary",style:{marginLeft:"10px"}},O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.setUp"}))),de("".concat((0,V.formatMessage)({id:"componentOverview.body.Expansion.dispatch"}))))),O.default.createElement(c.default,{gutter:16},O.default.createElement(u.default,{lg:8,md:8,sm:24},O.default.createElement(v.default.Item,{label:O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.number"}),labelCol:le?{span:5}:{span:8},wrapperCol:le?{span:19}:{span:16},className:L.default.customFormItem},M("node",{initialValue:t.current_node})(O.default.createElement(w.default,{getPopupContainer:e=>e.parentNode,className:L.default.nodeSelect},(t.node_list||[]).map(e=>O.default.createElement(H,{key:e,value:e},e)))),O.default.createElement(m.default,{disabled:y,onClick:this.handleHorizontal,size:"default",type:"primary",style:{marginLeft:"10px"}},O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.setUp"}))),de("".concat((0,V.formatMessage)({id:"componentOverview.body.Expansion.initialValue"}))))))),O.default.createElement(d.default,{style:{marginTop:16},className:L.default.clearCard,title:O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.flex"})},O.default.createElement(c.default,{gutter:24,className:L.default.automaTictelescopingBOX},O.default.createElement(u.default,{span:12,className:le?L.default.automaTictelescopingTitle:L.default.en_automaTictelescopingTitle},O.default.createElement("div",null,O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.switch"})),O.default.createElement("div",null,O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.minNumber"})),O.default.createElement("div",null,O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.maxNumber"}))),O.default.createElement(u.default,{span:12,className:L.default.automaTictelescopingTitle},re&&O.default.createElement("div",null,O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.CPU_usage"}),"utilization"===this.setMetric_target_value(j[0].metrics,"cpu",!0)?O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.rate"}):O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.amount_m"}),oe&&O.default.createElement("img",{src:A.default,alt:"",onClick:()=>{this.handleDeleteMnt("cpu")}})),oe&&O.default.createElement("div",null,O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.CPU_umemory"}),"utilization"===this.setMetric_target_value(j[0].metrics,"memory",!0)?O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.rate"}):O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.amount_mi"}),re&&O.default.createElement("img",{src:A.default,alt:"",onClick:()=>{this.handleDeleteMnt("memory")}})))),O.default.createElement(h.default,{spinning:this.state.automaLoading},O.default.createElement(v.default,{layout:"inline",hideRequiredMark:!0,className:L.default.fromItem,onSubmit:this.handleSubmit},O.default.createElement(c.default,{gutter:24,className:L.default.automaTictelescoping},O.default.createElement(u.default,{span:12},O.default.createElement("div",{className:L.default.automaTictelescopingContent},O.default.createElement(r.default,{disabled:y,className:L.default.automaTictelescopingSwitch,checked:G,onClick:()=>{this.onChangeAutomaticTelescopic()}})),O.default.createElement("div",{className:L.default.automaTictelescopingContent},M("minNum",{initialValue:j&&j.length>0&&j[0].min_replicas||0})(O.default.createElement(p.default,{disabled:!G,onBlur:e=>{this.handlerules("minNum")}}))),O.default.createElement("div",{className:L.default.automaTictelescopingContent},M("maxNum",{initialValue:j&&j.length>0&&j[0].max_replicas||1,rules:[{pattern:new RegExp(/^[0-9]\d*$/,"g"),message:(0,V.formatMessage)({id:"componentOverview.body.Expansion.enter"})},{required:!0,message:(0,V.formatMessage)({id:"componentOverview.body.Expansion.input_num_max"})},{validator:this.checkContent}]})(O.default.createElement(p.default,{disabled:!G,min:ne,onBlur:e=>{this.handlerules("maxNum")}})))),O.default.createElement(u.default,{span:12},re&&O.default.createElement("div",{className:L.default.automaTictelescopingContent},M("cpuValue",{initialValue:this.setMetric_target_value(j[0].metrics,"cpu")||1,rules:[{pattern:new RegExp(/^[0-9]\d*$/,"g"),message:(0,V.formatMessage)({id:"componentOverview.body.Expansion.enter"})},{required:!0,message:(0,V.formatMessage)({id:"componentOverview.body.Expansion.input_cup"})},{validator:this.checkContent}]})(O.default.createElement(p.default,{disabled:!G,onBlur:e=>{this.handlerules("cpuValue")}}))),oe&&O.default.createElement("div",{className:L.default.automaTictelescopingContent},M("memoryValue",{initialValue:this.setMetric_target_value(j[0].metrics,"memory")||1,rules:[{pattern:new RegExp(/^[0-9]\d*$/,"g"),message:(0,V.formatMessage)({id:"componentOverview.body.Expansion.enter"})},{required:!0,message:(0,V.formatMessage)({id:"componentOverview.body.Expansion.input_memory"})},{validator:this.checkContent}]})(O.default.createElement(p.default,{disabled:!G,onBlur:e=>{this.handlerules("memoryValue")}}))),!re&&O.default.createElement("div",{style:{height:"56px"}}),!oe&&O.default.createElement("div",{style:{height:"56px"}}),O.default.createElement("div",{className:L.default.automaTictelescopingContent},O.default.createElement(i.default,{type:"plus",style:{fontSize:"23px"},onClick:()=>{ie.length>0&&G&&this.handleAddIndicators("add")}})))))),O.default.createElement(c.default,{gutter:24,className:L.default.errorDescBox},O.default.createElement(u.default,{span:12,className:L.default.automaTictelescopingTitle},O.default.createElement("div",null),O.default.createElement("div",null,O.default.createElement("span",{className:L.default.errorDesc},Z)),O.default.createElement("div",null,O.default.createElement("span",{className:L.default.errorDesc}," ",$))),O.default.createElement(u.default,{span:12,className:L.default.automaTictelescopingTitle},re&&O.default.createElement("div",null,O.default.createElement("span",{className:L.default.errorDesc},ee)),oe&&O.default.createElement("div",null,O.default.createElement("span",{className:L.default.errorDesc},te))))),this.state.toDeleteMnt&&O.default.createElement(D.default,{title:O.default.createElement(V.FormattedMessage,{id:"confirmModal.deldete.index.title"}),desc:O.default.createElement(V.FormattedMessage,{id:"confirmModal.deldete.index.desc"}),onCancel:this.cancelDeleteMnt,onOk:()=>{this.handleAddIndicators("delete")}}),Y&&O.default.createElement(I.default,{data:K,ref:this.saveForm,isvisable:Y,isaddindicators:J,memoryList:ie,onClose:this.cancelEditAutoScaling,onOk:e=>{W?this.changeAutoScaling(e):this.openAutoScaling(e)},editRules:Q}),O.default.createElement(d.default,{className:L.default.clearCard,style:{marginTop:16},title:O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.horizontal"})},O.default.createElement(s.default,{className:L.default.horizontalExpansionRecordTable,dataSource:X,pagination:U>q&&{current:B,pageSize:q,total:U,onChange:this.onPageChange},columns:[{title:(0,V.formatMessage)({id:"componentOverview.body.Expansion.time"}),dataIndex:"last_time",key:"last_time",align:"center",width:"18%",render:e=>O.default.createElement("div",{style:{wordWrap:"break-word",wordBreak:"break-word"}},(0,S.default)(e).locale("zh-cn").format("YYYY-MM-DD HH:mm:ss"))},{title:(0,V.formatMessage)({id:"componentOverview.body.Expansion.telescopicDetails"}),dataIndex:"description",key:"description",align:"center",width:"43%",render:e=>O.default.createElement("div",{style:{textAlign:"left",wordWrap:"break-word",wordBreak:"break-word"}},e)},{title:(0,V.formatMessage)({id:"componentOverview.body.Expansion.type"}),dataIndex:"record_type",key:"record_type",align:"center",width:"13%",render:e=>O.default.createElement("div",null,"hpa"===e?O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.horizontalAutomatic"}):"manual"===e?O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.manualTelescopic"}):O.default.createElement(V.FormattedMessage,{id:"componentOverview.body.Expansion.vertical"}))},{title:(0,V.formatMessage)({id:"componentOverview.body.Expansion.operator"}),dataIndex:"operator",key:"operator",align:"center",width:"13%",render:e=>{return O.default.createElement("span",null," ",e||"-"," ")}},{title:(0,V.formatMessage)({id:"componentOverview.body.Expansion.reason"}),dataIndex:"reason",align:"center",key:"reason",width:"13%"}]})))}},_=E))||_)||_);t.default=q},"a8l+":function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=n(a("kLXV"));a("Pwec");var i=n(a("CtXQ")),r=n(a("PWDA")),o=l(a("q1tI")),d=a("xpXo"),c=n(a("QDog")),u=n(a("zMIy")),m=a("LLXN");class p extends o.PureComponent{constructor(e){super(e),this.state={list:[],loading:!0,showHighlighted:""}}componentDidMount(){this.loadData()}loadData(){(0,d.getServiceLog)({team_name:c.default.getCurrTeamName(),app_alias:this.props.appAlias,lines:1e3}).then(e=>{e&&this.setState({loading:!1,list:e.list||[]})})}render(){var e=this.state,t=e.loading,a=e.list,l=e.showHighlighted;return o.default.createElement(s.default,{title:o.default.createElement(m.FormattedMessage,{id:"componentOverview.body.tab.log.History1000Log.title"}),visible:!0,width:1e3,bodyStyle:{background:"#222222",color:"#fff"},className:u.default.logModal,onCancel:this.props.onCancel,footer:null},t?o.default.createElement("div",{style:{textAlign:"center"}},o.default.createElement(i.default,{type:"loading",style:{marginTop:20,marginBottom:20}})):"",t?"":o.default.createElement("div",{style:{padding:"20px 0",maxHeight:500,overflowY:"auto",background:"#212121"}},a.length>0?o.default.createElement("div",{className:u.default.History1000Log},a.map((e,t)=>{return o.default.createElement("div",{key:t},o.default.createElement("span",{style:{color:l===e.substring(0,e.indexOf(":"))?"#FFFF91":"#666666"}},o.default.createElement("b",null),o.default.createElement("span",null,""===e?"":"".concat(t+1))),o.default.createElement("span",{ref:"texts",style:{color:l==e.substring(0,e.indexOf(":"))?"#FFFF91":"#FFF"}},o.default.createElement(r.default,null,e.substring(e.indexOf(":")+1,e.length))),1===a.length?o.default.createElement("span",{style:{color:l===e.substring(0,e.indexOf(":"))?"#FFFF91":"#bbb",cursor:"pointer",backgroundColor:e.substring(0,e.indexOf(":"))?"#666":""},onClick:()=>{this.setState({showHighlighted:l==e.substring(0,e.indexOf(":"))?"":e.substring(0,e.indexOf(":"))})}},o.default.createElement(r.default,null,e.substring(0,e.indexOf(":")))," "):a.length>1&&t>=1&&e.substring(0,e.indexOf(":"))==a[t<=0?t+1:t-1].substring(0,a[t<=0?t+1:t-1].indexOf(":"))?"":o.default.createElement("span",{style:{color:l==e.substring(0,e.indexOf(":"))?"#FFFF91":"#bbb",cursor:"pointer",backgroundColor:0==t&&e.substring(0,e.indexOf(":"))?"#666":e.substring(0,e.indexOf(":"))==a[t<=0?t+1:t-1].substring(0,a[t<=0?t+1:t-1].indexOf(":"))?"":"#666"},onClick:()=>{this.setState({showHighlighted:l==e.substring(0,e.indexOf(":"))?"":e.substring(0,e.indexOf(":"))})}},o.default.createElement(r.default,null,e.substring(0,e.indexOf(":")))," "))})):o.default.createElement("p",{style:{textAlign:"center",marginBottom:0,color:"#999"}},o.default.createElement(m.FormattedMessage,{id:"componentOverview.body.tab.log.History1000Log.null"}))))}}t.default=p},agpv:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bbsP");var s=l(a("/wGt"));a("+L6B");var i=l(a("2/Rp"));a("giR+");var r=l(a("fyUT"));a("5Dmo");var o=l(a("3S7+")),d=l(a("jehZ"));a("5NDa");var c=l(a("5rEg"));a("7Kak");var u=l(a("9yH6"));a("y8nQ");var m,p,f,h=l(a("Vl3Y")),g=n(a("q1tI")),v=a("LLXN"),y=l(a("ZNrE")),b=h.default.Item,_=u.default.Group,E=(m=h.default.create(),m((f=class extends g.PureComponent{constructor(){super(...arguments),this.handleSubmit=(e=>{e.preventDefault();var t=this.props,a=t.form,l=t.onSubmit,n=a.validateFields;n((e,t)=>{!e&&l&&l(t)})}),this.handleCancel=(()=>{var e=this.props.onCancel;e&&e()}),this.modeCheck=((e,t,a)=>{!t||/^[0-7]{1,3}$/.test(t)?a():a(g.default.createElement(v.FormattedMessage,{id:"componentOverview.body.tab.AddStorage.limit"}))})}render(){var e=this.props,t=e.data,a=e.editor,l=e.form,n=l.getFieldDecorator,m=l.setFieldsValue,p={labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}};return g.default.createElement(s.default,{title:a?g.default.createElement(v.FormattedMessage,{id:"componentOverview.body.tab.AddStorage.edit"}):g.default.createElement(v.FormattedMessage,{id:"componentOverview.body.tab.AddStorage.add"}),placement:"right",width:500,closable:!1,onClose:this.handleCancel,visible:!0,maskClosable:!1,style:{overflow:"auto"}},g.default.createElement(h.default,{onSubmit:this.handleSubmit,labelAlign:"left"},g.default.createElement(b,(0,d.default)({},p,{label:g.default.createElement(v.FormattedMessage,{id:"componentOverview.body.tab.AddStorage.name"})}),n("volume_name",{initialValue:t.volume_name||"",rules:[{required:!0,message:(0,v.formatMessage)({id:"componentOverview.body.tab.AddStorage.input"})},{pattern:/^[^\s]*$/,message:(0,v.formatMessage)({id:"placeholder.no_spaces"})},{max:30,message:(0,v.formatMessage)({id:"componentOverview.body.tab.AddStorage.max"})}]})(g.default.createElement(c.default,{placeholder:(0,v.formatMessage)({id:"componentOverview.body.tab.AddStorage.input"}),disabled:!!this.props.editor}))),g.default.createElement(b,(0,d.default)({},p,{label:g.default.createElement(v.FormattedMessage,{id:"componentOverview.body.tab.AddStorage.path"})}),n("volume_path",{initialValue:t.volume_path||"",rules:[{required:!0,message:(0,v.formatMessage)({id:"componentOverview.body.tab.AddStorage.input_path"})},{pattern:/^[^\s]*$/,message:(0,v.formatMessage)({id:"placeholder.no_spaces"})},{max:255,message:(0,v.formatMessage)({id:"componentOverview.body.tab.AddStorage.Maximum_length"})}]})(g.default.createElement(c.default,{placeholder:(0,v.formatMessage)({id:"componentOverview.body.tab.AddStorage.input_path"})}))),g.default.createElement("div",{style:{display:"none"}},g.default.createElement(b,(0,d.default)({},p,{label:g.default.createElement(v.FormattedMessage,{id:"componentOverview.body.tab.AddStorage.type"})}),n("volume_type",{initialValue:"config-file",rules:[{required:!0,message:(0,v.formatMessage)({id:"componentOverview.body.tab.AddStorage.input_type"})}]})(g.default.createElement(_,null,g.default.createElement(u.default,{value:"config-file",disabled:!!this.props.editor},g.default.createElement(o.default,{title:g.default.createElement(v.FormattedMessage,{id:"componentOverview.body.tab.AddStorage.content"})},g.default.createElement(v.FormattedMessage,{id:"componentOverview.body.tab.AddStorage.AddStoragefile"}))))))),g.default.createElement(b,(0,d.default)({},p,{label:g.default.createElement(v.FormattedMessage,{id:"componentOverview.body.tab.AddStorage.mode"})}),n("mode",{initialValue:t.mode||777,rules:[{required:!0,validator:this.modeCheck}]})(g.default.createElement(r.default,{min:0,style:{width:"100%"}}))),g.default.createElement(y.default,{setFieldsValue:m,formItemLayout:p,Form:h.default,style:{marginBottom:"20px"},getFieldDecorator:n,name:"file_content",label:g.default.createElement(v.FormattedMessage,{id:"componentOverview.body.tab.AddStorage.Document"}),message:g.default.createElement(v.FormattedMessage,{id:"componentOverview.body.tab.AddStorage.edit_content"}),data:t.file_content||""})),g.default.createElement("div",{style:{borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",background:"#fff",borderRadius:"0 0 4px 4px"}},g.default.createElement(i.default,{style:{marginRight:8},onClick:this.handleCancel},g.default.createElement(v.FormattedMessage,{id:"button.cancel"})),g.default.createElement(i.default,{onClick:this.handleSubmit,type:"primary"},g.default.createElement(v.FormattedMessage,{id:"button.determine"}))))}},p=f))||p);t.default=E},bLLg:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAANCAYAAACdKY9CAAAAr0lEQVQoU2P8////fwYGBoY79x4ylDV2M/Bwc4O4cPDl61eGrvpSBhUlebAYI0zDui27GUB6g33dUDSs3byLgZGRkSHIxxVdwy6wQJAPqobzl66BxQ31tCAaDh49BXbS0VPnwALWZkYoNqBzGJ0C4v9HBnnjVQSTXL5uKwNjdHrJ/yUzuonSEJNRSiUNambuDLdO7cSwFacNtNeAKwTI87SxU9B/LXUVooL12s07DAAEf2F6q3srMgAAAABJRU5ErkJggg=="},ctOv:function(e,t,a){e.exports={nameID:"nameID___2Ease",icon:"icon___16vqz",iconm:"iconm___3OCSr",nowarpText:"nowarpText___2zPhp",logModal:"logModal___2hns0",logsss:"logsss___2uJ-X",logpassed:"logpassed___3Q8Va",logfailed:"logfailed___2U4bI",logfored:"logfored___2pTsm",logcanceled:"logcanceled___3aDnB",loginfo:"loginfo___3HoxI",nodeBox:"nodeBox___2n2e2",text:"text___WagKL",imgs:"imgs____CG40",boxImg:"boxImg___2RBrV",button:"button___1AoUM",active:"active___30tgj",passeda:"passeda___1lCaR",faileda:"faileda___2TFCf",canceleda:"canceleda___1_-JY",alcen:"alcen___Ftyib",passed:"passed___AkHXr",failed:"failed___3N0Cr",canceled:"canceled___30_w8",rowLi:"rowLi___2fdpu",prRow:"prRow___3mS-7",statusIcon:"statusIcon___2OuhP",labelAlign:"labelAlign___2v_lc",rowMessage:"rowMessage___2v7P0",buildHistoryBox:"buildHistoryBox___23GlQ",buildHistoryList:"buildHistoryList___3wkx5",lineone:"lineone___2s7Q1",linetwo:"linetwo___3ZRYg",linestree:"linestree___2v1xj",linefour:"linefour___18sMg",rowRtem:"rowRtem___2CLXc",rowDuration:"rowDuration___3m3A3",buildInfo:"buildInfo___247Nr",buildCommitter:"buildCommitter___3RTNu",rowBranch:"rowBranch___1vSSh",pageHeaderContent:"pageHeaderContent___V6X2X",avatar:"avatar___3k3k6",content:"content___NdyZA",contentTitle:"contentTitle___9Whj_",extraContent:"extraContent___3S2aN",statItem:"statItem___1UJ2r","ant-btn-group":"ant-btn-group___Vc9n-",activeCard:"activeCard___3P3sd",members:"members___2Kxmw",projectList:"projectList___2fxXZ",projectGrid:"projectGrid___3W5dN",tableList:"tableList___o3-D6",tableListOperator:"tableListOperator___3mQ1m",statuscn:"statuscn___cOVgo",charContent:"charContent___3HE66",statusIconWraper:"statusIconWraper___33C2b",charContentTit:"charContentTit___1snvM",sub:"sub___2UB7R",logs:"logs___2fu0x",pluginList:"pluginList___2d2T6",logItem:"logItem___3fbK8",logItemDate:"logItemDate___3ttZL",date:"date___3fnMt",time:"time___y01ER",logItemMain:"logItemMain___2eLeN",hd:"hd___QCMli",tit:"tit___28KRi",btns:"btns___3TqdD",btn:"btn___1KmIh",codeVersion:"codeVersion___3cHUI",versionInfo:"versionInfo___wSAvf",versionAuthor:"versionAuthor___15hhN",logContent:"logContent___IiqxR",success:"success___vYrFn",fail:"fail___xepGk",iconGroup:"iconGroup___2Stp2",rankingList:"rankingList___64u59",salesExtra:"salesExtra___1keSn",currentDate:"currentDate___3QbSw",salesCard:"salesCard___3Stvx",salesBar:"salesBar___1TUEz",salesRank:"salesRank___IojWE",salesCardExtra:"salesCardExtra___Ci1it",salesTypeRadio:"salesTypeRadio___2IXvR",offlineCard:"offlineCard___3A9CV",trendText:"trendText___5rQ8y",blueant:"blueant___24_K_",blueanimation:"blueanimation___1ROL9",rankingTitle:"rankingTitle___1mEif",salesExtraWrap:"salesExtraWrap___2QfeB"}},dL6S:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var s=l(a("BMrR"));a("IzEo");var i=l(a("bx4M"));a("cWXX");var r=l(a("/ezw"));a("jCWc");var o=l(a("kPKH"));a("5Dmo");var d=l(a("3S7+"));a("y8nQ");var c,u,m,p=l(a("Vl3Y")),f=l(a("ZhIB")),h=n(a("q1tI")),g=l(a("QDog")),v=l(a("8+Sn")),y=l(a("LrcT")),b=a("LLXN"),_=(c=p.default.create(),c((m=class extends h.PureComponent{constructor(e){super(e),this.handleMore=(e=>{var t=this.props,a=t.handleMore,l=t.onPageChange;a&&l&&(l(1),a(e))}),this.titleCase=(e=>{e=e.toLowerCase();for(var t=e.split(" "),a=0;a<t.length;a++)t[a]=t[a].substring(0,1).toUpperCase()+t[a].substring(1);return t.join(" ")}),this.state={language:"zh-CN"===v.default.get("language")}}componentDidMount(){}render(){var e=this.state.language,t=this.props,a=t.status,l=t.beanData,n=t.more,c=t.resourcesLoading,u=t.memory,m=t.disk,p=t.dataList,v=t.buildSource,_=t.isThird,E=0===u?h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.unlimited"}):(0,f.default)(u).format("0,0");return h.default.createElement(s.default,{gutter:24},!_&&a&&Object.keys(a).length>0?h.default.createElement(o.default,{xs:24,xm:24,md:24,lg:24,xl:24},h.default.createElement("div",{className:y.default.buildBox,style:{background:g.default.fetchStateBJColor(a&&a.status)}},h.default.createElement("div",{className:y.default.buildContent},h.default.createElement("div",{className:y.default.buildLeftBox},h.default.createElement("h2",{className:y.default.buildState,style:{color:g.default.fetchStateColor(a&&a.status)}},(a&&e?this.titleCase(a.status_cn):this.titleCase(a.status))||""),h.default.createElement("div",{className:y.default.buildCommitInfo},h.default.createElement("ul",{className:y.default.buildInfo},a&&"undeploy"!==a.status&&"undeploy"!==a.status&&"closed"!==a.status&&h.default.createElement("li",null,h.default.createElement("a",{target:"_blank"},g.default.fetchSvg("runTime"),h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.run"}),h.default.createElement("span",{style:{color:"rgba(0,0,0,0.45)",paddingLeft:"20px"}},a&&a.start_time?g.default.fetchTime(Date.parse(new Date)-new Date(a.start_time).getTime()):""))),h.default.createElement("li",null,h.default.createElement("a",null,g.default.fetchSvg("distributionMemory"),h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.allocation"}),!c&&h.default.createElement(h.Fragment,null,h.default.createElement(d.default,{title:E},h.default.createElement("span",{style:{color:"rgba(0,0,0,0.45)",padding:"0 20px",minWidth:"80px"}},E)),0!==u&&h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.memory"})))),h.default.createElement("li",null,h.default.createElement("a",null,g.default.fetchSvg("useDisk"),h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.occupy"}),!c&&h.default.createElement(h.Fragment,null,h.default.createElement(d.default,{title:(0,f.default)(m).format("0,0")},h.default.createElement("span",{style:{color:"rgba(0,0,0,0.45)",padding:"0 20px",minWidth:"80px"}},(0,f.default)(m).format("0,0"))),h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.disk"}))))))),h.default.createElement("div",{className:y.default.buildRightBox},h.default.createElement("h2",{className:" ".concat(y.default.en_alcen," ").concat(y.default.buildState," ")},h.default.createElement("span",{className:" ".concat(y.default.en_alcen,"  ")},g.default.fetchSvg("version"),h.default.createElement("span",{style:{color:"rgba(0,0,0,0.65)"}},h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.version"}))),h.default.createElement("span",{style:{color:l&&l.build_version?"#39aa56":"rgba(0, 0, 0, 0.45)"}},l&&l.build_version?l.build_version:h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.not"}))),h.default.createElement("div",{className:y.default.buildCommitInfo},h.default.createElement("ul",{className:y.default.buildInfo},h.default.createElement("li",null,h.default.createElement("a",{target:"_blank"},h.default.createElement("span",{className:" ".concat(y.default.en_alcen,"  ")},g.default.fetchSvg("warehouse"),v&&"source_code"===v?h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.codeVersion"}):"package_build"===v?h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.file"}):h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.warehouse.address"})),h.default.createElement(d.default,{title:l&&(l.kind&&"\u6e90\u7801\u6784\u5efa"===l.kind?l.code_version&&"":l.kind&&"\u672c\u5730\u6587\u4ef6"===l.kind?l.code_version:l.image_domain&&l.image_domain)},h.default.createElement("span",{className:y.default.buildText},l?l.kind&&"\u6e90\u7801\u6784\u5efa"===l.kind&&l.code_version&&v&&"source_code"===v?l.code_version.substr(0,8):l.kind&&"\u672c\u5730\u6587\u4ef6"===l.kind&&l.code_version&&v&&"package_build"===v?l.code_version:l.image_domain?l.image_domain:h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.not"}):h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.not"}))))),h.default.createElement("li",null,h.default.createElement("a",{target:"_blank"},h.default.createElement("span",{className:" ".concat(y.default.en_alcen,"  ")},g.default.fetchSvg("basicInfo"),v&&"source_code"===v?h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.submit"}):"package_build"===v?h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.fileName"}):h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.imageName"})),h.default.createElement(d.default,{title:l&&(l.kind&&"\u6e90\u7801\u6784\u5efa"===l.kind?l.code_commit_msg&&l.code_commit_msg:l.kind&&"\u672c\u5730\u6587\u4ef6"===l.kind?l.code_commit_msg&&l.code_commit_msg:l.image_repo&&l.image_repo)},h.default.createElement("span",{className:y.default.buildText},l?l.kind&&"\u6e90\u7801\u6784\u5efa"===l.kind?l.code_commit_msg&&l.code_commit_msg:l.kind&&"\u672c\u5730\u6587\u4ef6"===l.kind?l.code_commit_msg&&l.code_commit_msg:l.image_repo?l.image_repo:h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.not"}):h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.not"}))))),h.default.createElement("li",null,h.default.createElement("a",{target:"_blank"},h.default.createElement("span",{className:" ".concat(y.default.en_alcen,"  ")},g.default.fetchSvg("branch"),v&&"source_code"===v?h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.codeBranch"}):"package_build"===v?h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.uploadTime"}):h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.image"})),h.default.createElement(d.default,{title:l&&(l.kind&&"\u6e90\u7801\u6784\u5efa"===l.kind?l.code_branch&&l.code_branch:l.kind&&"\u672c\u5730\u6587\u4ef6"===l.kind?l.code_branch&&l.code_branch:l.image_tag&&l.image_tag)},h.default.createElement("span",{className:y.default.buildText},l?l.kind&&"\u6e90\u7801\u6784\u5efa"===l.kind?l.code_branch&&l.code_branch:l.kind&&"\u672c\u5730\u6587\u4ef6"===l.kind?l.code_branch&&l.code_branch:l.image_tag?l.image_tag:h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.not"}):h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.not"})))))),h.default.createElement("p",{className:y.default.buildAuthor},p&&p.length>0&&!n?h.default.createElement("a",{onClick:()=>{this.handleMore(!0)}},h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.moreVersion"})):!0===n&&h.default.createElement("a",{onClick:()=>{this.handleMore(!1)}},h.default.createElement(b.FormattedMessage,{id:"componentOverview.body.tab.overview.return"})))))))):!_&&h.default.createElement(i.default,{style:{margin:"0px 12px",height:170},bodyStyle:{padding:"5px 20px 5px"}},h.default.createElement(r.default,{active:!0})))}},u=m))||u),E=_;t.default=E},dhX0:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("14J3");var i=l(a("BMrR"));a("+L6B");var r=l(a("2/Rp"));a("Pwec");var o=l(a("CtXQ"));a("jCWc");var d=l(a("kPKH"));a("fOrg");var c=l(a("+KLJ"));a("/xke");var u=l(a("TeRw"));a("2qtc");var m=l(a("kLXV")),p=l(a("jehZ"));a("5NDa");var f=l(a("5rEg"));a("7Kak");var h=l(a("9yH6"));a("y8nQ");var g,v,y,b,_,E,w,M,C,S=l(a("Vl3Y")),O=a("MuoO"),k=n(a("q1tI")),A=l(a("BBei")),x=l(a("q9KF")),D=l(a("q76B")),F=l(a("cUW5")),T=l(a("rbEa")),P=l(a("puxM")),N=l(a("SgVc")),R=l(a("pkKe")),I=l(a("lpA0")),L=l(a("QDog")),V=l(a("8+Sn")),B=a("LLXN"),H=S.default.Item,q=h.default.Group,U=f.default.TextArea,z=(g=S.default.create(),g((y=class extends k.PureComponent{constructor(e){super(e),this.handleSubmit=(e=>{e.preventDefault();var t=this.props,a=t.onOk,l=t.form;l.validateFields({force:!0},(e,t)=>{!e&&a&&a(t)})}),this.handleCancel=(()=>{var e=this.props.onCancel;e&&e()}),this.state={language:"zh-CN"===V.default.get("language")}}render(){var e=this.props.form.getFieldDecorator,t={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}}},a={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},l=this.props.port||{},n=this.state.language,s=n?t:a;return k.default.createElement(m.default,{title:k.default.createElement(B.FormattedMessage,{id:"componentOverview.body.EditAlias.title"}),onOk:this.handleSubmit,maskClosable:!1,visible:!0,onCancel:this.handleCancel},k.default.createElement(S.default,{onSubmit:this.handleSubmit},k.default.createElement(H,(0,p.default)({},s,{label:k.default.createElement(B.FormattedMessage,{id:"componentOverview.body.EditAlias.label_alias"})}),e("alias",{initialValue:l.port_alias,rules:[{required:!0,message:(0,B.formatMessage)({id:"componentOverview.body.EditAlias.label_alias.message"})}]})(k.default.createElement(f.default,{placeholder:(0,B.formatMessage)({id:"componentOverview.body.EditAlias.label_alias.message"})}))),k.default.createElement(H,(0,p.default)({},s,{label:k.default.createElement(B.FormattedMessage,{id:"componentOverview.body.EditAlias.label_k8s_service_name"})}),e("k8s_service_name",{initialValue:l.k8s_service_name,rules:[{required:!0,message:(0,B.formatMessage)({id:"componentOverview.body.EditAlias.label_k8s_service_name_message"})},{max:63,message:(0,B.formatMessage)({id:"componentOverview.body.EditAlias.label_k8s_service_name.max"})},{pattern:/^[a-z]([-a-z0-9]*[a-z0-9])?$/,message:(0,B.formatMessage)({id:"componentOverview.body.EditAlias.label_k8s_service_name.pattern"})}]})(k.default.createElement(f.default,{placeholder:(0,B.formatMessage)({id:"componentOverview.body.EditAlias.label_k8s_service_name_message"})})))))}},v=y))||v),j=(b=S.default.create(),b((E=class extends k.PureComponent{constructor(e){super(e),this.handleSubmit=(e=>{e.preventDefault();var t=this.props,a=t.onOk,l=t.form;l.validateFields({force:!0},(e,t)=>{!e&&a&&a(t)})}),this.handleCancel=(()=>{var e=this.props.onCancel;e&&e()}),this.state={}}render(){var e=this.props.form.getFieldDecorator,t={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}}};return k.default.createElement(m.default,{title:k.default.createElement(B.FormattedMessage,{id:"componentOverview.body.AddKey.title"}),onOk:this.handleSubmit,visible:!0,onCancel:this.handleCancel},k.default.createElement(S.default,{onSubmit:this.handleSubmit},k.default.createElement(H,(0,p.default)({},t,{label:k.default.createElement(B.FormattedMessage,{id:"componentOverview.body.AddKey.alias"})}),e("alias",{initialValue:"",rules:[{required:!0,message:(0,B.formatMessage)({id:"componentOverview.body.AddKey.required"})},{max:64,message:(0,B.formatMessage)({id:"componentOverview.body.AddKey.max"})}]})(k.default.createElement(f.default,{placeholder:(0,B.formatMessage)({id:"componentOverview.body.AddKey.required"})}))),k.default.createElement(H,(0,p.default)({},t,{label:(0,B.formatMessage)({id:"popover.manage.certificate.label.kind"})}),e("certificate_type",{initialValue:(0,B.formatMessage)({id:"popover.manage.certificate.label.server"}),rules:[{required:!0}]})(k.default.createElement(q,null,k.default.createElement(h.default,{value:(0,B.formatMessage)({id:"popover.manage.certificate.label.server"})},(0,B.formatMessage)({id:"popover.manage.certificate.label.server"}))))),k.default.createElement(H,(0,p.default)({},t,{label:"key"}),e("private_key",{rules:[{required:!0,message:(0,B.formatMessage)({id:"componentOverview.body.AddKey.private_key"})}]})(k.default.createElement(U,{placeholder:(0,B.formatMessage)({id:"componentOverview.body.AddKey.private_key"})}))),k.default.createElement(H,(0,p.default)({},t,{label:k.default.createElement(B.FormattedMessage,{id:"componentOverview.body.AddKey.certificate"})}),e("certificate",{rules:[{required:!0,message:(0,B.formatMessage)({id:"componentOverview.body.AddKey.placeholder"})}]})(k.default.createElement(U,{placeholder:(0,B.formatMessage)({id:"componentOverview.body.AddKey.placeholder"})})))))}},_=E))||_),X=(w=(0,O.connect)(e=>{var t=e.user,a=e.appControl;return{currUser:t.currentUser,ports:a.ports,certificates:a.certificates}},null,null,{withRef:!0}),w((C=class extends k.PureComponent{constructor(e){super(e),this.onCloseInner=(e=>{this.props.dispatch({type:"appControl/closePortInner",payload:{team_name:L.default.getCurrTeamName(),app_alias:this.props.appAlias,port:e},callback:()=>{this.fetchPorts(),(!this.props.appDetail||!this.props.appDetail.is_third)&&u.default.success({message:(0,B.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0)}})}),this.onCloseOuter=(e=>{this.props.dispatch({type:"appControl/closePortOuter",payload:{team_name:L.default.getCurrTeamName(),app_alias:this.props.appAlias,port:e},callback:()=>{this.fetchPorts(),(!this.props.appDetail||!this.props.appDetail.is_third)&&u.default.success({message:(0,B.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0)}})}),this.onCancelAddDomain=(()=>{this.setState({showAddDomain:null})}),this.onAddDomain=(e=>{this.setState({showAddDomain:e})}),this.onCancelAddPort=(()=>{this.setState({showAddPort:!1})}),this.addLicense=(()=>{this.setState({page_size:this.state.page_size+10},()=>{this.fetchCertificates()})}),this.fetchPorts=(()=>{var e=this.props.dispatch;e({type:"appControl/fetchPorts",payload:{team_name:L.default.getCurrTeamName(),app_alias:this.props.appAlias}})}),this.handleSubmitProtocol=((e,t,a)=>{var l=this.props.dispatch;l({type:"appControl/changeProtocol",payload:{team_name:L.default.getCurrTeamName(),app_alias:this.props.appAlias,port:t,protocol:e},callback:()=>{this.fetchPorts(),a()}})}),this.handleDeletePort=(e=>{this.setState({showDeletePort:e})}),this.cancalDeletePort=(()=>{this.setState({showDeletePort:null})}),this.handleSubmitDeletePort=(()=>{this.props.dispatch({type:"appControl/deletePort",payload:{team_name:L.default.getCurrTeamName(),app_alias:this.props.appAlias,port:this.state.showDeletePort},callback:()=>{this.cancalDeletePort(),this.fetchPorts(),(!this.props.appDetail||!this.props.appDetail.is_third)&&u.default.success({message:(0,B.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0)}})}),this.handleDeleteDomain=(e=>{this.setState({showDeleteDomain:e})}),this.cancalDeleteDomain=(()=>{this.setState({showDeleteDomain:null})}),this.handleSubmitDeleteDomain=(()=>{this.props.dispatch({type:"appControl/unbindDomain",payload:{team_name:L.default.getCurrTeamName(),app_alias:this.props.appAlias,port:this.state.showDeleteDomain.port,domain:this.state.showDeleteDomain.domain},callback:()=>{this.cancalDeleteDomain(),this.fetchPorts(),(!this.props.appDetail||!this.props.appDetail.is_third)&&u.default.success({message:(0,B.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0)}})}),this.showAddPort=(()=>{this.setState({showAddPort:!0})}),this.showSubPort=(e=>{this.props.dispatch({type:"appControl/getSubPort",payload:{team_name:L.default.getCurrTeamName(),service_alias:this.props.appAlias,port:e.container_port},callback:t=>{var a=t&&t.list;a&&0==a.length?u.default.info({message:(0,B.formatMessage)({id:"notification.success.cannotModify"})}):this.setState({showSubPort:!0,tcp_ports:a,subPort:e.container_port})}})}),this.handleSubPort=(e=>{var t=e.port.split("||");this.props.dispatch({type:"appControl/SubPort",payload:{team_name:L.default.getCurrTeamName(),service_alias:this.props.appAlias,port:this.state.subPort,lb_mapping_port:t[1],service_id:t[0]},callback:e=>{this.setState({showSubPort:!1}),u.default.success({message:(0,B.formatMessage)({id:"notification.success.edit_port"})}),this.fetchPorts()}})}),this.hideSubPort=(()=>{this.setState({showSubPort:!1})}),this.showSubDomain=(e=>{this.setState({showSubDomain:!0,single_port:e.mapping_port}),this.props.dispatch({type:"appControl/getSubDomain",payload:{team_name:L.default.getCurrTeamName(),service_alias:this.props.appAlias},callback:e=>{e&&this.setState({sld_suffix:e.bean.sld_suffix})}})}),this.hideSubDomain=(()=>{this.setState({showSubDomain:!1})}),this.handleSubDomain=(e=>{var t="".concat(e.domain,".").concat(this.state.sld_suffix);this.props.dispatch({type:"appControl/SubDomain",payload:{team_name:L.default.getCurrTeamName(),service_alias:this.props.appAlias,domain_name:t,container_port:this.state.single_port},callback:e=>{this.setState({sld_suffix:null,showSubDomain:!1}),u.default.success({message:(0,B.formatMessage)({id:"notification.success.secondary"})}),this.fetchPorts()}})}),this.handleAddPort=(e=>{this.props.dispatch({type:"appControl/addPort",payload:{team_name:L.default.getCurrTeamName(),app_alias:this.props.appAlias,protocol:e.protocol,port:e.port},callback:()=>{this.onCancelAddPort(),this.fetchPorts(),(!this.props.appDetail||!this.props.appDetail.is_third)&&u.default.success({message:(0,B.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0)}})}),this.handleCreateKey=(()=>{this.setState({showAddDomain:null,showAddKey:!0})}),this.cancelCreateKey=(()=>{this.setState({showAddKey:!1})}),this.handleSubmitKey=(e=>{this.props.dispatch({type:"appControl/addCertificate",payload:{team_name:L.default.getCurrTeamName(),alias:e.alias,private_key:e.private_key,certificate:e.certificate,certificate_type:e.certificate_type},callback:()=>{this.cancelCreateKey(),this.fetchCertificates()}})}),this.handleOpenOuter=(e=>{this.props.dispatch({type:"appControl/openPortOuter",payload:{team_name:L.default.getCurrTeamName(),app_alias:this.props.appAlias,port:e},callback:()=>{this.fetchPorts(),(!this.props.appDetail||!this.props.appDetail.is_third)&&u.default.success({message:(0,B.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0)}})}),this.handleOpenInner=(e=>{this.props.dispatch({type:"appControl/openPortInner",payload:{team_name:L.default.getCurrTeamName(),app_alias:this.props.appAlias,port:e},callback:()=>{this.fetchPorts(),(!this.props.appDetail||!this.props.appDetail.is_third)&&u.default.success({message:(0,B.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0)}})}),this.handleAddDomain=(e=>{"httptohttps"==e.protocol&&(e.rule_extensions=[{key:e.protocol,value:"true"}]);var t=this.props.appDetail,a=this.state.showAddDomain;this.props.dispatch({type:"appControl/bindDomain",payload:{team_name:L.default.getCurrTeamName(),app_alias:this.props.appAlias,port:a.container_port,domain:e.domain,protocol:e.protocol,certificate_id:e.certificate_id,group_id:t.service.group_id,rule_extensions:e.rule_extensions?e.rule_extensions:[]},callback:()=>{this.fetchPorts(),this.onCancelAddDomain()}})}),this.showEditAlias=(e=>{this.setState({showEditAlias:e})}),this.hideEditAlias=(()=>{this.setState({showEditAlias:null})}),this.handleEditAlias=(e=>{this.props.dispatch({type:"appControl/editPortAlias",payload:{team_name:L.default.getCurrTeamName(),app_alias:this.props.appAlias,k8s_service_name:e.k8s_service_name,port:this.state.showEditAlias.container_port,port_alias:e.alias},callback:()=>{this.fetchPorts(),this.hideEditAlias(),(!this.props.appDetail||!this.props.appDetail.is_third)&&u.default.success({message:(0,B.formatMessage)({id:"notification.success.operationToUpdate"})}),this.props.onshowRestartTips(!0)}})}),this.state={showDeletePort:null,showDeleteDomain:null,showAddPort:!1,showAddDomain:null,showAddKey:!1,showEditAlias:null,showSubDomain:!1,showSubPort:!1,sld_suffix:"",single_port:null,tcp_ports:[],subPort:"",page:1,page_size:10,isAddLicense:!1}}componentDidMount(){this.fetchPorts(),this.fetchCertificates()}fetchCertificates(){var e=this.props.dispatch,t=this.state,a=t.page,l=t.page_size;e({type:"appControl/fetchCertificates",payload:{page:a,page_size:l,team_name:L.default.getCurrTeamName()},callback:e=>{if(e&&e.list){var t=e.bean&&e.bean.nums||0,a=!!(t&&t>l);this.setState({isAddLicense:a})}}})}canView(){var e=this.props.componentPermissions.isPort;return e}render(){var e=this.props,t=e.ports,a=e.certificates,l=e.appDetail,n=this.state.isAddLicense,u=I.default.isImageApp(l),m=I.default.isDockerfile(l);if(!this.canView())return k.default.createElement(F.default,null);var p=l.service&&"helm"===l.service.component_type;return k.default.createElement(k.Fragment,null,k.default.createElement(i.default,null,k.default.createElement(d.default,{span:13},k.default.createElement(c.default,{showIcon:!0,message:k.default.createElement(B.FormattedMessage,{id:"componentOverview.body.Port.message"}),type:"info",style:{marginBottom:24}})),!p&&k.default.createElement(d.default,{span:11,style:{textAlign:"right"}},k.default.createElement(r.default,{onClick:this.showAddPort,type:"primary"},k.default.createElement(o.default,{type:"plus"}),k.default.createElement(B.FormattedMessage,{id:"componentOverview.body.Port.add"})))),t.length?k.default.createElement(s.default,null,k.default.createElement(P.default,{sm:700},t.map(e=>k.default.createElement(T.default,{port:e,onDelete:this.handleDeletePort,onEditAlias:this.showEditAlias,onSubmitProtocol:this.handleSubmitProtocol,onOpenInner:this.handleOpenInner,onCloseInner:this.onCloseInner,onOpenOuter:this.handleOpenOuter,onCloseOuter:this.onCloseOuter,onAddDomain:this.onAddDomain,onDeleteDomain:this.handleDeleteDomain,onSubDomain:this.showSubDomain,onSubPort:this.showSubPort})))):k.default.createElement(s.default,null,k.default.createElement("p",{style:{marginTop:100,marginBottom:100,fontSize:20,textAlign:"center"}},k.default.createElement(B.FormattedMessage,{id:"componentOverview.body.Port.msg"}),k.default.createElement("a",{onClick:this.showAddPort,href:"javascript:;"},k.default.createElement(B.FormattedMessage,{id:"componentOverview.body.Port.addMsg"})))),this.state.showDeletePort&&k.default.createElement(D.default,{title:k.default.createElement(B.FormattedMessage,{id:"confirmModal.deldete.port.title"}),desc:k.default.createElement(B.FormattedMessage,{id:"confirmModal.deldete.port.desc"}),subDesc:k.default.createElement(B.FormattedMessage,{id:"confirmModal.deldete.port.subDesc"}),onOk:this.handleSubmitDeletePort,onCancel:this.cancalDeletePort}),this.state.showDeleteDomain&&k.default.createElement(D.default,{title:k.default.createElement(B.FormattedMessage,{id:"confirmModal.deldete.unbound.title"}),desc:k.default.createElement(B.FormattedMessage,{id:"confirmModal.deldete.unbound.desc"}),subDesc:this.state.showDeleteDomain.domain,onOk:this.handleSubmitDeleteDomain,onCancel:this.cancalDeleteDomain}),this.state.showAddPort&&k.default.createElement(x.default,{isImageApp:u,isDockerfile:m,onCancel:this.onCancelAddPort,onOk:this.handleAddPort}),this.state.showAddDomain&&k.default.createElement(A.default,{addLicense:this.addLicense,isAddLicense:n,certificates:a||[],onCreateKey:this.handleCreateKey,onOk:this.handleAddDomain,onCancel:this.onCancelAddDomain}),this.state.showAddKey&&k.default.createElement(j,{onOk:this.handleSubmitKey,onCancel:this.cancelCreateKey}),this.state.showEditAlias&&k.default.createElement(z,{port:this.state.showEditAlias,onOk:this.handleEditAlias,onCancel:this.hideEditAlias}),this.state.showSubDomain&&k.default.createElement(N.default,{sld_suffix:this.state.sld_suffix,onCancel:this.hideSubDomain,onOk:this.handleSubDomain}),this.state.showSubPort&&k.default.createElement(R.default,{postList:this.state.tcp_ports,onCancel:this.hideSubPort,onOk:this.handleSubPort}))}},M=C))||M);t.default=X},fyL3:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAYAAAAmlE46AAACHklEQVQ4T2P8////fwYk8O//f4atuw4wzFu6hkFeVpqhMCMeTKMDRmSNR06cZZg6dymDqaEuQ2pcGMO9B48Z+mcsZFCUk2bITo5mEBEWhOsHa7x87RZD/4wFDDKS4gw5KTEMYqLCKBYcPHqKYdq85QxWZoYMyTEhDDzcXAyMJfWd/z9//spQnpfKoCgvg+EkmMC/f/8YNu3YxzBn8WqGsrxUBkYbr6j/4qJCYKc42lrg1Pjl6zeGSbMWM9x7+JihoSyHgTEhp+J/f0sVQ++0eQzvP3xkqCrMYJCSEEMxYNvugwxzl65hSI4OYfBytQfLgTW21RQxXL52k0FMVIShc+IsBgcbc4akqGCGp89fMrT0TWdQlJNhyE+PA/sNBIpq2yEap/c0MHRPnsvw4tVrhpriLIY9B48xrN28k4GXhwfsAk01JRQXJOZWQjTOn9wOljh/6RrDh4+fGRxtzRmaeqYyxIb5g21DBxgakRXQTqNfdOb/srwUBmszIxQX4bJx76HjDJNmLWJgfPv+w//WvhkMbKysDBX5qQz8fLxgA9A1Pnn2gqG1fwaDmLAQQ1FWIgM8rR44epJh8uwlDGnx4QzujjZwjdIS4gxzl6xmOHziLENFQRqDnpY6JB6REzkodXRPmcvw/v1HBgZGBgZzY32GDdv2MAR4uTBEBnkzMDExoSZy9OA+ff4yQ23bRAY9bXWG8rwUBmEhRK6AqQUAXGTiVB7mEmUAAAAASUVORK5CYII="},gOyy:function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=n(a("kLXV"));a("g9YV");var i=n(a("wCAj"));a("5Dmo");var r=n(a("3S7+"));a("+L6B");var o=n(a("2/Rp")),d=l(a("q1tI")),c=n(a("e6Ls")),u=n(a("QDog")),m=a("7DNP"),p=a("LLXN");class f extends d.PureComponent{render(){var e=this.props,t=e.title,a=e.onOk,l=e.onCancel,n=e.relyComponentList;e.loading;return d.default.createElement(s.default,{width:800,title:t,visible:!0,onOk:a,onCancel:l,className:c.default.TelescopicModal,footer:[d.default.createElement(o.default,{onClick:l},d.default.createElement(p.FormattedMessage,{id:"componentOverview.body.RelyComponentModal.close"})," ")]},d.default.createElement(i.default,{pagination:!1,style:{marginBottom:"20px"},columns:[{title:(0,p.formatMessage)({id:"componentOverview.body.RelyComponentModal.volume_name"}),dataIndex:"volume_name",width:"50%",key:"volume_name"},{title:(0,p.formatMessage)({id:"componentOverview.body.RelyComponentModal.service_name"}),dataIndex:"service_name",key:"service_name",width:"50%",render:(e,t)=>d.default.createElement(r.default,{title:e,key:e},d.default.createElement(m.Link,{to:"/team/".concat(u.default.getCurrTeamName(),"/region/").concat(u.default.getCurrRegionName(),"/components/").concat(t.service_alias,"/overview"),title:e},d.default.createElement("span",null,e)))}],dataSource:n}))}}var h=f;t.default=h},giye:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV")),i=l(a("jehZ"));a("giR+");var r=l(a("fyUT"));a("+L6B");var o=l(a("2/Rp"));a("OaEy");var d=l(a("2fM7"));a("y8nQ");var c,u,m,p=l(a("Vl3Y")),f=a("MuoO"),h=n(a("q1tI")),g=l(a("fyL3")),v=l(a("P5R6")),y=l(a("bLLg")),b=l(a("8+Sn")),_=l(a("ioek")),E=a("LLXN"),w=p.default.Item,M=d.default.Option,C=(c=(0,f.connect)(e=>{var t=e.loading;return{changeScalingRules:t.effects["appControl/changeScalingRules"],addScalingRules:t.effects["appControl/addScalingRules"]}}),c((m=class extends h.PureComponent{constructor(e){super(e),this.handleSubmit=(e=>{e.preventDefault();var t=this.props.onOk;this.props.form.validateFields((e,a)=>{e||t&&t(a)})}),this.setMetric_target_value=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=0;return e&&e.length>0&&e.map(e=>{var n=e.metric_name,s=e.metric_target_value,i=e.metric_target_type;if(t===n)return l=a?i:s,s}),void 0===l?0:l},this.checkContent=((e,t,a)=>{var l=1,n=Number(t);if(n||0===n){if(n<l)return void a(h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.input_min",values:{num:n}}));if(n>65535)return void a(h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.input_max"}))}a()}),this.state={selectMemoryList:[{value:"memoryaverage_value",name:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.memory_usage"})},{value:"memoryutilization",name:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.memory_rate"})},{value:"cpuaverage_value",name:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.usage"})},{value:"cpuutilization",name:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.rate"})}],language:"zh-CN"===b.default.get("language")}}render(){var e=this.props,t=e.isvisable,a=e.onClose,l=e.editRules,n=e.data,c=e.isaddindicators,u=e.memoryList,m=this.props.form,f=m.getFieldDecorator,b=m.getFieldValue,C=this.state,S=C.selectMemoryList,O=C.language,k=n||!1,A=b("minNum")||0,x=b("selectMemory"),D={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}}},F={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},T=O?D:F;return h.default.createElement("div",null,h.default.createElement(s.default,{className:_.default.TelescopicModal,title:l?h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.add_indicator"}):h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.flex"}),visible:t,onOk:this.handleSubmit,onCancel:a,footer:[h.default.createElement(o.default,{type:"primary",onClick:this.handleSubmit},h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.determine"}))]},h.default.createElement(p.default,{layout:"horizontal",hideRequiredMark:!0,onSubmit:this.handleSubmit},!c&&h.default.createElement(w,(0,i.default)({className:_.default.clearConform,label:h.default.createElement("div",{className:_.default.clearConformMinTitle},h.default.createElement("img",{src:v.default,alt:""}),h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.minimum_quantity"}),"\xa0:")},T,{style:{textAlign:"left"}}),f("minNum",{initialValue:1,rules:[{pattern:new RegExp(/^[0-9]\d*$/,"g"),message:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.number"})},{required:!0,message:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.placese_input_min"})},{validator:this.checkContent}]})(h.default.createElement(r.default,{style:{width:"100%"},placeholder:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.placese_input_min"})})),h.default.createElement("div",{className:_.default.conformDesc},h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.lower_limit"})," ")),!c&&h.default.createElement(w,(0,i.default)({className:_.default.clearConform,label:h.default.createElement("div",{className:_.default.clearConformMinTitle},h.default.createElement("img",{src:y.default,alt:""}),h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.max"}),"\xa0:")},T,{style:{textAlign:"left"}}),f("maxNum",{initialValue:k?k.max_replicas:1,rules:[{pattern:new RegExp(/^[0-9]\d*$/,"g"),message:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.number"})},{required:!0,message:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.placese_input_max"})},{validator:this.checkContent}]})(h.default.createElement(r.default,{placeholder:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.placese_input_max"}),style:{width:"100%"},min:A})),h.default.createElement("div",{className:_.default.conformDesc},h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.upper_limit"})," ")),h.default.createElement(w,(0,i.default)({className:_.default.clearConform},T,{label:h.default.createElement("div",{className:_.default.clearConformMinTitle},h.default.createElement("img",{src:g.default,alt:""}),h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.index"})," \xa0:"),style:{textAlign:"left"}}),f("selectMemory",{initialValue:c&&u&&u.length>0?u[0].value:"memoryaverage_value",rules:[{required:!0,message:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.select_needs"})}]})(h.default.createElement(d.default,{getPopupContainer:e=>e.parentNode},(c&&u&&u.length>0?u:S).map(e=>{return h.default.createElement(M,{value:e.value,key:e.value},e.name)})))),h.default.createElement(w,(0,i.default)({className:_.default.clearConform,label:h.default.createElement("div",{className:_.default.clearConformMinTitle},h.default.createElement("img",{src:y.default,alt:""}),h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.target_value"}),"\xa0:")},T,{style:{textAlign:"left"}}),f("value",{initialValue:k?k.max_replicas:1,rules:[{pattern:new RegExp(/^[0-9]\d*$/,"g"),message:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.number"})},{required:!0,message:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.number"})},{validator:this.checkContent}]})(h.default.createElement(r.default,{placeholder:(0,E.formatMessage)({id:"componentOverview.body.Expansion.AddScaling.number"}),min:1,max:65535,style:{width:"100%"}})),h.default.createElement("div",{className:_.default.conformDesc},h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.dang"}),"memoryaverage_value"===x||"memoryutilization"===x?h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.Memory"}):"cpu",h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.use"}),"memoryaverage_value"===x||"cpuaverage_value"===x?h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.amount"}):h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.rate_unit"}),h.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Expansion.AddScaling.numberOfInstances"}))))))}},u=m))||u),S=p.default.create()(C),O=S;t.default=O},hJQD:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("fOrg");var s=l(a("+KLJ"));a("IzEo");var i=l(a("bx4M"));a("Pwec");var r=l(a("CtXQ"));a("qVdP");var o=l(a("jsC+"));a("lUTK");var d=l(a("BvKs"));a("g9YV");var c=l(a("wCAj"));a("2qtc");var u=l(a("kLXV"));a("5Dmo");var m=l(a("3S7+"));a("+L6B");var p=l(a("2/Rp"));a("/xke");var f,h,g,v=l(a("TeRw")),y=a("MuoO"),b=a("7DNP"),_=n(a("q1tI")),E=a("P5Jw"),w=l(a("QDog")),M=a("+n12"),C=a("LLXN"),S=l(a("YAxI")),O=(f=(0,y.connect)(e=>{var t=e.user,a=e.appControl;e.global;return{visitInfo:a.visitInfo,currUser:t.currentUser}}),f((g=class extends _.PureComponent{constructor(e){super(e),this.getHttpLinks=(e=>{var t=[];if(e.length>0)for(var a=0;a<e.length;a++)t=t.concat(e[a].access_urls||[]);return t}),this.showModal=(()=>{this.setState({showModal:!0})}),this.hiddenModal=(()=>{this.setState({showModal:!1})}),this.fetchVisitInfo=(()=>{if(this.mount){var e=this.props,t=e.app_alias,a=e.dispatch;a({type:"appControl/fetchVisitInfo",payload:{team_name:w.default.getCurrTeamName(),app_alias:t},callback:e=>{e&&200===e.status_code&&this.handleTimers("timer",()=>{this.fetchVisitInfo()},5e3)},handleError:e=>{this.handleError(e),this.handleTimers("timer",()=>{this.fetchVisitInfo()},1e4)}})}}),this.handleError=(e=>{var t=this.state.componentTimers;if(!t)return null;e&&e.data&&e.data.msg_show&&v.default.warning({message:(0,C.formatMessage)({id:"notification.warn.error"}),description:e.data.msg_show})}),this.handleTimers=((e,t,a)=>{var l=this.state.componentTimers;if(!l)return null;this[e]=setTimeout(()=>{t()},a)}),this.closeTimer=(()=>{this.timer&&clearInterval(this.timer)}),this.handleClickLink=(e=>{(0,M.openInNewTab)(e.key)}),this.renderNoHttpOuterTitle=(e=>_.default.createElement("div",null,_.default.createElement("span",{style:{marginRight:16}},"\u8bbf\u95ee\u5730\u5740\uff1a",e.access_urls[0]),_.default.createElement("span",null,"\u8bbf\u95ee\u534f\u8bae\uff1a ",e.protocol))),this.renderNoPort=(e=>{var t=this.state.showModal,a=this.props.app_alias;return _.default.createElement(_.Fragment,null,_.default.createElement(m.default,{title:(0,C.formatMessage)({id:"tooltip.visit"}),placement:"topRight"},_.default.createElement(p.default,{type:this.props.btntype,onClick:this.showModal},_.default.createElement(C.FormattedMessage,{id:"componentOverview.header.right.visit"}))),t&&_.default.createElement(u.default,{title:"\u63d0\u793a",visible:!0,onCancel:this.hiddenModal,footer:[_.default.createElement(p.default,{onClick:this.hiddenModal}," \u5173\u95ed ")]},_.default.createElement("div",{style:{textAlign:"center",fontSize:16}},"\u5982\u9700\u8981\u63d0\u4f9b\u8bbf\u95ee\u670d\u52a1, \u8bf7",_.default.createElement(b.Link,{onClick:this.hiddenModal,to:"/team/".concat(w.default.getCurrTeamName(),"/region/").concat(w.default.getCurrRegionName(),"/components/").concat(a,"/port")},"\u914d\u7f6e\u7aef\u53e3"))))}),this.showConnectInfo=(e=>{return _.default.createElement(c.default,{rowKey:this.rowKey,className:S.default.tdPadding,bordered:!0,columns:[{title:"\u53d8\u91cf\u540d",dataIndex:"attr_name",key:"attr_name",align:"center"},{title:"\u53d8\u91cf\u503c",dataIndex:"attr_value",key:"attr_value",align:"center"},{title:"\u8bf4\u660e",dataIndex:"name",key:"name",align:"center"}],pagination:!1,dataSource:e,bordered:!1})}),this.renderHttpPort=(e=>{var t=this.state.showModal,a=e,l=this.props.app_alias,n=this.getHttpLinks(a.access_info||{});return 1===n.length?_.default.createElement(m.default,{title:(0,C.formatMessage)({id:"tooltip.visit"})},_.default.createElement(p.default,{type:this.props.btntype,onClick:()=>{(0,M.openInNewTab)(n[0])}},_.default.createElement(C.FormattedMessage,{id:"componentOverview.header.right.visit"}))):0===n.length?_.default.createElement(_.Fragment,null,_.default.createElement(m.default,{title:(0,C.formatMessage)({id:"tooltip.visit"}),placement:"topRight"},_.default.createElement(p.default,{type:this.props.btntype,onClick:this.showModal},_.default.createElement(C.FormattedMessage,{id:"componentOverview.header.right.visit"}))),t&&_.default.createElement(u.default,{title:"\u63d0\u793a",visible:!0,onCancel:this.hiddenModal,footer:[_.default.createElement(p.default,{onClick:this.hiddenModal}," \u5173\u95ed ")]},_.default.createElement("div",{style:{textAlign:"center",fontSize:16}},"http\u534f\u8bae\u7aef\u53e3\u9700\u6253\u5f00\u5916\u90e8\u8bbf\u95ee\u670d\u52a1, \u53bb",_.default.createElement(b.Link,{onClick:this.hiddenModal,to:"/team/".concat(w.default.getCurrTeamName(),"/region/").concat(w.default.getCurrRegionName(),"/components/").concat(l,"/port")},"\u6253\u5f00")))):_.default.createElement(m.default,{title:(0,C.formatMessage)({id:"tooltip.visit"}),placement:"topRight"},_.default.createElement(o.default,{overlay:_.default.createElement(d.default,{onClick:this.handleClickLink},n.map(e=>_.default.createElement(d.default.Item,{key:e},e))),placement:"bottomRight"},_.default.createElement(p.default,{type:this.props.btntype},_.default.createElement("a",{href:n[0],target:"_blank"},_.default.createElement(C.FormattedMessage,{id:"componentOverview.header.right.visit"})))))}),this.renderNofHttpOuter=(e=>{var t=this.state.showModal,a=e,l=(this.props.app_alias,a.access_info||[]),n=_.default.createElement(p.default,{onClick:this.hiddenModal},"\u5173\u95ed"),s=[n],o=this.props.currUser.teams[0].region,d=o.filter(e=>{return e.team_region_name==w.default.getCurrRegionName()});return _.default.createElement(_.Fragment,null,_.default.createElement(m.default,{title:(0,C.formatMessage)({id:"tooltip.visit"}),placement:"topRight"},_.default.createElement(p.default,{type:this.props.btntype,onClick:this.showModal},_.default.createElement(C.FormattedMessage,{id:"componentOverview.header.right.visit"}))),t&&_.default.createElement(u.default,{title:"\u8bbf\u95ee\u4fe1\u606f",width:"800px",visible:!0,onCancel:this.hiddenModal,footer:s},l.map((e,t)=>{var a=e.connect_info||[],l=e.access_urls&&e.access_urls.length>0&&e.access_urls[0];return _.default.createElement(i.default,{type:"inner",style:{marginBottom:24}},_.default.createElement(_.Fragment,null,_.default.createElement("ul",{className:S.default.ul},"tcp"==e.protocol||"udp"==e.protocol?_.default.createElement("li",{style:{fontWeight:"bold"}},"\u60a8\u5f53\u524d\u7684\u8bbf\u95ee\u534f\u8bae\u662f",e.protocol):_.default.createElement("li",{style:{fontWeight:"bold"}},"\u60a8\u5f53\u524d\u7684\u8bbf\u95ee\u534f\u8bae\u662f",e.protocol,",\u6253\u5f00MySQL\u5ba2\u6237\u7aef\u8bbf\u95ee"),_.default.createElement("li",null,"\u63a8\u8350\u8bbf\u95ee\u5730\u5740\xa0",_.default.createElement("a",{href:"javascript:void(0)",style:{marginRight:"10px"}},l&&l.indexOf("0.0.0.0")>-1&&d&&d.length>0?l&&l.replace(/0.0.0.0/g,d[0].tcpdomain):l&&l.replace(/\s+/g,"")),_.default.createElement(E.CopyToClipboard,{text:l&&l.indexOf("0.0.0.0")>-1&&d&&d.length>0?l&&l.replace(/0.0.0.0/g,d[0].tcpdomain):l&&l.replace(/\s+/g,""),onCopy:()=>{v.default.success({message:(0,C.formatMessage)({id:"notification.success.copy"})})}},_.default.createElement(p.default,{size:"small",type:"primary"},_.default.createElement(r.default,{type:"copy"}),"\u590d\u5236"))),this.showConnectInfo(a))))})))}),this.renderNotHttpInner=(e=>{var t=this.state.showModal,a=e,l=(this.props.app_alias,a.access_info||[]),n=_.default.createElement(p.default,{onClick:this.hiddenModal},"\u5173\u95ed"),r=[n];function o(e){return _.default.createElement("div",null,_.default.createElement("span",null,"\u8bbf\u95ee\u534f\u8bae\uff1a",e.protocol))}function d(e,t){var a=e.connect_info||[];return _.default.createElement(i.default,{type:"inner",style:{marginBottom:24},title:o(e)},e.connect_info.length?_.default.createElement(_.Fragment,null,_.default.createElement("table",{style:{width:"100%"}},_.default.createElement("thead",null,_.default.createElement("tr",null,_.default.createElement("th",{style:{width:"33%"}},"\u53d8\u91cf\u540d"),_.default.createElement("th",{style:{width:"33%"}},"\u53d8\u91cf\u503c"),_.default.createElement("th",null,"\u8bf4\u660e"))),_.default.createElement("tbody",null,a.map(e=>_.default.createElement("tr",null,_.default.createElement("td",{width:"150"},e.attr_name),_.default.createElement("td",null,e.attr_value),_.default.createElement("td",null,e.name))),a.length?null:_.default.createElement("tr",null,_.default.createElement("td",{colSpan:"3",style:{textAlign:"center"}},"\u6682\u65e0\u6570\u636e"))))):"-")}return _.default.createElement(_.Fragment,null,_.default.createElement(m.default,{title:(0,C.formatMessage)({id:"tooltip.visit"}),placement:"topRight"},_.default.createElement(p.default,{type:this.props.btntype,onClick:this.showModal},_.default.createElement(C.FormattedMessage,{id:"componentOverview.header.right.visit"}))),t&&_.default.createElement(u.default,{title:"\u8bbf\u95ee\u4fe1\u606f",width:"800px",visible:!0,onCancel:this.hiddenModal,footer:r},_.default.createElement(s.default,{style:{marginBottom:16},message:"\u5176\u4ed6\u7ec4\u4ef6\u4f9d\u8d56\u6b64\u7ec4\u4ef6\u540e\u6765\u8bbf\u95ee",type:"info"})," ",l.map((e,t)=>d(e,t))))}),this.state={showModal:!1,componentTimers:this.props.timers},this.mount=!1}componentDidMount(){this.mount=!0,this.fetchVisitInfo()}componentWillReceiveProps(e){var t=e.timers,a=this.props.timers;t!==a&&this.setState({componentTimers:t},()=>{t?this.fetchVisitInfo():this.closeTimer()})}componentWillUnmount(){this.closeTimer(),this.mount=!1,this.props.dispatch({type:"appControl/clearVisitInfo"})}render(){var e=this.props.visitInfo;return e?"no_port"==e.access_type?this.renderNoPort(e):"http_port"===e.access_type?this.renderHttpPort(e):"not_http_outer"===e.access_type?this.renderNofHttpOuter(e):"not_http_inner"===e.access_type||"http_inner"===e.access_type?this.renderNotHttpInner(e):null:null}},h=g))||h);t.default=O},iLo2:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var s=l(a("BMrR"));a("jCWc");var i=l(a("kPKH"));a("+L6B");var r=l(a("2/Rp")),o=l(a("jehZ"));a("y8nQ");var d=l(a("Vl3Y"));a("iQDF");var c,u,m,p,f=l(a("+eQT")),h=a("MuoO"),g=l(a("wd/R")),v=n(a("q1tI")),y=a("LLXN"),b=a("YJCA"),_=l(a("YUe+")),E=l(a("UTiu")),w=f.default.RangePicker,M=(c=(0,h.connect)(e=>{var t=e.user,a=e.appControl,l=e.loading;return{currUser:t.currentUser,appDetail:a.appDetail,baseInfo:a.baseInfo,editLoading:l.effects["monitor/editServiceMonitorFigure"]}}),u=d.default.create(),c(m=u((p=class extends v.PureComponent{constructor(e){super(e),this.disabledDate=(e=>{return e&&e>(0,g.default)().endOf("day")}),this.range=((e,t)=>{for(var a=[],l=e;l<t;l++)a.push(l);return a}),this.queryAll=(()=>{this.setState({isRender:!0},()=>{this.setState({isRender:!1})})}),this.onSortEnd=((e,t)=>{var a=e.oldIndex,l=e.newIndex;t.preventDefault();var n=this.props,s=n.handleSorting,i=n.RangeData,r=void 0===i?[]:i;if(a!==l&&r&&r.length>0){var o=(0,b.arrayMove)(r,a,l),d=[];o.map(e=>{d.push(e.graph_id)}),s(d)}}),this.handleChangeTimes=(e=>{var t="",a="";e&&e.length>1&&(t=(0,g.default)(e[0]).valueOf()/1e3,a=(0,g.default)(e[1]).valueOf()/1e3),this.setState({start:t,end:a},()=>{this.props.handleUpData&&this.props.handleUpData()})}),this.state={start:(new Date).getTime()/1e3-3600,end:(new Date).getTime()/1e3,isLoading:!0,isRender:!1}}shouldComponentUpdate(e,t){if(e.moduleName&&"CustomMonitor"===e.moduleName){if(e.isRender||t.isRender)return!0;if(e.RangeData.length==this.props.RangeData.length)return!1}return!0}render(){var e=this.props,t=e.appDetail,a=e.dispatch,l=e.moduleName,n=e.operation,d=e.onDelete,c=e.onEdit,u=e.upData,m=e.baseInfo,p=e.serviceId,f=void 0===p?"":p,h=e.RangeData,M=void 0===h?[]:h,C=e.appAlias,S=void 0===C?"":C,O=this.state,k=O.start,A=O.end,x=O.isLoading,D=O.isRender,F={moduleName:l,start:k,end:A,dispatch:a,appDetail:t,baseInfo:m,appAlias:S},T=(0,b.SortableElement)(e=>{var t=e.value,a=t.title,l=t.promql,n=t.sequence,s=t.ID;return v.default.createElement("div",{key:s,index:n,className:_.default.RangeChartBox},v.default.createElement(E.default,(0,o.default)({key:s,moduleName:"CustomMonitor",style:{cursor:"all-scroll"}},F,{upData:u,onCancelLoading:this.setState({isLoading:!1}),isLoading:x,serviceId:f,isRender:D,CustomMonitorInfo:t,title:a,type:l,onEdit:c,onDelete:d})))}),P={display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gridGap:"16px"},N=(0,b.SortableContainer)(e=>{var t=e.items;return v.default.createElement("div",{style:P},t.map(e=>{return v.default.createElement(T,{style:{zIndex:10},key:e.ID,index:e.sequence,value:e})}))});return v.default.createElement(v.Fragment,null,v.default.createElement(s.default,null,v.default.createElement(i.default,{span:24,className:_.default.customBox},v.default.createElement(w,{separator:v.default.createElement(y.FormattedMessage,{id:"componentOverview.body.tab.monitor.to"}),style:{width:"390px"},disabledDate:this.disabledDate,onChange:e=>{this.handleChangeTimes(e)},defaultValue:[(0,g.default)(new Date((new Date).getTime()-36e5),"HH:mm:ss"),(0,g.default)((0,g.default)(new Date),"HH:mm:ss")],showTime:{hideDisabledOptions:!0},format:"YYYY-MM-DD HH:mm:ss"}),v.default.createElement(r.default,{style:{marginLeft:"5px"},onClick:this.queryAll},v.default.createElement(y.FormattedMessage,{id:"componentOverview.body.tab.monitor.query"})),n)),"ResourceMonitoring"===l?v.default.createElement(s.default,{style:{padding:"-8px"}},M.map((e,t)=>{return v.default.createElement(i.default,{span:12,key:e,style:{padding:(t+1)%2==0?"8px 0px 8px 8px":"8px 8px 8px 0 "}},v.default.createElement(E.default,(0,o.default)({},F,{type:e})))})):"CustomMonitor"===l?v.default.createElement("div",{style:{marginTop:"20px"}},v.default.createElement(N,{axis:"xy",distance:1,style:{zIndex:10},items:M,onSortEnd:this.onSortEnd})):M.map(e=>{return v.default.createElement("div",{style:{marginTop:"20px"}},v.default.createElement(E.default,(0,o.default)({key:e},F,{type:e})))}))}},m=p))||m)||m);t.default=M},ioek:function(e,t,a){e.exports={selectItem:"selectItem___2GuvK",conformDesc:"conformDesc___ztJtX",setSelect:"setSelect___2_bNW",clearConform:"clearConform___SiofZ",TelescopicModal:"TelescopicModal___3Jus_",clearConformMinTitle:"clearConformMinTitle___2EO54"}},k3y4:function(e,t,a){e.exports={cen:"cen___2Fxyu"}},ll25:function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var s=n(a("2/Rp"));a("+BJd");var i=n(a("mr32")),r=l(a("q1tI")),o=i.default.CheckableTag;class d extends r.default.Component{constructor(e){super(e),this.handleSelectAll=(e=>{var t=this.getGroupPerm(e).map(e=>{return e.id}),a=this.props.onChange;t=t.filter(e=>{return-1===this.state.selected.indexOf(e)}),this.setState({selected:this.state.selected.concat(t)},()=>{a&&a(this.state.selected.join(","))})}),this.isInGroup=((e,t)=>{var a=this.props.datas.filter(e=>{return e.group_name===t})[0];return!!a&&(a=(a.perms_info||[]).map(e=>{return e.id}),a.indexOf(e)>-1)}),this.getGroupPerm=(e=>{var t=this.props.datas,a=t.filter(t=>{return t.group_name===e})[0];return a&&a.perms_info||[]}),this.handleUnSelectAll=(e=>{var t=this.state.selected.filter(t=>{return!this.isInGroup(t,e)}),a=this.props.onChange;this.setState({selected:t},()=>{a&&a(this.state.selected.join(","))})}),this.handleChange=((e,t)=>{var a=this.props.onChange,l=e.id;if(t)this.setState({selected:this.state.selected.concat([l])},()=>{a&&a(this.state.selected.join(","))});else{var n=this.state.selected.filter(e=>{return e!==l});this.setState({selected:n},()=>{a&&a(this.state.selected.join(","))})}});var t=this.props.value;this.state={selected:t||[]}}componentDidMount(){var e=this.props.onChange;e&&e(this.state.selected.join(","))}render(){var e=this.props,t=e.datas,a=(e.value,e.onChange,this.props.hides||[]);return r.default.createElement("div",null,t.map(e=>{return a.indexOf(e.group_name)>-1?null:e.perms_info.length?r.default.createElement("dl",null,r.default.createElement("dt",null,!1!==this.props.showGroupName?e.group_name:""," ",r.default.createElement(s.default,{style:{marginLeft:16},size:"small",onClick:()=>{this.handleSelectAll(e.group_name)},style:{marginRight:8}},"\u5168\u9009"),r.default.createElement(s.default,{onClick:()=>{this.handleUnSelectAll(e.group_name)},size:"small"},"\u53d6\u6d88\u5168\u9009")),r.default.createElement("dd",null,e.perms_info.map(e=>{return r.default.createElement(o,{key:e.id,checked:this.state.selected.indexOf(e.id)>-1,onChange:t=>{this.handleChange(e,t)}},e.info)}))):null}))}}var c=d;t.default=c},mKRI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l={isStart(e){return 1===e.plugin_status||!0===e.plugin_status},isStop(e){return 0===e.plugin_status||!e.plugin_status}};t.default=l},nIwP:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a("jehZ"));a("14J3");var i=l(a("BMrR"));a("qVdP");var r=l(a("jsC+"));a("Pwec");var o=l(a("CtXQ"));a("lUTK");var d=l(a("BvKs"));a("+L6B");var c=l(a("2/Rp"));a("/xke");var u,m,p,f=l(a("TeRw")),h=l(a("p0pE")),g=l(a("QDog")),v=l(a("2U5Y")),y=l(a("q76B")),b=l(a("iLo2")),_=l(a("Pp4N")),E=l(a("ALo4")),w=a("MuoO"),M=n(a("q1tI")),C=l(a("AFhn")),S=a("LLXN"),O=(u=(0,w.connect)(e=>{var t=e.appControl,a=e.loading;return{appDetail:t.appDetail,delServiceMonitorFigureLoading:a.effects["monitor/delServiceMonitorFigure"],addKeyImportLoading:a.effects["monitor/addKeyImport"],delLoading:a.effects["monitor/batchDeleteServiceMonitorFigure"]}}),u((p=class extends M.PureComponent{constructor(e){var t;super(e),t=this,this.onCancelCustomMonitoring=(()=>{this.setState({info:{},isCustomMonitoring:!1})}),this.onEdit=((e,t)=>{e.preventDefault(),this.setState({info:t,isCustomMonitoring:!0})}),this.onDelete=(e=>{this.setState({showDelete:e.graph_id})}),this.handleMonitoryPoint=(e=>{this.setState({isMonitoryPoint:e})}),this.handleCustomMonitoring=(()=>{this.setState({isCustomMonitoring:!0})}),this.fetchServiceMonitorFigure=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],a=t.props.dispatch,l=t.handleParameter();a({type:"monitor/fetchServiceMonitorFigure",payload:(0,h.default)({},l),callback:a=>{if(a&&200===a.status_code){var l=a.list&&a.list.length>0;t.setState({monitorFigureList:l?a.list:[],isMonitorFigure:!l}),e||t.handleUpData(),t.cancalBatchDelete()}}})},this.fetchKeyImport=(()=>{var e=this.props.dispatch,t=this.handleParameter();e({type:"monitor/fetchKeyImport",payload:(0,h.default)({},t),callback:e=>{e&&200===e.status_code&&this.setState({KeyImportLoading:!1,KeyImportList:e.list})}})}),this.addKeyImport=(e=>{var t=this.props.dispatch,a=this.handleParameter();t({type:"monitor/addKeyImport",payload:(0,h.default)({graph_name:e},a),callback:e=>{e&&200===e.status_code&&(this.fetchServiceMonitorFigure(),this.fetchKeyImport())}})}),this.handleSorting=(e=>{var t=this.props.dispatch,a=this.handleParameter();t({type:"monitor/sortMonitorFigure",payload:(0,h.default)({},a,{graph_ids:e}),callback:e=>{e&&200===e.status_code&&this.fetchServiceMonitorFigure(!1)}})}),this.handleUpData=(()=>{this.setState({isRender:!0},()=>{this.setState({isRender:!1})})}),this.handleSubmit=(e=>{var t=this.props.dispatch,a=this.state.info,l=this.handleParameter();a&&a.graph_id?t({type:"monitor/editServiceMonitorFigure",payload:(0,h.default)({},l,e,{graph_id:a.graph_id,sequence:a.sequence}),callback:e=>{e&&200===e.status_code&&(f.default.success({message:(0,S.formatMessage)({id:"notification.success.save"})}),this.fetchServiceMonitorFigure(!1),this.onCancelCustomMonitoring())}}):t({type:"monitor/addServiceMonitorFigure",payload:(0,h.default)({},l,e),callback:e=>{e&&200===e.status_code&&(f.default.success({message:(0,S.formatMessage)({id:"notification.success.add"})}),this.fetchServiceMonitorFigure(),this.onCancelCustomMonitoring())}})}),this.handleSubmitDelete=(()=>{var e=this.props.dispatch,t=this.state.showDelete,a=this.handleParameter();e({type:"monitor/delServiceMonitorFigure",payload:(0,h.default)({},a,{graph_id:t}),callback:e=>{e&&200===e.status_code&&(f.default.success({message:(0,S.formatMessage)({id:"notification.success.delete"})}),this.fetchServiceMonitorFigure(),this.cancalDelete())}})}),this.fetchServiceMonitor=(()=>{var e=this.props.dispatch,t=this.handleParameter();e({type:"monitor/fetchServiceMonitor",payload:t,callback:e=>{e&&200===e.status_code&&this.setState({isMonitorsLoading:!0,isMonitors:e.list.length>0})}})}),this.handleParameter=(()=>{var e=this.props.appDetail;return{team_name:g.default.getCurrTeamName(),app_alias:e.service.service_alias}}),this.cancalDelete=(()=>{this.setState({showDelete:!1})}),this.handleBatchDelete=(()=>{this.setState({BatchDelete:!0})}),this.cancalBatchDelete=(()=>{this.setState({BatchDelete:!1})}),this.state={isMonitorFigure:!1,monitorFigureList:[],isMonitoryPoint:!1,isCustomMonitoring:!1,showDelete:!1,info:{},KeyImportList:[],BatchDelete:!1,isMonitorsLoading:!1,isMonitors:!1,isRender:!1,KeyImportLoading:!0}}componentDidMount(){this.fetchServiceMonitorFigure(),this.fetchKeyImport(),this.fetchServiceMonitor()}render(){var e=this.props,t=e.appDetail,a=e.delServiceMonitorFigureLoading,l=e.addKeyImportLoading,n=e.delLoading,u=g.default.getCurrTeamName(),m=t.service.service_alias,p=t.service.service_id,f=this.state,h=f.isMonitoryPoint,w=f.isCustomMonitoring,O=f.isMonitorFigure,k=f.monitorFigureList,A=f.showDelete,x=f.info,D=f.KeyImportList,F=f.BatchDelete,T=f.isMonitors,P=f.isRender,N=f.KeyImportLoading,R=f.isMonitorsLoading;return M.default.createElement("div",null,w&&M.default.createElement(_.default,{serviceId:p,teamName:u,appAlias:m,info:x,onOk:this.handleSubmit,onCancel:this.onCancelCustomMonitoring}),!h&&!N&&M.default.createElement(i.default,null,M.default.createElement(b.default,{moduleName:"CustomMonitor",isRender:P,handleUpData:this.handleUpData,upData:this.fetchServiceMonitorFigure,handleSorting:this.handleSorting,onDelete:this.onDelete,onEdit:this.onEdit,appAlias:m,serviceId:p,RangeData:O?[]:k,operation:M.default.createElement("div",{style:{display:"inline-block",width:"calc(100% - 450px)",lineHeight:"40px"}},M.default.createElement(c.default,{style:{marginLeft:"5px"},onClick:this.handleCustomMonitoring},M.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitor.add"})),D&&D.length>0&&M.default.createElement(r.default,{overlay:M.default.createElement(d.default,null,D.map(e=>{return M.default.createElement(d.default.Item,{style:{textAlign:"center"}},M.default.createElement("a",{onClick:()=>{this.addKeyImport(e)}},e))})),trigger:["click"],placement:"bottomCenter",disabled:l},M.default.createElement(c.default,{style:{marginLeft:"5px"}},M.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitor.import"}),M.default.createElement(o.default,{type:"down"}))),k&&k.length>0&&M.default.createElement(c.default,{style:{marginLeft:"5px"},loading:n,onClick:this.handleBatchDelete},M.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitor.delete"})),M.default.createElement(c.default,{style:{float:"right",marginTop:"4px"},onClick:()=>{this.handleMonitoryPoint(!0)}},M.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitor.point"})))})),!h&&!w&&O&&R&&M.default.createElement(E.default,{style:{background:"#fff",marginTop:"10px",padding:"20px"},type:"warning",description:M.default.createElement("div",null,M.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitor.noBusiness"}),M.default.createElement("a",{onClick:()=>{T?this.handleCustomMonitoring():this.handleMonitoryPoint(!0)}},T?M.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitor.add"}):M.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitor.point"})))}),A&&M.default.createElement(y.default,{loading:a,title:M.default.createElement(S.FormattedMessage,{id:"confirmModal.deldete.monitor.title"}),desc:M.default.createElement(S.FormattedMessage,{id:"confirmModal.deldete.monitor.desc"}),subDesc:M.default.createElement(S.FormattedMessage,{id:"confirmModal.deldete.monitor.subDesc"}),onOk:this.handleSubmitDelete,onCancel:this.cancalDelete}),F&&M.default.createElement(v.default,(0,s.default)({title:M.default.createElement(S.FormattedMessage,{id:"componentOverview.body.tab.BatchDeleteChart.title"}),loading:n,data:k},this.handleParameter(),{onOk:this.fetchServiceMonitorFigure,onCancel:this.cancalBatchDelete})),h&&M.default.createElement(C.default,(0,s.default)({},this.props,{onCancel:()=>{this.fetchServiceMonitorFigure(),this.handleMonitoryPoint(!1)}})))}},m=p))||m);t.default=O},"ot6+":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("/zsF");var i=l(a("PArb"));a("5NDa");var r=l(a("5rEg"));a("5Dmo");var o=l(a("3S7+"));a("Pwec");var d=l(a("CtXQ"));a("+L6B");var c=l(a("2/Rp"));a("/xke");var u=l(a("TeRw"));a("Znn+");var m=l(a("ZTPi"));a("y8nQ");var p,f,h,g,v=l(a("Vl3Y")),y=a("MuoO"),b=n(a("q1tI")),_=a("LLXN"),E=a("P5Jw"),w=l(a("+kNj")),M=l(a("QDog")),C=l(a("mWxT")),S=w.default.Description,O=v.default.Item,k=m.default.TabPane,A=(p=(0,y.connect)(e=>{var t=e.global;return{rainbondInfo:t.rainbondInfo}},null,null,{withRef:!0}),f=v.default.create(),p(h=f((g=class extends b.PureComponent{constructor(e){super(e),this.getInfo=(()=>{var e=this.state,t=e.status,a=e.deployment_way,l=e.tabLoading,n=e.setTabActiveKey;this.props.dispatch({type:"appControl/getAutoDeployStatus",payload:{team_name:M.default.getCurrTeamName(),app_alias:this.props.app.service.service_alias,deployment_way:a},callback:e=>{if(e){var a=t,s=l,i=n||(1==e.bean.support_type?0:2==e.bean.support_type?1:2);a.splice(i,1,e.bean.status||!1),s.splice(i,1,e.bean.status||!1),this.setState({display:e.bean.display,status:a,tabLoading:s,url:e.bean.url,secret_key:e.bean.secret_key,support_type:e.bean.support_type,tabActiveKey:i,deploy_keyword:e.bean.deploy_keyword,deploy_mirror:e.bean.trigger})}}})}),this.handleCancel=(()=>{this.props.dispatch({type:"appControl/cancelAutoDeploy",payload:{team_name:M.default.getCurrTeamName(),app_alias:this.props.app.service.service_alias,deployment_way:this.state.deployment_way},callback:()=>{this.getInfo("cancel")}})}),this.handleOpen=(()=>{this.props.dispatch({type:"appControl/openAutoDeploy",payload:{team_name:M.default.getCurrTeamName(),app_alias:this.props.app.service.service_alias,deployment_way:this.state.deployment_way},callback:()=>{this.getInfo()}})}),this.handleScretSubmit=(()=>{this.props.form.validateFields(["secret_key"],e=>{if(!e){var t=this.props.form.getFieldValue("secret_key");this.props.dispatch({type:"appControl/putAutoDeploySecret",payload:{team_name:M.default.getCurrTeamName(),service_alias:this.props.app.service.service_alias,secret_key:t},callback:()=>{u.default.success({message:(0,_.formatMessage)({id:"notification.success.to_update"})})}})}})}),this.handleCommandSubmit=(()=>{this.props.form.validateFields(["deploy_keyword"],e=>{if(!e){var t=this.props.form.getFieldValue("deploy_keyword");this.props.dispatch({type:"appControl/putAutoDeployCommand",payload:{team_name:M.default.getCurrTeamName(),service_alias:this.props.app.service.service_alias,keyword:t},callback:e=>{e&&200===e.status_code&&(u.default.success({message:(0,_.formatMessage)({id:"notification.success.to_update"})}),this.setState({deploy_keyword:e.bean.deploy_keyword}))}})}})}),this.handleMirrorSubmit=(()=>{this.props.form.validateFields(["deploy_mirror"],e=>{if(!e){var t=this.props.form.getFieldValue("deploy_mirror");this.props.dispatch({type:"appControl/putMirrorCommand",payload:{team_name:M.default.getCurrTeamName(),service_alias:this.props.app.service.service_alias,trigger:t},callback:e=>{e&&200===e.status_code&&(u.default.success({message:(0,_.formatMessage)({id:"notification.success.to_update"})}),this.setState({deploy_mirror:e.bean.trigger,url:e.bean.url}))}})}})}),this.handleTabs=(e=>{this.setState({setTabActiveKey:e,tabActiveKey:e,deployment_way:0==e?"code_webhooks":1==e?"api_webhooks":"image_webhooks"},()=>{this.getInfo()})}),this.state={display:!1,status:[!1,!1,!1],support_type:0,url:"",secret_key:"",tabActiveKey:0,setTabActiveKey:!1,deployment_way:this.props.service_source==="".concat((0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.image"}))||"DockerRun"===this.props.service_source||"DockerCompose"===this.props.service_source?"api_webhooks":"code_webhooks",tabLoading:[!1,!1,!1],service_source:this.props.service_source,deploy_keyword:"deploy",deploy_mirror:""}}componentDidMount(){this.getInfo()}shouldComponentUpdate(){return!0}render(){if(!this.state.display)return null;var e=this.props.form.getFieldDecorator,t=this.props.rainbondInfo,a=this.state,l=a.tabActiveKey,n=a.status,p=a.tabLoading,f=a.support_type,h=a.url,g=a.service_source,y=h.replace("http://127.0.0.1:5000","".concat(window.location.protocol,"//").concat(window.location.host)),M=()=>b.default.createElement("svg",{viewBox:"0 0 30 50",version:"1.1",width:"20px",height:"20px"},b.default.createElement("path",{style:{fill:"#03A9F4"},d:"M 40 20 C 40.390625 18.265625 39.90625 16.21875 37.5 14 C 33.585938 17.542969 34.703125 21.226563 36 23 C 36 23 35.835938 24 32 24 C 28.164063 24 2 24 2 24 C 2 24 0.167969 40 18 40 C 33.59375 40 37.972656 27.996094 38.828125 24.925781 C 39.183594 24.972656 39.578125 25.003906 40 25 C 42.148438 24.984375 44.929688 23.828125 46 19.515625 C 43.160156 18.53125 41.339844 18.976563 40 20 Z "}),b.default.createElement("path",{style:{fill:"#0288D1"},d:"M 2.164063 28 C 2.898438 32.738281 5.984375 40 18 40 C 30.183594 40 35.523438 32.671875 37.683594 28 Z "}),b.default.createElement("path",{style:{fill:"#81D4FA"},d:"M 19.8125 39.9375 C 18.890625 39.617188 14.738281 38.847656 14 33 C 9.789063 34.863281 6.0625 34.375 4.421875 34.007813 C 6.582031 37.238281 10.589844 40 18 40 C 18.621094 40 19.222656 39.976563 19.8125 39.9375 Z "}),b.default.createElement("path",{style:{fill:"#FFFFFF"},d:"M 20 32 C 20 33.105469 19.105469 34 18 34 C 16.894531 34 16 33.105469 16 32 C 16 30.894531 16.894531 30 18 30 C 19.105469 30 20 30.894531 20 32 Z "}),b.default.createElement("path",{style:{fill:"#37474F"},d:"M 14.914063 33.597656 C 15.136719 34.101563 14.933594 34.757813 14.402344 34.914063 C 11.101563 35.886719 8.257813 36.015625 6.105469 36.015625 C 5.464844 35.398438 4.914063 34.738281 4.449219 34.054688 C 7.035156 34.054688 11.160156 33.933594 13.59375 33.089844 C 14.117188 32.90625 14.691406 33.089844 14.914063 33.597656 Z M 2 27 C 2 27 3.875 27.125 5 26 C 6.875 27.6875 10.941406 27.089844 12 26 C 13.0625 27.6875 18.9375 27.375 20 26 C 21.25 27.4375 26.625 27.75 28 26 C 28.480469 27.460938 34.820313 27.875 36 26 C 37.0625 27.089844 41.0625 27.9375 43.3125 26 C 43.875 27.1875 46 27 46 27 L 46 28 L 2 28 M 17 32 C 17 32.550781 17.449219 33 18 33 C 18.550781 33 19 32.550781 19 32 C 19 31.449219 18.550781 31 18 31 C 17.449219 31 17 31.449219 17 32 Z "}),b.default.createElement("path",{style:{fill:"#01579B"},d:"M 11 24 L 6 24 L 6 19 L 11 19 Z M 21 19 L 16 19 L 16 24 L 21 24 Z M 31 19 L 26 19 L 26 24 L 31 24 Z M 16 14 L 11 14 L 11 19 L 16 19 Z M 26 14 L 21 14 L 21 19 L 26 19 Z "}),b.default.createElement("path",{style:{fill:"#0288D1"},d:"M 16 24 L 11 24 L 11 19 L 16 19 Z M 26 19 L 21 19 L 21 24 L 26 24 Z M 26 9 L 21 9 L 21 14 L 26 14 Z M 21 14 L 16 14 L 16 19 L 21 19 Z "})),A=C.default.documentPlatform_url(t);return b.default.createElement(s.default,{style:{marginBottom:24},title:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.automatic"})},b.default.createElement(m.default,{onChange:e=>{this.handleTabs(e)},tabBarExtraContent:b.default.createElement("div",null,!1===n[l]?b.default.createElement(c.default,{type:"primary",onClick:this.handleOpen},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.open"})):b.default.createElement(c.default,{type:"primary",onClick:this.handleCancel},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.close"})))},1===f&&g=="".concat((0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.Source_code"}))&&b.default.createElement(k,{tab:b.default.createElement("span",null,b.default.createElement(d.default,{type:"github"}),"Git-Webhook",b.default.createElement(o.default,{title:A&&b.default.createElement("a",{href:"".concat(A,"docs/use-manual/component-manage/build-source/auto_build/#\u57fa\u4e8e\u6e90\u4ee3\u7801\u64cd\u4f5c\u6d41\u7a0b"),target:"_blank",style:{color:"#fff"}},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.read"}))||""}," ",b.default.createElement(d.default,{type:"question-circle-o"}))),key:"0"},p[0]?b.default.createElement("div",null,b.default.createElement(w.default,{size:"small",style:{borderLeft:"10px solid #38AA56",paddingLeft:"10px",marginBottom:16},title:"",col:"1"},b.default.createElement(S,{term:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.Support_type"})},b.default.createElement("div",{style:{marginLeft:"38px"}},"Gitlab,Github,Gitee,Gogs,Coding")),b.default.createElement(S,{term:"Webhook"},b.default.createElement("div",{style:{marginLeft:"34px"}},b.default.createElement("a",null,y," "),b.default.createElement(E.CopyToClipboard,{text:y,onCopy:()=>{u.default.success({message:(0,_.formatMessage)({id:"notification.success.copy"})})}},b.default.createElement(c.default,{size:"small"},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.copy"}))))),b.default.createElement(S,{term:b.default.createElement(b.default.Fragment,null,b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.keyword"})," ",b.default.createElement("span",{style:{display:"inline-block",paddingRight:"20px"}}))},b.default.createElement("div",{style:{display:"flex"}},b.default.createElement("div",{style:{paddingTop:"10px",margin:"0 15px 0 -30px"}},b.default.createElement(o.default,{title:b.default.createElement("div",null,b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.automatic",values:{deploy_keyword:this.state.deploy_keyword}}))},b.default.createElement(d.default,{type:"question-circle-o"}))),b.default.createElement(v.default,{onSubmit:this.handleCommandSubmit},b.default.createElement(O,null,e("deploy_keyword",{initialValue:this.state.deploy_keyword,rules:[{required:!0,message:(0,_.formatMessage)({id:"componentOverview.body.AutoDeploy.keyword_null"})}]})(b.default.createElement(r.default,{addonBefore:"@",style:{width:300}})),b.default.createElement(c.default,{onClick:()=>{this.handleCommandSubmit()},style:{marginLeft:10},size:"small"},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.to_update"})),b.default.createElement("p",null,b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.Note",values:{deploy_keyword:this.state.deploy_keyword}}))))))),b.default.createElement(i.default,{style:{margin:"16px 0"}})):b.default.createElement("div",{style:{textAlign:"center",height:"80px",lineHeight:"80px"}},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.Not_open"}))),b.default.createElement(k,{tab:b.default.createElement("span",null,b.default.createElement(d.default,{type:"api"}),b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.custom"}),b.default.createElement(o.default,{title:A&&b.default.createElement("a",{href:"".concat(A,"docs/use-manual/component-manage/build-source/auto_build/#api-\u89e6\u53d1\u81ea\u52a8\u6784\u5efa"),target:"_blank",style:{color:"#fff"}},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.read"}))||""},b.default.createElement(d.default,{type:"question-circle-o"}))),key:"1"},p[1]?b.default.createElement("div",null,b.default.createElement(w.default,{size:"small",title:"",style:{borderLeft:"10px solid #38AA56",paddingLeft:"10px",marginBottom:16},col:"1"},b.default.createElement(S,{term:"API"},b.default.createElement("a",null,y," "),b.default.createElement(E.CopyToClipboard,{text:y,onCopy:()=>{u.default.success({message:(0,_.formatMessage)({id:"notification.success.copy"})})}},b.default.createElement(c.default,{size:"small"},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.copy"})))),b.default.createElement(S,{style:{display:"flex"},term:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.Secret_key"})},b.default.createElement(v.default,{onSubmit:this.handleScretSubmit},b.default.createElement(O,{style:{marginTop:"-6px"}},e("secret_key",{initialValue:this.state.secret_key||"",rules:[{required:!0,min:8,message:(0,_.formatMessage)({id:"componentOverview.body.AutoDeploy.Secret_key_num"})}]})(b.default.createElement(r.default,{style:{width:300}})),b.default.createElement(c.default,{onClick:this.handleScretSubmit,style:{marginLeft:10},size:"small"},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.to_update"}))))))):b.default.createElement("div",{style:{textAlign:"center",height:"80px",lineHeight:"80px"}},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.Not_open"}))),(g=="".concat((0,_.formatMessage)({id:"componentOverview.body.ChangeBuildSource.image"}))||"DockerCompose"==g||"DockerRun"==g)&&b.default.createElement(k,{tab:b.default.createElement("span",null," ",b.default.createElement(d.default,{component:M}),b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.Webhook"}),A&&b.default.createElement(o.default,{title:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.read"})},b.default.createElement("a",{href:"".concat(A,"docs/use-manual/component-manage/build-source/auto_build/#\u57fa\u4e8e\u955c\u50cf\u4ed3\u5e93\u64cd\u4f5c\u6d41\u7a0b"),target:"_blank"},b.default.createElement(d.default,{type:"question-circle-o"})))),key:"2"},p[2]?b.default.createElement("div",null,b.default.createElement(w.default,{size:"small",title:"",style:{borderLeft:"10px solid #38AA56",paddingLeft:"10px",marginBottom:16},col:"1"},b.default.createElement(S,{term:"Webhook"},b.default.createElement("a",null,y," "),b.default.createElement(E.CopyToClipboard,{text:y,onCopy:()=>{u.default.success({message:(0,_.formatMessage)({id:"notification.success.copy"})})}},b.default.createElement(c.default,{size:"small"},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.copy"})))),b.default.createElement(S,{style:{display:"flex"},term:b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.tag"})},b.default.createElement("div",{style:{display:"flex"}},b.default.createElement(v.default,{onSubmit:this.handleMirrorSubmit},b.default.createElement(O,null,e("deploy_mirror",{initialValue:this.state.deploy_mirror,rules:[{required:!0,message:(0,_.formatMessage)({id:"componentOverview.body.AutoDeploy.keyword_null"})}]})(b.default.createElement(r.default,{style:{width:300},placeholder:(0,_.formatMessage)({id:"componentOverview.body.AutoDeploy.regular_expression"})})),b.default.createElement(c.default,{onClick:()=>{this.handleMirrorSubmit()},style:{marginLeft:10},size:"small"},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.to_update"})),b.default.createElement("p",null,b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.note"})))))))):b.default.createElement("div",{style:{textAlign:"center",height:"80px",lineHeight:"80px"}},b.default.createElement(_.FormattedMessage,{id:"componentOverview.body.AutoDeploy.Not_open"})))))}},h=g))||h)||h);t.default=A},"p3+A":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=l(a("jehZ"));a("5Dmo");var i=l(a("3S7+"));a("IzEo");var r=l(a("bx4M"));a("g9YV");var o=l(a("wCAj"));a("+L6B");var d=l(a("2/Rp"));a("Pwec");var c=l(a("CtXQ"));a("14J3");var u=l(a("BMrR"));a("jCWc");var m=l(a("kPKH"));a("fOrg");var p=l(a("+KLJ")),f=l(a("p0pE"));a("/xke");var h=l(a("TeRw"));a("y8nQ");var g,v,y,b,_=l(a("Vl3Y")),E=a("MuoO"),w=a("7DNP"),M=n(a("q1tI")),C=a("LLXN"),S=l(a("agpv")),O=l(a("z1Ga")),k=l(a("q76B")),A=l(a("MXRY")),x=l(a("cUW5")),D=l(a("puxM")),F=a("xpXo"),T=l(a("QDog")),P=l(a("YTVB")),N=(g=(0,E.connect)(e=>{var t=e.user,a=e.appControl,l=e.teamControl;return{currUser:t.currentUser,innerEnvs:a.innerEnvs,startProbe:a.startProbe,runningProbe:a.runningProbe,ports:a.ports,baseInfo:a.baseInfo,appDetail:a.appDetail,teamControl:l,appControl:a,volumes:a.volumes,appBaseInfo:a.baseInfo}},null,null,{withRef:!0}),v=_.default.create(),g(y=v((b=class extends M.default.Component{constructor(e){super(e),this.onDeleteVar=(e=>{this.setState({deleteVar:e})}),this.onCancelDeleteVolume=(()=>{this.setState({toDeleteVolume:null})}),this.onEditVolume=(e=>{this.setState({showAddVars:e,editor:e})}),this.onDeleteMnt=(e=>{this.setState({toDeleteMnt:e})}),this.onDeleteVolume=(e=>{this.setState({toDeleteVolume:e})}),this.onPageChange=(e=>{this.setState({page:e},()=>{this.fetchInnerEnvs()})}),this.onEditVar=(e=>{this.setState({showEditVar:e})}),this.onTransfer=(e=>{this.setState({transfer:e})}),this.cancelEditVar=(()=>{this.setState({showEditVar:null})}),this.handleSearch=(e=>{this.setState({page:1,env_name:e},()=>{this.fetchInnerEnvs()})}),this.fetchInnerEnvs=(()=>{var e=this.state,t=e.page,a=e.page_size,l=e.env_name;this.props.dispatch({type:"appControl/fetchInnerEnvs",payload:{team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias,page:t,page_size:a,env_name:l},callback:e=>{if(e&&200===e.status_code){var t=[];e.list&&e.list.length>0&&e.list.map(e=>{var a=T.default.confirmEnding("".concat(e.attr_name),"PASS");a&&t.push(e.ID)}),this.setState({isAttrNameList:t})}}})}),this.handleAddVar=(()=>{this.setState({showAddVar:!0})}),this.handleCancelAddVar=(()=>{this.setState({showAddVar:!1})}),this.handleSubmitAddVar=(e=>{this.props.dispatch({type:"appControl/addInnerEnvs",payload:{team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias,attr_name:e.attr_name,attr_value:e.attr_value,name:e.name},callback:e=>{e&&200===e.status_code&&(h.default.success({message:(0,C.formatMessage)({id:"notification.success.add"})}),this.fetchInnerEnvs(),this.handleCancelAddVar())}})}),this.cancelDeleteVar=(()=>{this.setState({deleteVar:null})}),this.cancelTransfer=(()=>{this.setState({transfer:null})}),this.handleDeleteVar=(()=>{this.props.dispatch({type:"appControl/deleteEnvs",payload:{team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias,ID:this.state.deleteVar.ID},callback:e=>{e&&200===e.status_code&&(h.default.success({message:(0,C.formatMessage)({id:"notification.success.delete"})}),this.fetchInnerEnvs()),this.cancelDeleteVar(),this.props.onshowRestartTips(!0)}})}),this.handleTransfer=(()=>{var e=this.state.transfer;this.props.dispatch({type:"appControl/putTransfer",payload:{team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias,ID:e.ID,scope:"inner"==e.scope?"outer":"inner"},callback:e=>{e&&200===e.status_code&&(h.default.success({message:(0,C.formatMessage)({id:"notification.success.transfer"})}),this.fetchInnerEnvs(),this.cancelTransfer())}})}),this.handleEditVar=(e=>{var t=this.state.showEditVar;this.props.dispatch({type:"appControl/editEvns",payload:{team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias,ID:t.ID,attr_value:e.attr_value,name:e.name},callback:e=>{e&&200===e.status_code&&(h.default.success({message:(0,C.formatMessage)({id:"notification.success.edit"})}),this.cancelEditVar(),this.fetchInnerEnvs())}})}),this.fetchVolumes=(()=>{this.props.dispatch({type:"appControl/fetchVolumes",payload:{team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias,is_config:!0}})}),this.fetchBaseInfo=(()=>{var e=this.props.dispatch;e({type:"appControl/fetchBaseInfo",payload:{team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias}})}),this.loadMntList=(()=>{(0,F.getMnt)({team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias,page:1,page_size:1e3,volume_type:["config-file"]}).then(e=>{e&&this.setState({mntList:e.list||[]})})}),this.handleAddVars=(()=>{this.setState({showAddVars:{new:!0}})}),this.handleCancelAddVars=(()=>{this.setState({showAddVars:null,editor:null})}),this.handleSubmitAddVars=(e=>{var t=this.state.editor;t?this.props.dispatch({type:"appControl/editorVolume",payload:{team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias,new_volume_path:e.volume_path,new_file_content:e.file_content,mode:e.mode,ID:t.ID},callback:e=>{e&&200===e.status_code&&(this.fetchVolumes(),this.handleCancelAddVars(),h.default.success({message:(0,C.formatMessage)({id:"notification.success.edit"})}),this.props.onshowRestartTips(!0))}}):this.props.dispatch({type:"appControl/addVolume",payload:(0,f.default)({team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias},e),callback:e=>{e&&200===e.status_code&&(this.fetchVolumes(),this.handleCancelAddVars(),h.default.success({message:(0,C.formatMessage)({id:"notification.success.add"})}),this.props.onshowRestartTips(!0))}})}),this.showAddRelation=(()=>{this.setState({showAddRelation:!0})}),this.handleCancelAddRelation=(()=>{this.setState({showAddRelation:!1})}),this.handleSubmitAddMnt=(e=>{(0,F.addMnt)({team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias,body:e}).then(e=>{e&&(this.handleCancelAddRelation(),this.loadMntList(),h.default.success({message:(0,C.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0))})}),this.handleDeleteVolume=(()=>{this.props.dispatch({type:"appControl/deleteVolume",payload:{team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias,volume_id:this.state.toDeleteVolume.ID},callback:e=>{e&&200===e.status_code&&(h.default.success({message:(0,C.formatMessage)({id:"notification.success.delete"})}),this.onCancelDeleteVolume(),this.fetchVolumes(),this.props.onshowRestartTips(!0))}})}),this.handleDeleteMnt=(()=>{this.props.dispatch({type:"appControl/deleteMnt",payload:{team_name:T.default.getCurrTeamName(),app_alias:this.props.appAlias,dep_vol_id:this.state.toDeleteMnt.dep_vol_id},callback:()=>{this.cancelDeleteMnt(),this.loadMntList(),h.default.success({message:(0,C.formatMessage)({id:"notification.success.succeeded"})}),this.props.onshowRestartTips(!0)}})}),this.cancelDeleteMnt=(()=>{this.setState({toDeleteMnt:null})}),this.AfterPassword=((e,t)=>{var a=T.default.fetchSvg("passwordShow"),l=T.default.fetchSvg("passwordHidden");return M.default.createElement("span",{onClick:()=>{this.handlePassword(e,t)}},e?l:a)}),this.handlePassword=((e,t)=>{var a=this.state.isAttrNameList,l=a;if(e){var n=l.indexOf(t);l.splice(n,1)}else l.push(t);this.setState({isAttrNameList:l})}),this.state={showAddVar:!1,showEditVar:null,deleteVar:null,page:1,page_size:5,env_name:"",showAddVars:null,showAddRelation:!1,mntList:[],toDeleteMnt:null,toDeleteVolume:null,editor:null,isAttrNameList:[]}}componentDidMount(){this.props.dispatch({type:"teamControl/fetchAllPerm"}),this.fetchInnerEnvs(),this.loadMntList(),this.fetchVolumes(),this.fetchBaseInfo()}componentWillUnmount(){var e=this.props.dispatch;e({type:"appControl/clearTags"}),e({type:"appControl/clearPorts"}),e({type:"appControl/clearInnerEnvs"}),e({type:"appControl/clearStartProbe"}),e({type:"appControl/clearRunningProbe"}),e({type:"appControl/clearMembers"})}canView(){var e=this.props.componentPermissions.isEnv;return e}render(){if(!this.canView())return M.default.createElement(x.default,null);var e=this.state.mntList,t=this.props,a=t.baseInfo,l=t.volumes,n={wordBreak:"break-all",wordWrap:"break-word"};return"boolean"!==typeof a.build_upgrade?null:M.default.createElement(M.Fragment,null,M.default.createElement(u.default,null,M.default.createElement(m.default,{span:15},M.default.createElement(p.default,{showIcon:!0,message:M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.env.environmentVariable.message"}),type:"info",style:{marginBottom:24}}))),M.default.createElement(u.default,null,M.default.createElement(A.default,{title:M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.env.environmentVariable.title"}),type:"Inner",appAlias:this.props.appAlias}),M.default.createElement(m.default,{span:16},M.default.createElement(p.default,{showIcon:!0,message:M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.env.setting.message"}),type:"info",style:{marginBottom:24}}))),M.default.createElement(r.default,{style:{marginBottom:24,borderRadius:5},title:M.default.createElement("span",null," ",M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.env.setting.title"})," "),extra:M.default.createElement(d.default,{onClick:this.handleAddVars},M.default.createElement(c.default,{type:"plus"}),M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.env.setting.add"}))},M.default.createElement(D.default,{sm:650},M.default.createElement(o.default,{pagination:!1,columns:[{title:(0,C.formatMessage)({id:"componentOverview.body.tab.env.setting.volume_name"}),dataIndex:"volume_name"},{title:(0,C.formatMessage)({id:"componentOverview.body.tab.env.setting.volume_path"}),dataIndex:"volume_path"},{title:(0,C.formatMessage)({id:"componentOverview.body.tab.env.setting.mode"}),dataIndex:"mode"},{title:(0,C.formatMessage)({id:"componentOverview.body.tab.env.setting.action"}),dataIndex:"action",render:(e,t)=>M.default.createElement("div",null,M.default.createElement("a",{onClick:()=>{this.onDeleteVolume(t)},href:"javascript:;"},M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.env.setting.delete"})),M.default.createElement("a",{onClick:()=>{this.onEditVolume(t)},href:"javascript:;"},M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.env.setting.edit"})))}],dataSource:l}))),M.default.createElement(r.default,{title:M.default.createElement("span",null," ",M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.env.file.share"})," "),extra:M.default.createElement(d.default,{onClick:this.showAddRelation},M.default.createElement(c.default,{type:"plus"}),M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.env.file.mount"})),style:{borderRadius:5}},M.default.createElement(D.default,{sm:850},M.default.createElement(o.default,{pagination:!1,columns:[{title:(0,C.formatMessage)({id:"componentOverview.body.tab.env.file.localMount"}),dataIndex:"local_vol_path",key:"1",width:"20%",render:e=>M.default.createElement(i.default,{title:e},M.default.createElement("span",{style:n},e))},{title:(0,C.formatMessage)({id:"componentOverview.body.tab.env.file.name"}),dataIndex:"dep_vol_name",key:"2",width:"15%",render:e=>M.default.createElement(i.default,{title:e},M.default.createElement("span",{style:n},e))},{title:(0,C.formatMessage)({id:"componentOverview.body.tab.env.file.path"}),dataIndex:"dep_vol_path",key:"3",width:"20%",render:e=>M.default.createElement(i.default,{title:e},M.default.createElement("span",{style:n},e))},{title:(0,C.formatMessage)({id:"componentOverview.body.tab.env.file.Component"}),dataIndex:"dep_app_name",key:"4",width:"15%",render:(e,t)=>M.default.createElement(w.Link,{to:"/team/".concat(T.default.getCurrTeamName(),"/region/").concat(T.default.getCurrRegionName(),"/components/").concat(t.dep_app_alias,"/overview")},e)},{title:(0,C.formatMessage)({id:"componentOverview.body.tab.env.file.Components"}),dataIndex:"dep_app_group",key:"5",width:"15%",render:(e,t)=>M.default.createElement(w.Link,{to:"/team/".concat(T.default.getCurrTeamName(),"/region/").concat(T.default.getCurrRegionName(),"/apps/").concat(t.dep_group_id)},e)},{title:(0,C.formatMessage)({id:"componentOverview.body.tab.env.file.action"}),dataIndex:"action",key:"6",width:"15%",render:(e,t)=>M.default.createElement("a",{onClick:()=>{this.onDeleteMnt(t)},href:"javascript:;"},M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.env.file.cancel"}))}],dataSource:e}))),this.state.showAddVars&&M.default.createElement(S.default,(0,s.default)({appBaseInfo:this.props.appBaseInfo,onCancel:this.handleCancelAddVars,onSubmit:this.handleSubmitAddVars,data:this.state.showAddVars,editor:this.state.editor},this.props)),this.state.showAddRelation&&M.default.createElement(O.default,{appAlias:this.props.appAlias,onCancel:this.handleCancelAddRelation,onSubmit:this.handleSubmitAddMnt,volume_type:["config-file"]}),this.state.toDeleteMnt&&M.default.createElement(k.default,{title:M.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.unmount.title"}),desc:M.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.unmount.desc"}),onCancel:this.cancelDeleteMnt,onOk:this.handleDeleteMnt}),this.state.toDeleteVolume&&M.default.createElement(k.default,{title:M.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.configurationFile.title"}),desc:M.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.configurationFile.desc"}),onCancel:this.onCancelDeleteVolume,onOk:this.handleDeleteVolume}),this.state.showAddVar&&M.default.createElement(P.default,{onCancel:this.handleCancelAddVar,onSubmit:this.handleSubmitAddVar,isShowRestartTips:e=>{this.props.onshowRestartTips(e)}}),this.state.transfer&&M.default.createElement(k.default,{onOk:this.handleTransfer,onCancel:this.cancelTransfer,title:M.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.transfer.title"}),desc:M.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.transfer.desc"}),subDesc:""}),this.state.showEditVar&&M.default.createElement(P.default,{onCancel:this.cancelEditVar,onSubmit:this.handleEditVar,data:this.state.showEditVar,isShowRestartTips:e=>{this.props.onshowRestartTips(e)}}),this.state.deleteVar&&M.default.createElement(k.default,{onOk:this.handleDeleteVar,onCancel:this.cancelDeleteVar,title:M.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.env.title"}),desc:M.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.env.desc"}),subDesc:M.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.env.subDesc"})}))}},y=b))||y)||y);t.default=N},pkKe:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV")),i=l(a("jehZ"));a("/xke");var r=l(a("TeRw"));a("5NDa");var o=l(a("5rEg"));a("OaEy");var d=l(a("2fM7"));a("y8nQ");var c,u,m,p=l(a("Vl3Y")),f=n(a("q1tI")),h=a("LLXN"),g=p.default.Item,v=d.default.Option,y=(o.default.TextArea,c=p.default.create(),c((m=class extends f.PureComponent{constructor(e){super(e),this.handleSubmit=(e=>{e.preventDefault(),this.props.form.validateFields({force:!0},(e,t)=>{if(!e){if("\u8bf7\u9009\u62e9\u7aef\u53e3"==t.port)return void r.default.info({message:(0,h.formatMessage)({id:"notification.hint.selectPort"})});this.props.onOk&&this.props.onOk(t)}})}),this.handleCancel=(()=>{this.props.onCancel&&this.props.onCancel()}),this.state={}}render(){var e=this.props.form,t=e.getFieldDecorator,a=(e.getFieldValue,{labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}}}),l=this.props.postList;l[0].lb_mpping_port;return f.default.createElement(s.default,{title:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.SubPort.title"}),onOk:this.handleSubmit,visible:!0,onCancel:this.props.onCancel},f.default.createElement(p.default,{onSubmit:this.handleSubmit},f.default.createElement(g,(0,i.default)({},a,{label:f.default.createElement(h.FormattedMessage,{id:"componentOverview.body.SubPort.port"})}),t("port",{initialValue:"".concat((0,h.formatMessage)({id:"componentOverview.body.SubPort.port"})),rules:[{required:!0,message:(0,h.formatMessage)({id:"componentOverview.body.SubPort.port"})}]})(f.default.createElement(d.default,{getPopupContainer:e=>e.parentNode},l.map(e=>{return f.default.createElement(v,{value:e.service_id+"||"+e.lb_mpping_port},e.lb_mpping_port)}))))))}},u=m))||u);t.default=y},pybC:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=n(a("q1tI")),i=l(a("iLo2"));class r extends s.PureComponent{render(){var e=this.props.appAlias;return s.default.createElement(s.Fragment,null,s.default.createElement(i.default,{moduleName:"PerformanceAnalysis",RangeData:["responseTime","throughput","numberOnline"],appAlias:e}))}}t.default=r},qPtA:function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=n(a("kLXV")),i=n(a("jehZ"));a("+L6B");var r=n(a("2/Rp"));a("y8nQ");var o=n(a("Vl3Y")),d=l(a("q1tI")),c=a("LLXN"),u=n(a("CQXj")),m=o.default.Item;class p extends d.PureComponent{render(){var e=this.props,t=e.title,a=e.onCancel,l=this.props.data||{},n={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}};return d.default.createElement(s.default,{title:t,visible:!0,onCancel:a,footer:[d.default.createElement(r.default,{onClick:a}," ",d.default.createElement(c.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.close"})," ")]},d.default.createElement(o.default,null,d.default.createElement(m,(0,i.default)({},n,{label:d.default.createElement(c.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.port"})}),d.default.createElement("span",null,u.default.getPort(l))),d.default.createElement(m,(0,i.default)({},n,{label:d.default.createElement(c.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.probe"})}),d.default.createElement("span",null,u.default.getProtocol(l))),"http"===l.scheme?d.default.createElement(d.Fragment,null,d.default.createElement(m,(0,i.default)({},n,{label:d.default.createElement(c.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.http"})}),d.default.createElement("span",null,u.default.getHeaders(l))),d.default.createElement(m,(0,i.default)({},n,{label:d.default.createElement(c.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.path"})}),d.default.createElement("span",null,u.default.getPath(l)))):null,d.default.createElement(m,(0,i.default)({},n,{label:d.default.createElement(c.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.initialization"})}),d.default.createElement("span",null,u.default.getInitWaitTime(l),d.default.createElement("span",{style:{marginLeft:8}},d.default.createElement(c.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.second"})))),d.default.createElement(m,(0,i.default)({},n,{label:d.default.createElement(c.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.time"})}),d.default.createElement("span",null,u.default.getIntervalTime(l),d.default.createElement("span",{style:{marginLeft:8}},d.default.createElement(c.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.second"})))),d.default.createElement(m,(0,i.default)({},n,{label:d.default.createElement(c.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.overtime"})}),d.default.createElement("span",null,u.default.getTimeoutTime(l),d.default.createElement("span",{style:{marginLeft:8}},d.default.createElement(c.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.second"})))),d.default.createElement(m,(0,i.default)({},n,{label:d.default.createElement(c.FormattedMessage,{id:"componentOverview.body.ViewRunHealthCheck.frequency"})}),d.default.createElement("span",null,u.default.getFailTimes(l)))))}}t.default=p},sC1O:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("y8nQ");var s=l(a("Vl3Y"));a("5NDa");var i=l(a("5rEg"));a("OaEy");var r,o,d,c=l(a("2fM7")),u=n(a("q1tI")),m=a("MuoO"),p=(a("7DNP"),a("P5Jw"),l(a("p3+A"))),f=(c.default.Option,i.default.Search,r=(0,m.connect)(e=>{var t=e.user,a=e.appControl;return{currUser:t.currentUser,baseInfo:a.baseInfo,extendInfo:a.extendInfo,instances:a.pods}},null,null,{pure:!1,withRef:!0}),o=s.default.create(),r(d=o(d=class extends u.PureComponent{constructor(e){super(e),this.state={}}render(){return u.default.createElement("div",null,u.default.createElement(p.default,this.props))}})||d)||d);t.default=f},sg1L:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M")),i=l(a("jehZ"));a("+L6B");var r=l(a("2/Rp"));a("5NDa");var o=l(a("5rEg"));a("Q9mQ");var d=l(a("diRs"));a("O3gP");var c=l(a("lrIw"));a("/xke");var u=l(a("TeRw")),m=l(a("p0pE"));a("y8nQ");var p=l(a("Vl3Y"));a("OaEy");var f,h,g,v,y=l(a("2fM7")),b=a("MuoO"),_=n(a("q1tI")),E=a("LLXN"),w=a("RBnf"),M=a("xpXo"),C=l(a("QDog")),S=(y.default.Option,f=p.default.create(),h=(0,b.connect)(),f(g=h((v=class extends _.PureComponent{constructor(e){super(e),this.handleSubmit=(e=>{e.preventDefault();var t=this.props,a=t.form,l=(t.dispatch,this.state.scheduleValue),n=C.default.getCurrTeamName(),s=this.props.service_alias||"";a.validateFields((e,t)=>{e||(0,M.addRunStrategy)((0,m.default)({team_name:n,service_alias:s},t,{scheduleValue:l})).then(e=>{u.default.success({message:(0,E.formatMessage)({id:"notification.success.data_save"})}),this.handleRunStrategy()}).catch(e=>{handleAPIError(e)})})}),this.handleRunStrategy=(()=>{var e=C.default.getCurrTeamName(),t=this.props.service_alias||"";(0,M.getRunStrategy)({team_name:e,service_alias:t}).then(e=>{this.setState({data:e.bean})}).catch(e=>{handleAPIError(e)})}),this.handleAutoComplete=(e=>{if(e.indexOf("(")>-1){var t=e.indexOf("("),a=e.substring(0,t);this.setState({scheduleValue:a,scheduleFlag:!0})}else this.setState({scheduleValue:e,scheduleFlag:!1})}),this.handleCheckPort=((e,t,a)=>{this.props.form.getFieldValue;var l=/\D/g;t.match(l)&&a(_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.Floating"})),a()}),this.state={data:{},scheduleFlag:!1,scheduleValue:""}}componentDidMount(){this.handleRunStrategy()}render(){var e=this.props,t=e.form.getFieldDecorator,a=e.extend_method,l=this.state,n=l.data,u=(l.scheduleValue,l.scheduleFlag,{labelCol:{xs:{span:3},sm:{span:3}},wrapperCol:{xs:{span:5},sm:{span:5}}}),m=[{name:(0,E.formatMessage)({id:"componentOverview.body.Strategy.hour"}),value:"0 * * * *"},{name:(0,E.formatMessage)({id:"componentOverview.body.Strategy.day"}),value:"0 0 * * *"},{name:(0,E.formatMessage)({id:"componentOverview.body.Strategy.week"}),value:"0 0 * * 0"},{name:(0,E.formatMessage)({id:"componentOverview.body.Strategy.month"}),value:"0 0 1 * *"},{name:(0,E.formatMessage)({id:"componentOverview.body.Strategy.year"}),value:"0 0 1 1 *"}];return _.default.createElement("div",{style:{marginBottom:"24px"}},_.default.createElement(s.default,{title:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.run"})},_.default.createElement(p.default,(0,i.default)({},u,{onSubmit:this.handleSubmit}),"cronjob"===a&&_.default.createElement("div",{style:{position:"relative"}},_.default.createElement(p.default.Item,{label:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.rule"})},t("schedule",{initialValue:n.schedule||"",rules:[{required:!0,message:(0,E.formatMessage)({id:"componentOverview.body.Strategy.not_null"})}]})(_.default.createElement(c.default,{onChange:this.handleAutoComplete},m.length?m.map(e=>{var t=_.default.createElement(c.default.Option,{value:e.value},e.name);return t}):null))),_.default.createElement(d.default,{content:_.default.createElement("div",{style:{padding:"4px 8px",height:"auto",fontSize:"12px",color:"#757575"}},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.timing"})),placement:"right",trigger:"hover"},_.default.createElement(w.QuestionCircleOutlined,{style:{marginLeft:"10px",fontSize:"14px",position:"absolute",left:"34%",top:"30%"}}))),_.default.createElement("div",{style:{position:"relative"}},_.default.createElement(p.default.Item,{label:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.max"})},t("backoff_limit",{initialValue:n.backoff_limit||"",rules:[{required:!1,message:(0,E.formatMessage)({id:"componentOverview.body.Strategy.not_null"})},{max:20,message:(0,E.formatMessage)({id:"componentOverview.body.Strategy.length"})},{validator:this.handleCheckPort}]})(_.default.createElement(o.default,{type:"number",placeholder:(0,E.formatMessage)({id:"componentOverview.body.Strategy.input_max"})}))),_.default.createElement(d.default,{content:_.default.createElement("div",{style:{padding:"4px 8px",height:"auto",fontSize:"12px",color:"#757575"}},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.fail"})),placement:"right",trigger:"hover"},_.default.createElement(w.QuestionCircleOutlined,{style:{marginLeft:"10px",fontSize:"14px",position:"absolute",left:"34%",top:"30%"}}))),_.default.createElement("div",{style:{position:"relative"}},_.default.createElement(p.default.Item,{label:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.number"})},t("parallelism",{initialValue:n.parallelism||"",rules:[{required:!1,message:(0,E.formatMessage)({id:"componentOverview.body.Strategy.not_null"})},{max:20,message:(0,E.formatMessage)({id:"componentOverview.body.Strategy.length"})},{validator:this.handleCheckPort}]})(_.default.createElement(o.default,{type:"number",placeholder:(0,E.formatMessage)({id:"componentOverview.body.Strategy.input_number"})}))),_.default.createElement(d.default,{content:_.default.createElement("div",{style:{padding:"4px 8px",height:"auto",fontSize:"12px",color:"#757575"}},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.pod_onetime"})),placement:"right",trigger:"hover"},_.default.createElement(w.QuestionCircleOutlined,{style:{marginLeft:"10px",fontSize:"14px",position:"absolute",left:"34%",top:"30%"}}))),_.default.createElement("div",{style:{position:"relative"}},_.default.createElement(p.default.Item,{label:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.max_time"})},t("active_deadline_seconds",{initialValue:n.active_deadline_seconds||"",rules:[{required:!1,message:(0,E.formatMessage)({id:"componentOverview.body.Strategy.not_null"})},{max:20,message:(0,E.formatMessage)({id:"componentOverview.body.Strategy.length"})},{validator:this.handleCheckPort}]})(_.default.createElement(o.default,{type:"number",placeholder:(0,E.formatMessage)({id:"componentOverview.body.Strategy.Run_time"})}))),_.default.createElement(d.default,{content:_.default.createElement("div",{style:{padding:"4px 8px",height:"auto",fontSize:"12px",color:"#757575"}},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.job"})),placement:"right",trigger:"hover"},_.default.createElement(w.QuestionCircleOutlined,{style:{marginLeft:"10px",fontSize:"14px",position:"absolute",left:"34%",top:"30%"}}))),_.default.createElement("div",{style:{position:"relative"}},_.default.createElement(p.default.Item,{label:_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.completions"})},t("completions",{initialValue:n.completions||"",rules:[{required:!1,message:(0,E.formatMessage)({id:"componentOverview.body.Strategy.not_null"})},{max:20,message:(0,E.formatMessage)({id:"componentOverview.body.Strategy.length"})},{validator:this.handleCheckPort}]})(_.default.createElement(o.default,{type:"number",placeholder:(0,E.formatMessage)({id:"componentOverview.body.Strategy.input_completions"})}))),_.default.createElement(d.default,{content:_.default.createElement("div",{style:{padding:"4px 8px",height:"auto",fontSize:"12px",color:"#757575"}},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.pod"})),placement:"right",trigger:"hover"},_.default.createElement(w.QuestionCircleOutlined,{style:{marginLeft:"10px",fontSize:"14px",position:"absolute",left:"34%",top:"30%"}}))),_.default.createElement(p.default.Item,{wrapperCol:{xs:{span:3,offset:3},sm:{span:3,offset:3}}},_.default.createElement(r.default,{type:"primary",htmlType:"submit"},_.default.createElement(E.FormattedMessage,{id:"componentOverview.body.Strategy.save"}))))))}},g=v))||g)||g),O=S;t.default=O},v65o:function(e,t,a){e.exports={pageValue_style:"pageValue_style___1bqti",tipText_style:"tipText_style___whrMS",handleBtn_style:"handleBtn_style___1K9W7",selectstyle:"selectstyle___FCcAV",accountName_style:"accountName_style___NHR6r",en_accountName_style:"en_accountName_style___MfSIQ",nodeSelector_sytle:"nodeSelector_sytle___1wFGr",yamlValue_style:"yamlValue_style___3yULz",yamlTitle_style:"yamlTitle_style___ed2IH"}},vX3j:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var s=l(a("wCAj"));a("IzEo");var i=l(a("bx4M"));a("14J3");var r=l(a("BMrR"));a("jCWc");var o=l(a("kPKH"));a("+L6B");var d=l(a("2/Rp")),c=l(a("jehZ"));a("5NDa");var u=l(a("5rEg"));a("/xke");var m=l(a("TeRw")),p=l(a("p0pE"));a("2qtc");var f=l(a("kLXV"));a("y8nQ");var h=l(a("Vl3Y"));a("7Kak");var g,v,y,b,_=l(a("9yH6")),E=a("MuoO"),w=a("7DNP"),M=n(a("q1tI")),C=a("LLXN"),S=a("P5Jw"),O=l(a("q76B")),k=l(a("QDog")),A=(_.default.Group,h.default.Item),x=f.default.confirm,D=/^(?=^.{3,255}$)(http(s)?:\/\/)?(www\.)?[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+(:\d+)*(\/\w+\.\w+)*$/,F=/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/,T=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,P=(g=(0,E.connect)(e=>{var t=e.user,a=e.appControl;return{currUser:t.currentUser,appRequest:a.appRequest,appRequestRange:a.appRequestRange,requestTime:a.requestTime,requestTimeRange:a.requestTimeRange,appDisk:a.appDisk,appMemory:a.appMemory,appDetail:a.appDetail}},null,null,{withRef:!0}),v=h.default.create(),g(y=v((b=class extends M.PureComponent{constructor(e){super(e),this.fetchParameter=(()=>{var e=this.props.appAlias;return{team_name:k.default.getCurrTeamName(),region_name:k.default.getCurrRegionName(),app_alias:e}}),this.routeSwitch=(()=>{var e=this.props.dispatch,t=this.fetchParameter(),a=t.team_name,l=t.region_name,n=t.app_alias;e(w.routerRedux.replace("/team/".concat(a,"/region/").concat(l,"/components/").concat(n,"/thirdPartyServices")))}),this.showConfirm=(()=>{var e=this.props.dispatch,t=this.fetchParameter(),a=t.team_name,l=t.region_name,n=t.app_alias;x({title:(0,C.formatMessage)({id:"componentOverview.body.ThirdPartyServices.port"}),content:(0,C.formatMessage)({id:"componentOverview.body.ThirdPartyServices.foreign"}),okText:(0,C.formatMessage)({id:"componentOverview.body.ThirdPartyServices.configure"}),onOk(){e(w.routerRedux.push("/team/".concat(a,"/region/").concat(l,"/components/").concat(n,"/port")))},onCancel(){console.log("Cancel")}})}),this.handleGetList=(()=>{var e=this.props.dispatch;e({type:"appControl/getInstanceList",payload:this.fetchParameter(),callback:e=>{e&&200===e.status_code&&this.setState({endpoint_num:e.bean.endpoint_num>0?e.bean.endpoint_num:"",list:e.list})}})}),this.openDeleteVar=(e=>{this.setState({deleteVar:!0,ep_id:e})}),this.cancelDeleteVar=(()=>{this.setState({deleteVar:null})}),this.handleDeleteVar=(()=>{var e=this.state.ep_id;this.props.dispatch({type:"appControl/deleteInstanceList",payload:(0,p.default)({},this.fetchParameter(),{ep_id:e}),callback:e=>{e&&200===e.status_code&&(this.handleGetList(),this.cancelDeleteVar(),setTimeout(()=>{this.handleGetList()},5e4),m.default.info({message:(0,C.formatMessage)({id:"notification.hint.need_updata"})}))}})}),this.handleModify=(e=>{this.props.dispatch({type:"appControl/modifyInstanceList",payload:(0,p.default)({},this.fetchParameter(),{ep_id:e.ep_id}),callback:e=>{e&&200===e.status_code&&(e.bean&&e.bean.port_closed?this.showConfirm():(this.handleGetList(),this.cancelDeleteVar()))}})}),this.addInstance=(()=>{this.setState({visible:!0})}),this.handleSubmit=(e=>{e.preventDefault();var t=this.props,a=t.form,l=t.dispatch;a.validateFields((e,t)=>{e||l({type:"appControl/addInstanceList",payload:(0,p.default)({},this.fetchParameter(),{ip:t.ip}),callback:e=>{e&&200===e.status_code&&(this.setState({visible:!1}),this.handleGetList(),m.default.info({message:(0,C.formatMessage)({id:"notification.hint.need_updata"})}))}})})}),this.handleCancel=(()=>{this.setState({visible:!1})}),this.validAttrName=((e,t,a)=>{t&&""!==t?("1.1.1.1"===t&&a(M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.address"})),D.test(t||"")||F.test(t||"")||T.test(t||"")?a():a(M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.correct_address"}))):a(M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.ip"}))}),this.handleUpDatekey=(()=>{var e=this.props.dispatch;e({type:"appControl/editUpDatekey",payload:this.fetchParameter(),callback:e=>{e&&200===e.status_code&&this.setState({api_service_key:e.bean&&e.bean.api_service_key})}})}),this.state={endpoint_num:"",list:[],deleteVar:!1,visible:!1,ep_id:"",api_service_key:""}}componentDidMount(){this.routeSwitch(),this.handleGetList()}render(){var e=this.state,t=e.list,a=e.endpoint_num,l=e.api_service_key,n=e.visible,p=e.deleteVar,h=this.props,g=h.groupDetail,v=h.appDetail,y=h.form,b=y.getFieldDecorator,_=g&&g.app_type&&"helm"===g.app_type,E={labelCol:{span:5},wrapperCol:{span:19}},w=[{title:(0,C.formatMessage)({id:"componentOverview.body.ThirdPartyServices.instance_address"}),dataIndex:"ip",key:"1"},{title:(0,C.formatMessage)({id:"componentOverview.body.ThirdPartyServices.health_state"}),dataIndex:"status",align:"center",key:"2",render:e=>{var t={healthy:(0,C.formatMessage)({id:"componentOverview.body.ThirdPartyServices.health"}),unhealthy:(0,C.formatMessage)({id:"componentOverview.body.ThirdPartyServices.unhealth"}),notready:(0,C.formatMessage)({id:"componentOverview.body.ThirdPartyServices.not_ready"}),unknown:(0,C.formatMessage)({id:"componentOverview.body.ThirdPartyServices.unknown"})};return M.default.createElement("span",{style:{color:"healthy"==e?"green":"unhealthy"==e?"red":""}},t[e]||M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.not_online"}))}}];_||w.push({title:(0,C.formatMessage)({id:"componentOverview.body.ThirdPartyServices.operation"}),dataIndex:"ep_id",key:"3",render:e=>M.default.createElement("a",{style:{marginRight:"5px"},onClick:()=>{this.openDeleteVar(e)}},M.default.createElement(C.FormattedMessage,{id:"button.delete"}))});var k=l||(v.api_service_key?v.api_service_key:"");return M.default.createElement(M.Fragment,null,M.default.createElement(r.default,{gutter:24},n&&M.default.createElement(f.default,{title:M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.add"}),visible:!0,onOk:this.handleSubmit,onCancel:this.handleCancel},M.default.createElement(A,(0,c.default)({},E,{label:M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.instance_address"})}),b("ip",{rules:[{required:!0,validator:this.validAttrName}],initialValue:void 0})(M.default.createElement(u.default,{placeholder:(0,C.formatMessage)({id:"componentOverview.body.ThirdPartyServices.input_address"})})))),v&&v.service&&"third_party"===v.service.service_source&&M.default.createElement(i.default,{title:M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.service_instance"}),extra:_?null:M.default.createElement("div",null,"kubernetes"!==v.register_way&&M.default.createElement(d.default,{style:{marginRight:"5px"},onClick:()=>{this.addInstance()}},M.default.createElement(C.FormattedMessage,{id:"menu.team.create"})),M.default.createElement(d.default,{onClick:()=>{this.handleGetList()}},M.default.createElement(C.FormattedMessage,{id:"button.freshen"})))},M.default.createElement(r.default,null,M.default.createElement(o.default,{span:12},M.default.createElement("p",null,M.default.createElement("b",{style:{marginRight:16}},M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.type"})),v.register_way?v.register_way:""),v.api_url&&M.default.createElement("p",null,M.default.createElement("b",{style:{marginRight:16}},M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.api"})),v.api_url?v.api_url:"",M.default.createElement("div",{style:{margin:"5px 0"}},M.default.createElement("span",null,M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.key"})," ",M.default.createElement("a",null,k),M.default.createElement(S.CopyToClipboard,{text:k,onCopy:()=>{m.default.success({message:(0,C.formatMessage)({id:"notification.success.copy"})})}},M.default.createElement(d.default,{size:"small",style:{margin:"0 10px"}},M.default.createElement(C.FormattedMessage,{id:"button.copy"})))),M.default.createElement(d.default,{size:"small",onClick:()=>{this.handleUpDatekey()}},M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.re_key"})))),a&&M.default.createElement("p",null,M.default.createElement("b",{style:{marginRight:16}},M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.number"})),a>0?a:""),"kubernetes"===v.endpoints_type&&M.default.createElement("p",null,M.default.createElement("b",{style:{marginRight:16}}),v.kubernetes.namespace,"/",v.kubernetes.serviceName),v.discovery_type&&M.default.createElement("p",null,M.default.createElement("b",{style:{marginRight:16}},M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.dynamic"})),v.discovery_type),v.discovery_key&&M.default.createElement("p",null,M.default.createElement("b",{style:{marginRight:16}},M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.dynamic_key"})),v.discovery_key)),v.api_url&&M.default.createElement(o.default,{span:12},M.default.createElement("span",null,"API",M.default.createElement(C.FormattedMessage,{id:"componentOverview.body.ThirdPartyServices.msg"})),M.default.createElement("div",{style:{background:"#000",color:"#fff",padding:"16px"}},"curl -X PUT --url ".concat(v.api_url,' -H "Content-Type: application/json" -d \'{"secret_key":"').concat(k,'","ip":"192.168.1.1","is_online":true}\'')))))),M.default.createElement(r.default,null,M.default.createElement(s.default,{dataSource:t,columns:w,style:{background:"#fff",margin:"12px -12px 0 -12px"}})),p&&M.default.createElement(O.default,{onOk:this.handleDeleteVar,onCancel:this.cancelDeleteVar,title:M.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.env.title"}),desc:M.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.env.desc"}),subDesc:M.default.createElement(C.FormattedMessage,{id:"confirmModal.deldete.env.subDesc"})}))}},y=b))||y)||y);t.default=P},ye39:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var s=l(a("BMrR"));a("jCWc");var i=l(a("kPKH"));a("IzEo");var r=l(a("bx4M"));a("DjyN");var o=l(a("NUBc"));a("P2fV");var d=l(a("NJEC"));a("/zsF");var c=l(a("PArb"));a("5Dmo");var u=l(a("3S7+"));a("y8nQ");var m,p,f,h,g=l(a("Vl3Y")),v=a("MuoO"),y=l(a("wd/R")),b=n(a("q1tI")),_=l(a("QDog")),E=l(a("8+Sn")),w=l(a("LrcT")),M=l(a("Sw8b")),C=a("LLXN"),S=(m=(0,v.connect)(),p=g.default.create(),m(f=p((h=class extends b.PureComponent{constructor(e){super(e),this.showModal=(e=>{this.setState({EventID:e,logVisible:!0})}),this.handleOk=(()=>{this.setState({logVisible:!1})}),this.handleCancel=(()=>{this.setState({logVisible:!1})}),this.handleRolback=(e=>{var t=this.props.onRollback;t&&t(e)}),this.handleDel=(e=>{var t=this.props.handleDel;t&&t(e)}),this.showStatus=(e=>{switch(e){case"":return"".concat((0,C.formatMessage)({id:"componentOverview.body.tab.overview.buildHistory.under"}));case"success":return"".concat((0,C.formatMessage)({id:"componentOverview.body.tab.overview.buildHistory.success"}));case"failure":return"".concat((0,C.formatMessage)({id:"componentOverview.body.tab.overview.buildHistory.fail"}));default:return"".concat((0,C.formatMessage)({id:"componentOverview.body.tab.overview.buildHistory.unknown"}))}}),this.state={logVisible:!1,EventID:"",language:"zh-CN"===E.default.get("language")}}componentDidMount(){}render(){var e=this.props,t=e.dataList,a=e.current_version,l=e.componentPermissions,n=l.isRollback,m=l.isDelete,p=e.pages,f=e.pageSize,h=e.total,g=e.onPageChange,v=e.onShowSizeChange,E=this.state,S=E.EventID,O=E.logVisible,k=E.language;return b.default.createElement(s.default,{gutter:24},O&&b.default.createElement(M.default,{title:b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.buildLog"}),EventID:S,onOk:this.handleOk,onCancel:this.handleCancel,width:"1200px"}),b.default.createElement(i.default,{xs:24,xm:24,md:24,lg:24,xl:24},b.default.createElement(r.default,{bordered:!1,title:b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.buildVersionHistory"}),style:{margin:"20px 0"}},b.default.createElement("div",{className:w.default.buildHistoryBox},b.default.createElement("ul",{className:w.default.buildHistoryList},t&&t.length>0&&t.map(e=>{var t=e.code_commit_msg,l=e.image_domain,s=e.build_user,i=e.code_version,r=e.status,o=e.create_time,p=e.build_version,f=e.finish_time,h=e.upgrade_or_rollback,g=e.event_id,v=e.image_repo,E=e.code_branch,M=e.image_tag,S=e.kind;return b.default.createElement("li",{key:p,className:"".concat(w.default.rowLi," ").concat(k?w.default.prRow:w.default.en_prRow," ").concat("success"===r?w.default.passed:"failure"===r?w.default.failed:w.default.canceled," ")},b.default.createElement("div",{className:"".concat(k?w.default.lineone:w.default.en_lineone," ").concat(w.default.fadeOute)},b.default.createElement("div",{className:"".concat(w.default.rowRtem," ").concat(w.default.buildInfo)},b.default.createElement("div",{className:" ".concat(w.default.alcen,"  ").concat(w.default.rowBranch)},b.default.createElement("span",{className:"".concat(w.default.statusIcon," ")},"success"===r?_.default.fetchSvg("success"):"failure"===r?b.default.createElement("span",{className:w.default.icon,style:{textAlign:"center",color:"#db4545",display:"inline-block",lineHeight:1}},"!"):_.default.fetchSvg("close")),b.default.createElement("a",{className:" ".concat(w.default.alcen," ").concat(w.default.passeda," ")},b.default.createElement(u.default,{title:p&&a&&p===a?p+(0,C.formatMessage)({id:"componentOverview.body.tab.overview.buildHistory.currentVersion"}):p},b.default.createElement("font",{className:w.default.nowarpCorolText,style:{width:180,color:"success"===r?"#39aa56":"failure"===r?"#db4545":"#9d9d9d",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}},p,p&&a&&p===a&&b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.currentVersion"}))))),b.default.createElement("div",{className:" ".concat(w.default.alcen," ").concat(w.default.rowMessage," ")},b.default.createElement(u.default,{title:S&&("\u6e90\u7801\u6784\u5efa"===S?b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.submitInformation"}):"\u672c\u5730\u6587\u4ef6"===S?b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.fileName"}):b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.address"}))},S&&("\u6e90\u7801\u6784\u5efa"===S?_.default.fetchSvg("basicInfo"):_.default.fetchSvg("warehouse"))),b.default.createElement(u.default,{title:S&&("\u6e90\u7801\u6784\u5efa"===S?t&&t:"\u672c\u5730\u6587\u4ef6"===S?t&&t:l&&l)},b.default.createElement("span",{className:w.default.nowarpCorolText,style:{width:"90%"}},S&&("\u6e90\u7801\u6784\u5efa"===S?t&&t:"\u672c\u5730\u6587\u4ef6"===S?t&&t:l&&l))))),b.default.createElement("div",{className:"".concat(w.default.rowRtem," ").concat(w.default.buildCommitter," ").concat(w.default.alcen)},b.default.createElement("div",{style:{width:"210px"}},b.default.createElement("a",{style:{width:"100%",cursor:"auto"}},b.default.createElement("font",{className:w.default.nowarpCorolText,style:{width:"90%"}},s&&" @&nbsp;".concat(s)))),b.default.createElement("div",{className:" ".concat(w.default.alcen," ").concat(w.default.calcwd," ")},b.default.createElement("a",{className:"".concat(w.default.alcen),style:{width:"50%",cursor:"auto"}},b.default.createElement(u.default,{title:S&&("\u6e90\u7801\u6784\u5efa"===S?b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.CodeBranch"}):"\u672c\u5730\u6587\u4ef6"===S?b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.uploadTime"}):b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.imageName"}))},S&&("\u6e90\u7801\u6784\u5efa"===S?_.default.fetchSvg("branch"):_.default.fetchSvg("basicInfo"))),b.default.createElement(u.default,{title:S&&("\u6e90\u7801\u6784\u5efa"===S?E&&E:"\u672c\u5730\u6587\u4ef6"===S?E&&E:v&&v)},b.default.createElement("span",{className:w.default.nowarpCorolText,style:{width:"90%"}},S&&("\u6e90\u7801\u6784\u5efa"===S?E&&E:"\u672c\u5730\u6587\u4ef6"===S?E&&E:v&&v)))),b.default.createElement("a",{className:" ".concat(w.default.alcen," "),style:{width:"50%",cursor:"auto"}},b.default.createElement(u.default,{title:S&&("\u6e90\u7801\u6784\u5efa"===S?b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.codeVersion"}):"\u672c\u5730\u6587\u4ef6"===S?b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.file"}):b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.tag"}))},b.default.createElement("span",{className:" ".concat(w.default.alcen," ").concat(w.default.buildwidth," "),style:{color:"rgba(0, 0, 0, 0.65)"}},S&&("\u6e90\u7801\u6784\u5efa"===S?_.default.fetchSvg("warehouse"):_.default.fetchSvg("branch")))),b.default.createElement(u.default,{title:S&&("\u6e90\u7801\u6784\u5efa"===S?i:"\u672c\u5730\u6587\u4ef6"===S?i:M&&M)},b.default.createElement("font",{className:w.default.nowarpCorolText,style:{width:"90%"}},S&&("\u6e90\u7801\u6784\u5efa"===S?i&&i.substr(0,8):"\u672c\u5730\u6587\u4ef6"===S?i&&i:M||""))))))),b.default.createElement("div",{className:"".concat(k?w.default.linetwo:w.default.en_linetwo)},b.default.createElement("div",{className:"".concat(w.default.rowRtem," ").concat(w.default.alcen)},b.default.createElement("a",{className:"success"===r?w.default.passeda:"failure"===r?w.default.faileda:w.default.canceleda},_.default.fetchSvg("logState","failure"===r?"#39AA56#db4545":"#39AA56"),b.default.createElement("font",{style:{fontSize:"14px",color:"failure"===r?"#39AA56#db4545":"#39AA56"}},this.showStatus(r)))),b.default.createElement("div",{className:"".concat(w.default.rowRtem," ")})),b.default.createElement("div",{className:"".concat(k?w.default.linestree:w.default.en_linestree)},b.default.createElement("div",{className:"".concat(w.default.rowRtem," ").concat(w.default.rowDuration)},b.default.createElement("div",{className:w.default.alcen},b.default.createElement(u.default,{title:b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.runTime"})},_.default.fetchSvg("runTime")),b.default.createElement("time",{className:w.default.labelAlign},b.default.createElement("font",{style:{display:"inline-block",color:"rgba(0,0,0,0.45)"}},_.default.fetchTime(f?new Date(f).getTime()-new Date(o).getTime():Date.parse(new Date)-new Date(o).getTime()))))),b.default.createElement("div",{className:"".concat(w.default.rowRtem," ").concat(w.default.rowCalendar," ").concat(w.default.alcen)},b.default.createElement("div",{className:w.default.alcen},b.default.createElement(u.default,{title:b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.creationTime"})},_.default.fetchSvg("createTime")),b.default.createElement("time",{className:w.default.labelAlign},b.default.createElement("font",{style:{display:"inline-block",color:"rgba(0,0,0,0.45)"}},o&&(0,y.default)(o).locale("zh-cn").format("YYYY-MM-DD HH:mm:ss")))))),b.default.createElement("div",{className:"".concat(k?w.default.linefour:w.default.en_linefour)},b.default.createElement("span",null,b.default.createElement("a",{style:{fontSize:"12px"},onClick:()=>{this.showModal(g)}},b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.log"}))),1==h&&n?b.default.createElement(d.default,{title:b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.popUpgrade"}),onConfirm:()=>{this.handleRolback(e)}},b.default.createElement("span",null,b.default.createElement(c.default,{type:"vertical"}),b.default.createElement("a",{style:{fontSize:"12px"}},b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.upgrade"})))):-1==h&&"success"==r&&p!=a&&n&&a?b.default.createElement(d.default,{title:b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.poprollback"}),onConfirm:()=>{this.handleRolback(e)}},b.default.createElement("span",null,b.default.createElement(c.default,{type:"vertical"}),b.default.createElement("a",{style:{fontSize:"12px"}},b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.roolback"})))):"",b.default.createElement(d.default,{title:b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.popDelete"}),onConfirm:()=>{this.handleDel(e)}},p!==a&&m&&a&&r.length>0&&b.default.createElement("span",null,b.default.createElement(c.default,{type:"vertical"}),b.default.createElement("a",{style:{fontSize:"12px"}},b.default.createElement(C.FormattedMessage,{id:"componentOverview.body.tab.overview.buildHistory.delete"}))))))}))),b.default.createElement("div",{style:{textAlign:"right",marginTop:"24px"}},Number(h)>f&&b.default.createElement(o.default,{current:p,pageSize:f,showSizeChanger:!0,total:Number(h),defaultCurrent:1,onChange:g,pageSizeOptions:["5","10","20","50"],onShowSizeChange:v})))))}},f=h))||f)||f),O=S;t.default=O},z1Ga:function(e,t,a){"use strict";var l=a("tAuX"),n=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=n(a("kLXV"));a("g9YV");var i=n(a("wCAj"));a("5Dmo");var r=n(a("3S7+"));a("5NDa");var o=n(a("5rEg"));a("/xke");var d=n(a("TeRw")),c=a("7DNP"),u=l(a("q1tI")),m=a("LLXN"),p=a("xpXo"),f=n(a("QDog"));class h extends u.PureComponent{constructor(e){super(e),this.handleSubmit=(()=>{if(this.state.selectedRowKeys.length){var e=[];e=this.state.selectedRowKeys.map(e=>{var t=this.state.list[e];return{id:t.dep_vol_id,path:this.state.localpaths[t.dep_vol_id]}}),e=e.filter(e=>!!e.path),e.length?this.props.onSubmit&&this.props.onSubmit(e):d.default.warning({message:(0,m.formatMessage)({id:"notification.warn.inspect.fillIn"})})}else d.default.warning({message:(0,m.formatMessage)({id:"notification.warn.choice.catalogue"})})}),this.handleTableChange=((e,t)=>{this.setState({current:e,pageSize:t},()=>{this.loadUnMntList()})}),this.loadUnMntList=(()=>{(0,p.getMnt)({team_name:f.default.getCurrTeamName(),app_alias:this.props.appAlias,page:this.state.current,page_size:this.state.pageSize,type:"unmnt",volume_type:this.props.volume_type?this.props.volume_type:["share-file","memoryfs","local"]}).then(e=>{e&&this.setState({list:e.list||[],total:e.total})})}),this.handleCancel=(()=>{this.props.onCancel&&this.props.onCancel()}),this.isDisabled=((e,t)=>-1===this.state.selectedRowKeys.indexOf(t)),this.handleChange=((e,t,a)=>{var l=this.state.localpaths;l[t.dep_vol_id]=e,this.setState({localpaths:l})}),this.state={selectedRowKeys:[],list:[],total:0,current:1,pageSize:6,localpaths:{}}}componentDidMount(){this.loadUnMntList()}render(){var e={onChange:(e,t)=>{this.setState({selectedRowKeys:e})}},t=this.state,a=t.total,l=t.current,n=t.pageSize,d={onChange:this.handleTableChange,total:a,pageSize:n,current:l};return u.default.createElement(s.default,{title:u.default.createElement(m.FormattedMessage,{id:"componentOverview.body.tab.RelationMnt.title"}),width:1150,visible:!0,onOk:this.handleSubmit,onCancel:this.handleCancel},u.default.createElement(i.default,{pagination:d,dataSource:this.state.list,rowSelection:e,style:{width:"100%",overflowX:"auto"},columns:[{title:(0,m.formatMessage)({id:"componentOverview.body.tab.RelationMnt.localpath"}),dataIndex:"localpath",key:"1",width:"20%",render:(e,t,a)=>u.default.createElement(o.default,{onChange:e=>{this.handleChange(e.target.value,t,a)},disabled:this.isDisabled(t,a)})},{title:(0,m.formatMessage)({id:"componentOverview.body.tab.RelationMnt.dep_vol_name"}),dataIndex:"dep_vol_name",key:"2",width:"20%",render:(e,t)=>u.default.createElement(r.default,{title:e},u.default.createElement("span",{style:{wordBreak:"break-all",wordWrap:"break-word"}},e))},{title:(0,m.formatMessage)({id:"componentOverview.body.tab.RelationMnt.dep_vol_path"}),dataIndex:"dep_vol_path",key:"3",width:"20%",render:(e,t)=>u.default.createElement(r.default,{title:e},u.default.createElement("span",{style:{wordBreak:"break-all",wordWrap:"break-word"}},e))},{title:(0,m.formatMessage)({id:"componentOverview.body.tab.RelationMnt.dep_app_name"}),dataIndex:"dep_app_name",key:"5",width:"20%",render:(e,t)=>{return u.default.createElement(r.default,{title:e},u.default.createElement(c.Link,{to:"/team/".concat(f.default.getCurrTeamName(),"/region/").concat(f.default.getCurrRegionName(),"/components/").concat(t.dep_app_alias,"/overview")},u.default.createElement("span",{style:{wordBreak:"break-all",wordWrap:"break-word"}},e)))}},{title:(0,m.formatMessage)({id:"componentOverview.body.tab.RelationMnt.dep_app_group"}),dataIndex:"dep_app_group",key:"6",width:"15%",render:(e,t)=>{return u.default.createElement(r.default,{title:e},u.default.createElement(c.Link,{to:"/team/".concat(f.default.getCurrTeamName(),"/region/").concat(f.default.getCurrRegionName(),"/apps/").concat(t.dep_group_id)},u.default.createElement("span",{style:{wordBreak:"break-all",wordWrap:"break-word"}},e)))}}]}))}}t.default=h},zMIy:function(e,t,a){e.exports={logsss:"logsss___2W4kX",podCascader:"podCascader___3Aq0a",logModal:"logModal___24kgh",History1000Log:"History1000Log___2tNcS"}},zQST:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l={haveFeature(e,t){return!(!e||0===e.length)&&e.filter(e=>e.code===t).length>0}};t.default=l}}]);