(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[42],{"44vR":function(e,t,a){e.exports={breadStyle:"breadStyle___1qExY",titleStyle:"titleStyle___q7Ei-"}},BnX1:function(e,t,a){"use strict";var l=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV"));a("g9YV");var n=l(a("wCAj")),d=l(a("jehZ"));a("giR+");var o=l(a("fyUT"));a("fOrg");var i=l(a("+KLJ"));a("IzEo");var u=l(a("bx4M"));a("bP8k");var c=l(a("gFTJ"));a("14J3");var m=l(a("BMrR"));a("Pwec");var f=l(a("CtXQ"));a("+L6B");var p=l(a("2/Rp"));a("jCWc");var h=l(a("kPKH"));a("cWXX");var g=l(a("/ezw"));a("/xke");var y=l(a("TeRw"));a("Awhp");var E=l(a("KrTs"));a("5Dmo");var C=l(a("3S7+"));a("y8nQ");var v,b,_,w,S=l(a("Vl3Y")),M=r(a("q1tI")),k=a("LLXN"),x=a("MuoO"),I=a("7DNP"),L=l(a("q76B")),T=l(a("ESNr")),N=l(a("Z4Z6")),R=l(a("QDog")),D=l(a("gLJQ")),F=(v=(0,x.connect)(),b=S.default.create(),v(_=b((w=class extends M.Component{constructor(e){var t;super(e),t=this,this.clusterInstallType=(e=>{if(!e)return!1;switch(e){case"ack":return M.default.createElement("span",{style:{marginRight:"8px"},key:e},"ACK");case"custom":return M.default.createElement("span",{style:{marginRight:"8px"},key:e},M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.custom"}));case"rke":return M.default.createElement(C.default,{title:M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.rke.tooltip"})},M.default.createElement("span",{style:{marginRight:"8px"},key:e},M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.rke"})));case"tke":return M.default.createElement("span",{style:{marginRight:"8px"},key:e},"TKE");case"helm":return M.default.createElement("span",{style:{marginRight:"8px"},key:e},M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.helm"}));default:return M.default.createElement("span",{style:{marginRight:"8px"},key:e},M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.other"}))}}),this.clusterStatus=((e,t)=>{if("failure"===t)return M.default.createElement("span",{style:{color:"red"}},M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.state.err"}));switch(e){case"0":return M.default.createElement("div",{style:{color:"#1890ff"}},M.default.createElement(E.default,{color:"#1890ff"}),M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.state.edit"}));case"1":return M.default.createElement("div",{style:{color:"#52c41a"}},M.default.createElement(E.default,{color:"#52c41a"}),M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.state.run"}));case"2":return M.default.createElement("div",{style:{color:"#b7b7b7"}},M.default.createElement(E.default,{color:"#b7b7b7"}),M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.state.down"}));case"3":return M.default.createElement("div",{style:{color:"#1890ff"}},M.default.createElement(E.default,{color:"#1890ff"}),M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.state.maintain"}));case"5":return M.default.createElement("div",{style:{color:"red"}},M.default.createElement(E.default,{color:"red"}),M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.state.abnormal"}));default:return M.default.createElement("div",{style:{color:"#fff"}},M.default.createElement(E.default,{color:"#fff"}),M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.state.unknown"}))}}),this.clusterIcon=((e,t)=>{var a={marginRight:"8px",display:"inline-block"},l="custom"==t?a:"";switch(e){case"ack":return M.default.createElement("span",{style:{marginRight:"8px"},key:e},M.default.createElement("div",{className:D.default.icons},R.default.fetchSvg("Ack")));case"rke":return M.default.createElement("span",{style:{marginRight:"8px"},key:e},M.default.createElement("div",{className:D.default.icons},M.default.createElement("img",{src:N.default,alt:""})));case"tke":return M.default.createElement("span",{style:{marginRight:"8px"},key:e},M.default.createElement("div",{className:D.default.icons},R.default.fetchSvg("Tke")));case"K3s":return M.default.createElement("span",{style:{marginRight:"8px"},key:e},M.default.createElement("div",{className:D.default.icons},M.default.createElement("img",{style:{height:"120px"},src:K3s,alt:""})));case"helm":return M.default.createElement("span",{style:l,key:e},M.default.createElement("div",{className:D.default.icons},R.default.fetchSvg("aliyun"==t?R.default.fetchSvg("Ack"):"huawei"==t?R.default.fetchSvg("Tke"):"tencent"==t?R.default.fetchSvg("Cce"):R.default.fetchSvg("K8s"))),M.default.createElement("p",null,R.default.fetchSvg("aliyun"==t?"Aliyun   ACK":"huawei"==t?"Huawei   CCE":"tencent"==t?"Tencent   TKE":"")));default:return M.default.createElement("span",{style:{marginRight:"8px",display:"inline-block",marginTop:"20px"},key:e},R.default.fetchSvg("K8s"))}}),this.buttonShow=(()=>{this.setState({buttonSwitch:!0})}),this.handleDelete=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=t.props,l=a.dispatch,r=a.rowClusterInfo,s=R.default.getCurrEnterpriseId();l({type:"region/deleteEnterpriseCluster",payload:{region_id:r.region_id,enterprise_id:s,force:e},callback:e=>{e&&200===e._condition&&(y.default.success({message:(0,k.formatMessage)({id:"notification.success.delete"})}),l((0,I.routerRedux)("/enterprise/".concat(s,"/clusters"))))},handleError:e=>{e&&e.data&&10050===e.data.code&&(t.setState({delVisible:!1}),t.handleMandatoryDelete())}})},this.cancelClusters=(()=>{this.setState({delVisible:!1})}),this.handleMandatoryDelete=(()=>{var e=this;confirm({title:(0,k.formatMessage)({id:"enterpriseColony.mgt.cluster.delect"}),content:(0,k.formatMessage)({id:"enterpriseColony.mgt.cluster.restore"}),okText:(0,k.formatMessage)({id:"button.determine"}),cancelText:(0,k.formatMessage)({id:"button.cancel"}),onOk(){return e.handleDelete(!0),new Promise((e,t)=>{setTimeout(Math.random()>.5?e:t,1e3)}).catch(e=>console.log(e))}})}),this.delEven=(()=>{this.setState({delVisible:!0})}),this.importEven=(()=>{var e=this.props,t=e.dispatch,a=e.rowClusterInfo,l=R.default.getCurrEnterpriseId();t(I.routerRedux.push("/enterprise/".concat(l,"/importMessage?region_id=").concat(a.region_id)))}),this.handleEdit=(e=>{var t=this.props.rowClusterInfo;this.loadPutCluster(t.region_id)}),this.loadPutCluster=(e=>{var t=this.props,a=t.dispatch,l=t.rowClusterInfo,r=R.default.getCurrEnterpriseId();a({type:"region/fetchEnterpriseCluster",payload:{enterprise_id:r,region_id:l.region_id},callback:e=>{e&&200===e.status_code&&this.setState({editClusterInfo:e.bean,editClusterShow:!0,text:(0,k.formatMessage)({id:"enterpriseColony.button.edit"})})}})}),this.cancelEditClusters=(()=>{this.props.loadClusters(),this.setState({editClusterShow:!1,text:"",editClusterInfo:!1})}),this.showRegions=(()=>{var e=this.props.rowClusterInfo;this.setState({showTenantList:!0,regionAlias:e.region_alias,regionName:e.region_name,showTenantListRegion:e.region_id,loadTenants:!0},this.loadRegionTenants)}),this.loadRegionTenants=(()=>{var e=this.state,t=e.tenantPage,a=e.tenantPageSize,l=e.showTenantListRegion,r=R.default.getCurrEnterpriseId(),s=this.props.dispatch;s({type:"region/fetchEnterpriseClusterTenants",payload:{enterprise_id:r,page:t,pageSize:a,region_id:l},callback:e=>{e&&e.bean?this.setState({tenants:e.bean.tenants,tenantTotal:e.bean.total,loadTenants:!1}):this.setState({loadTenants:!1})},handleError:()=>{this.setState({loadTenants:!1})}})}),this.submitLimit=(e=>{e.preventDefault();var t=this.props.form,a=R.default.getCurrEnterpriseId(),l=this.state,r=l.limitTenantName,s=l.showTenantListRegion;t.validateFields({force:!0},(e,t)=>{e||(this.setState({limitSummitLoading:!0}),this.props.dispatch({type:"region/setEnterpriseTenantLimit",payload:{enterprise_id:a,region_id:s,tenant_name:r,limit_memory:t.limit_memory},callback:()=>{y.default.success({message:(0,k.formatMessage)({id:"notification.success.setting_successfully"})}),this.setState({limitSummitLoading:!1,setTenantLimitShow:!1}),this.loadRegionTenants()},handleError:()=>{y.default.warning({message:(0,k.formatMessage)({id:"notification.error.setting_failed"})}),this.setState({limitSummitLoading:!1})}}))})}),this.hideTenantListShow=(()=>{this.setState({showTenantList:!1,showTenantListRegion:"",tenants:[]})}),this.setTenantLimit=(e=>{this.setState({setTenantLimitShow:!0,limitTenantName:e.tenant_name,limitTeamName:e.team_name,initLimitValue:e.set_limit_memory})}),this.handleTenantPageChange=(e=>{this.setState({tenantPage:e},this.loadRegionTenants)}),this.handleJoinTeams=(e=>{var t=this.state.regionName,a=this.props.dispatch;a({type:"teamControl/joinTeam",payload:{team_name:e},callback:a=>{a&&200===a.status_code&&this.onJumpTeam(e,t)}})}),this.onJumpTeam=((e,t)=>{var a=this.props.dispatch;a(I.routerRedux.push("/team/".concat(e,"/region/").concat(t,"/index")))}),this.state={buttonSwitch:!1,delVisible:!1,editClusterShow:!1,editClusterInfo:{},text:"",showTenantList:!1,showTenantListRegion:"",loadTenants:!0,tenants:[],tenantPage:1,tenantPageSize:5,tenantTotal:0,loadTenants:!1}}render(){var e=this.state,t=e.buttonSwitch,a=e.delVisible,l=e.editClusterShow,r=e.editClusterInfo,y=e.text,E=e.tenants,v=e.loadTenants,b=e.showTenantList,_=e.limitSummitLoading,w=e.initLimitValue,x=e.setTenantLimitShow,N=e.tenantTotal,F=e.tenantPageSize,P=e.tenantPage,K=e.limitTeamName,A=e.regionAlias,q=this.props,X=q.rowClusterInfo,U=q.form,V=q.showInfo,j=void 0!==V&&V,J=q.nodeType,O=X.region_alias,B=X.status,Q=X.rbd_version,z=X.provider,Y=X.k8s_version,W=X.create_time,H=(X.all_nodes,X.health_status),Z=X.region_type,G=X.region_id,$=(X.provider_cluster_id,R.default.getCurrEnterpriseId()),ee={onChange:this.handleTenantPageChange,total:N,pageSize:F,current:P},te=U.getFieldDecorator,ae=[{title:(0,k.formatMessage)({id:"enterpriseColony.table.handle.quota.table.label.team_name"}),dataIndex:"team_name",align:"center",render:(e,t)=>{return M.default.createElement("a",{onClick:()=>{this.handleJoinTeams(t.tenant_name)}},t.team_name)}},{title:(0,k.formatMessage)({id:"enterpriseColony.table.handle.quota.table.label.memory_request"}),dataIndex:"memory_request",align:"center"},{title:(0,k.formatMessage)({id:"enterpriseColony.table.handle.quota.table.label.cpu_request"}),dataIndex:"cpu_request",align:"center"},{title:(0,k.formatMessage)({id:"enterpriseColony.table.handle.quota.table.label.set_limit_memory"}),dataIndex:"set_limit_memory",align:"center"},{title:(0,k.formatMessage)({id:"enterpriseColony.table.handle.quota.table.label.running_app_num"}),dataIndex:"running_app_num",align:"center"},{title:(0,k.formatMessage)({id:"enterpriseColony.table.handle.quota.table.label.method"}),dataIndex:"method",align:"center",width:"100px",render:(e,t)=>{return[M.default.createElement("a",{onClick:()=>{this.setTenantLimit(t)}},(0,k.formatMessage)({id:"enterpriseColony.table.handle.quota.table.label.method.btn"}))]}}],le={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:20},sm:{span:12}}};return M.default.createElement(M.default.Fragment,null,M.default.createElement(u.default,{style:{boxShadow:"rgba(36, 46, 66, 0.16) 2px 4px 10px 0px"}},!j&&M.default.createElement(g.default,{active:!0}),j&&M.default.createElement(M.default.Fragment,null,M.default.createElement(m.default,{className:D.default.InfoStyle},M.default.createElement(h.default,{span:3},this.clusterIcon(z,Z&&Z.length>0&&Z[0])),M.default.createElement(h.default,{span:3},M.default.createElement("p",null,O),M.default.createElement("p",null,(0,k.formatMessage)({id:"enterpriseColony.mgt.cluster.clusterName"}))),M.default.createElement(h.default,{span:3},M.default.createElement("p",null,this.clusterStatus(B,H)),M.default.createElement("p",null,(0,k.formatMessage)({id:"enterpriseColony.mgt.cluster.clusterStatus"}))),M.default.createElement(h.default,{span:15},M.default.createElement(p.default,{onClick:this.handleEdit},M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.handle.edit"})),M.default.createElement(p.default,{onClick:this.importEven},M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.handle.import"})),M.default.createElement(p.default,{onClick:this.delEven},M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.handle.delete"})),!t&&M.default.createElement(C.default,{title:(0,k.formatMessage)({id:"enterpriseColony.mgt.cluster.click"})},M.default.createElement(f.default,{type:"ellipsis",onClick:this.buttonShow,style:{fontSize:30}})),t&&M.default.createElement(M.default.Fragment,null,M.default.createElement(p.default,{onClick:()=>{this.showRegions()}},M.default.createElement(k.FormattedMessage,{id:"enterpriseColony.table.handle.quota"})),M.default.createElement(p.default,{onClick:()=>{this.props.dispatch(I.routerRedux.push("/enterprise/".concat($,"/clusters/").concat(G,"/dashboard")))}},(0,k.formatMessage)({id:"enterpriseSetting.basicsSetting.monitoring.form.label.cluster_monitor_suffix"}))))),M.default.createElement(m.default,{className:D.default.ClusterInfo},M.default.createElement(c.default,null,M.default.createElement(c.default.Item,{label:(0,k.formatMessage)({id:"enterpriseColony.mgt.cluster.clusterVs"}),span:2},Q||"-"),M.default.createElement(c.default.Item,{label:(0,k.formatMessage)({id:"enterpriseColony.mgt.cluster.clusterNum"})},M.default.createElement("span",{className:D.default.nodeType},J&&Object.keys(J).length>0?Object.keys(J).map(e=>{return M.default.createElement("span",null,J[e]," ",e," ")}):"-")),M.default.createElement(c.default.Item,{label:(0,k.formatMessage)({id:"enterpriseColony.mgt.cluster.installType"})},this.clusterInstallType(z)||"-"),M.default.createElement(c.default.Item,{label:(0,k.formatMessage)({id:"enterpriseColony.mgt.cluster.kubernetesVs"}),span:2},Y=={}?"-":Y||"-"),M.default.createElement(c.default.Item,{label:(0,k.formatMessage)({id:"enterpriseColony.mgt.cluster.time"})},W&&W.substr(0,10)||"-"))))),a&&M.default.createElement(L.default,{title:(0,k.formatMessage)({id:"confirmModal.cluster.delete.title"}),subDesc:(0,k.formatMessage)({id:"confirmModal.delete.strategy.subDesc"}),desc:(0,k.formatMessage)({id:"confirmModal.delete.cluster.desc"}),onOk:()=>this.handleDelete(!1),onCancel:this.cancelClusters}),l&&M.default.createElement(T.default,{regionInfo:r,title:y,eid:$,onOk:this.cancelEditClusters,onCancel:this.cancelEditClusters}),b&&M.default.createElement(s.default,{maskClosable:!1,title:"",width:800,visible:b,footer:null,onOk:this.hideTenantListShow,onCancel:this.hideTenantListShow},x&&M.default.createElement("div",null,M.default.createElement(i.default,{style:{margin:"20px 0 16px 0"},message:(0,k.formatMessage)({id:"enterpriseColony.table.handle.quota.alert"},{name:K})+(0,k.formatMessage)({id:"enterpriseColony.table.handle.quota.alert1"},{region:A})}),M.default.createElement(S.default,{onSubmit:this.submitLimit},M.default.createElement(S.default.Item,(0,d.default)({},le,{name:"limit_memory",label:(0,k.formatMessage)({id:"enterpriseColony.table.handle.quota.form.label.limit_memory"})}),te("limit_memory",{initialValue:w,rules:[{required:!0,message:(0,k.formatMessage)({id:"placeholder.limit_memory"})}]})(M.default.createElement(o.default,{style:{width:"200px"},min:0,precision:0,max:2147483647}))),M.default.createElement("div",{style:{textAlign:"center"}},M.default.createElement(p.default,{onClick:()=>{this.setState({setTenantLimitShow:!1,limitSummitLoading:!1})}},(0,k.formatMessage)({id:"button.cancel"})),M.default.createElement(p.default,{style:{marginLeft:"16px"},type:"primary",loading:_,htmlType:"submit"},(0,k.formatMessage)({id:"button.confirm"}))))),!x&&M.default.createElement("div",null,M.default.createElement(i.default,{style:{margin:"20px 0 16px 0"},message:(0,k.formatMessage)({id:"enterpriseColony.table.handle.quota.form.label.alert"})}),M.default.createElement(n.default,{pagination:ee,dataSource:E,columns:ae,loading:v}))))}},_=w))||_)||_),P=F;t.default=P},E9cK:function(e,t,a){e.exports={titleStyle:"titleStyle___2k1aS",chartsStyle:"chartsStyle___3m3wq"}},LpW7:function(e,t,a){"use strict";var l=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV"));a("+L6B");var n=l(a("2/Rp"));a("IzEo");var d=l(a("bx4M"));a("cWXX");var o=l(a("/ezw"));a("g9YV");var i=l(a("wCAj"));a("14J3");var u=l(a("BMrR"));a("jCWc");var c=l(a("kPKH"));a("Awhp");var m=l(a("KrTs"));a("fu2T");var f,p,h,g=l(a("gK9i")),y=r(a("q1tI")),E=a("MuoO"),C=a("LLXN"),v=l(a("2lxJ")),b=l(a("QDog")),_=l(a("ipdq")),w=(l(a("XDRB")),a("mLYH"),g.default.Panel,f=(0,E.connect)(),f((h=class extends y.Component{constructor(e){super(e),this.getStatus=(e=>{switch(e){case"Pending":return y.default.createElement("div",{style:{color:"#1890ff"}},y.default.createElement(m.default,{color:"#1890ff"}),"Pending");case"Running":return y.default.createElement("div",{style:{color:"#52c41a"}},y.default.createElement(m.default,{color:"#52c41a"}),"Running");case"Succeeded":return y.default.createElement("div",{style:{color:"#52c41a"}},y.default.createElement(m.default,{color:"#52c41a"}),"Succeeded");case"Failed":return y.default.createElement("div",{style:{color:"red"}},y.default.createElement(m.default,{color:"red"}),"Failed");case"Unkonwn":return y.default.createElement("div",{style:{color:"#b7b7b7"}},y.default.createElement(m.default,{color:"#b7b7b7"}),"Unkonwn")}}),this.getComStatus=(e=>{switch(e){case"Running":return y.default.createElement("div",{style:{color:"#52c41a"}},y.default.createElement(m.default,{color:"#52c41a"}),(0,C.formatMessage)({id:"status.component.health"}));case"Completed":return y.default.createElement("div",{style:{color:"#52c41a"}},y.default.createElement(m.default,{color:"#52c41a"}),(0,C.formatMessage)({id:"componentOverview.body.tab.overview.instance.completed"}));default:return y.default.createElement("div",{style:{color:"red"}},y.default.createElement(m.default,{color:"red"}),(0,C.formatMessage)({id:"status.component.not_health"}))}}),this.showActivePod=(e=>{var t=e.pods,a=e.name;this.setState({showPodSwitch:!0,activePod:t,modalTitle:a})}),this.handleCancel=(()=>{this.setState({showPodSwitch:!1})}),this.state={activeKey:null,activePod:[]}}render(){var e=this.props,t=e.dashboardList,a=e.dashboardShow,l=this.state,r=(l.activeKey,l.activePod),m=l.showPodSwitch,f=l.modalTitle,p=[{dataIndex:"pod_name",key:"pod_name",width:"17%"},{dataIndex:"pod_ip",key:"pod_ip",width:"17%"},{dataIndex:"status",key:"status",width:"17%",render:e=>{return this.getStatus(e)}},{dataIndex:"number",key:"number",width:"17%",render:(e,t)=>{var a=t.all_container,l=t.run_container;return y.default.createElement("span",{className:_.default.dsahboard},l,y.default.createElement("span",null,"/",a))}},{dataIndex:"restart_count",key:"restart_count",width:"17%",render:e=>{return y.default.createElement("span",null,e,y.default.createElement("span",null,"\u6b21"))}},{dataIndex:"create_time",key:"create_time",width:"17%",render:e=>{return b.default.fetchdayTime(e)}}],h=[{dataIndex:"name",key:"name",className:_.default.columnMoney,width:"25%",render:e=>{return y.default.createElement("span",{className:_.default.svgStyle},v.default.getSvg("chipSvg",40),y.default.createElement("span",null,e))}},{dataIndex:"status",key:"status",className:_.default.columnMoney,width:"25%",render:e=>{return this.getComStatus(e)}},{dataIndex:"number",key:"number",className:_.default.columnMoney,width:"25%",render:(e,t)=>{var a=t.all_pods,l=t.run_pods;return y.default.createElement("span",{className:_.default.dsahboard},l,y.default.createElement("span",null,"/",a))}},{dataIndex:"edit",key:"edit",className:_.default.columnMoney,width:"25%",render:(e,t)=>{return y.default.createElement("div",{style:{color:"#4d73b1",cursor:"pointer"},onClick:()=>this.showActivePod(t)},(0,C.formatMessage)({id:"enterpriseColony.mgt.cluster.pod"}))}}];return y.default.createElement(y.default.Fragment,null,y.default.createElement(d.default,{style:{boxShadow:"rgba(36, 46, 66, 0.16) 2px 4px 10px 0px",marginBottom:40},className:_.default.collapseStyle},a?y.default.createElement("div",null,y.default.createElement(u.default,null,y.default.createElement(c.default,{span:6},(0,C.formatMessage)({id:"enterpriseColony.mgt.cluster.comName"})),y.default.createElement(c.default,{span:6},(0,C.formatMessage)({id:"enterpriseColony.mgt.cluster.statues"})),y.default.createElement(c.default,{span:6},(0,C.formatMessage)({id:"enterpriseColony.mgt.cluster.num"})),y.default.createElement(c.default,{span:6},(0,C.formatMessage)({id:"enterpriseColony.mgt.cluster.edit"}))),y.default.createElement(i.default,{columns:h,dataSource:t,pagination:!1})):y.default.createElement(o.default,{active:!0})),y.default.createElement(s.default,{title:f,visible:m,width:900,onCancel:this.handleCancel,footer:[y.default.createElement(n.default,{key:"back",onClick:this.handleCancel},(0,C.formatMessage)({id:"popover.cancel"}))],className:_.default.modalStyle},y.default.createElement(u.default,null,y.default.createElement(c.default,{span:4},(0,C.formatMessage)({id:"enterpriseColony.mgt.cluster.server"})),y.default.createElement(c.default,{span:4},(0,C.formatMessage)({id:"enterpriseColony.mgt.node.ip"})),y.default.createElement(c.default,{span:4},(0,C.formatMessage)({id:"enterpriseColony.mgt.cluster.statues"})),y.default.createElement(c.default,{span:4},"READY"),y.default.createElement(c.default,{span:4},(0,C.formatMessage)({id:"enterpriseColony.mgt.cluster.restart"})),y.default.createElement(c.default,{span:4},(0,C.formatMessage)({id:"enterpriseColony.mgt.cluster.runTime"}))),y.default.createElement(i.default,{columns:p,dataSource:r,pagination:!1})))}},p=h))||p),S=w;t.default=S},QaUd:function(e,t,a){e.exports={linkStyle:"linkStyle___3e-3b",nameStyle:"nameStyle___1y1T-",rowStyle:"rowStyle___kQNxE",tdStyle:"tdStyle___38iSV",describe:"describe___3YMh1","editable-cell":"editable-cell___2slAx","editable-cell-value-wrap":"editable-cell-value-wrap___RgsBb","editable-row":"editable-row___Mgd7t",cmd:"cmd___6JdXP",copy:"copy___3b2Wi"}},WQ0r:function(e,t,a){"use strict";var l=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("cWXX");var n,d,o,i=l(a("/ezw")),u=r(a("q1tI")),c=a("LLXN"),m=a("MuoO"),f=l(a("UlLs")),p=l(a("E9cK")),h=(n=(0,m.connect)(),n((o=class extends u.Component{constructor(e){super(e),this.handlUnit=((e,t)=>{if(e){var a=e,l=t;return a>=1024&&(a=e/1024,l="GB"),t?l:a.toFixed(2)/1}return null}),this.state={}}render(){var e=this.props,t=e.rowClusterInfo,a=e.showInfo,l=t.all_nodes,r=t.node_ready,n=t.total_cpu,d=t.total_disk,o=t.total_memory,m=t.used_cpu,h=t.used_disk,g=t.used_memory,y=t.services_status,E=0==n?0:(m/n*100).toFixed(2),C=0==o?0:(g/o*100).toFixed(2),v=0==d?0:(h/d*100).toFixed(2),b=n&&parseInt(n)||0,_=o&&this.handlUnit(o)||0,w=d&&parseInt(d)||0;return u.default.createElement(u.default.Fragment,null,u.default.createElement(s.default,{style:{boxShadow:"rgba(36, 46, 66, 0.16) 2px 4px 10px 0px"}},t&&Object.keys(t).length>0&&a?u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:p.default.titleStyle},u.default.createElement("div",null,u.default.createElement("p",null,(0,c.formatMessage)({id:"enterpriseColony.mgt.cluster.totalCpu"}),u.default.createElement("span",null,b),"Core")),u.default.createElement("div",null,u.default.createElement("p",null,(0,c.formatMessage)({id:"enterpriseColony.mgt.cluster.totalMemory"}),u.default.createElement("span",null,_),"GB")),u.default.createElement("div",null,u.default.createElement("p",null,(0,c.formatMessage)({id:"enterpriseColony.mgt.cluster.totalStore"}),u.default.createElement("span",null,w),"GB")),u.default.createElement("div",null,u.default.createElement("p",null,(0,c.formatMessage)({id:"enterpriseColony.mgt.cluster.node"}))),u.default.createElement("div",null,u.default.createElement("p",null,(0,c.formatMessage)({id:"enterpriseColony.mgt.cluster.pods"})))),u.default.createElement("div",{className:p.default.chartsStyle},u.default.createElement("div",null,u.default.createElement(f.default,{keys:"upcpu"+"".concat(1),svalue:E,cname:"CPU",swidth:"200px",sheight:"120px"})),u.default.createElement("div",null,u.default.createElement(f.default,{keys:"upcpu"+"".concat(2),svalue:0==Number(C)?0:Number(C),cname:(0,c.formatMessage)({id:"enterpriseColony.mgt.cluster.memory"}),swidth:"200px",sheight:"120px"})),u.default.createElement("div",null,u.default.createElement(f.default,{keys:"upcpu"+"".concat(3),svalue:0==Number(v)?0:Number(v),cname:(0,c.formatMessage)({id:"enterpriseColony.mgt.cluster.store"}),swidth:"200px",sheight:"120px"})),u.default.createElement("div",null,u.default.createElement("p",null,r=={}?0:r||0,u.default.createElement("span",null,"/",l||0))),u.default.createElement("div",null,u.default.createElement("p",null,y&&y.running||0)))):u.default.createElement(i.default,{active:!0})))}},d=o))||d),g=h;t.default=g},bTEM:function(e,t,a){"use strict";var l=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("cWXX");var n=l(a("/ezw"));a("g9YV");var d=l(a("wCAj"));a("+L6B");var o=l(a("2/Rp"));a("qVdP");var i=l(a("jsC+"));a("Pwec");var u=l(a("CtXQ"));a("lUTK");var c=l(a("BvKs"));a("+BJd");var m=l(a("mr32"));a("5Dmo");var f=l(a("3S7+"));a("/xke");var p=l(a("TeRw"));a("Awhp");var h=l(a("KrTs"));a("y8nQ");var g,y,E,C,v=l(a("Vl3Y")),b=r(a("q1tI")),_=a("LLXN"),w=(l(a("+QRC")),a("mLYH"),a("MuoO")),S=(l(a("s6ox")),a("7DNP")),M=l(a("QDog")),k=l(a("2lxJ")),x=l(a("QaUd")),I=(g=(0,w.connect)(),y=v.default.create(),g(E=y((C=class extends b.Component{constructor(e){super(e),this.clusterStatus=(e=>{switch(e){case"Ready":return b.default.createElement("span",{style:{color:"#52c41a"}},b.default.createElement(h.default,{color:"#52c41a"}),e);case"NotReady":return b.default.createElement("span",{style:{color:"red"}},b.default.createElement(h.default,{color:"red"}),e);case"Ready,SchedulingDisabled":return b.default.createElement("span",{style:{color:"#52c41a"}},b.default.createElement(h.default,{color:"#52c41a"}),e);default:return b.default.createElement("span",{style:{color:"black"}},b.default.createElement(h.default,{color:"black"}),b.default.createElement(_.FormattedMessage,{id:"enterpriseColony.table.state.unknown"}))}}),this.onClickRow=(e=>{var t=this.props.rowClusterInfo;return{onClick:()=>{var a=this.state.jumpSwitch,l=this.props.dispatch,r=M.default.getCurrEnterpriseId();a&&l(S.routerRedux.push("/enterprise/".concat(r,"/clusters/nodemgt/").concat(t.region_id,"?name=").concat(e.name)))}}}),this.clusterNodeAdd=(()=>{var e=this.props.rowClusterInfo;this.props.updateCluster(e.provider_cluster_id)}),this.menuMouseEnter=(()=>{this.setState({jumpSwitch:!1})}),this.menuMouseLeave=(()=>{this.setState({jumpSwitch:!0})}),this.editNodeStatus=((e,t,a)=>{var l=this.props.rowClusterInfo;"evict"==e?1==a.unschedulable?this.props.active(e,t,l.region_name):p.default.warning({message:(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.placeseDispatch"})}):this.props.active(e,t,l.region_name)}),this.state={eid:M.default.getCurrEnterpriseId(),jumpSwitch:!0,selectArr:["controlplane","etcd","worker"],modalVisible:!1,initNodeCmd:"",showUpdateKubernetes:!1,showUpdateKubernetesTasks:!1}}render(){var e=this.props,t=e.nodeList,a=e.rowClusterInfo,l=e.showInfo,r=e.form,p=(this.state.selectArr,M.default.getCurrEnterpriseId()),h=(r.getFieldDecorator,()=>b.default.createElement("svg",{t:"1581212425061",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1314",width:"32",height:"32"},b.default.createElement("path",{d:"M512 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"1315",fill:"#999999"}),b.default.createElement("path",{d:"M512 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"1316",fill:"#999999"}),b.default.createElement("path",{d:"M512 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z","p-id":"1317",fill:"#999999"}))),g=[{title:b.default.createElement("span",null,(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.name"}),b.default.createElement(f.default,{placement:"top",title:(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.clickRow"})},b.default.createElement("span",{className:x.default.nameStyle},k.default.getSvg("helpSvg",18)))),dataIndex:"name",key:"name",render:e=>{return b.default.createElement(S.Link,{style:{fontWeight:600},to:"/enterprise/".concat(p,"/clusters/nodemgt/").concat(a.region_id,"?name=").concat(e)},e)}},{title:(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.statues"}),dataIndex:"status",key:"status",render:e=>{return this.clusterStatus(e)}},{title:(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.role"}),dataIndex:"role",key:"role",render:e=>e&&e.length>0&&e.map(e=>b.default.createElement(m.default,{color:"blue"},e))},{title:(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.assignedCpu"}),dataIndex:"cpu",key:"cpu",render:(e,t)=>{var a=t.req_cpu,l=t.cap_cpu,r=(a/l*100).toFixed(1);return b.default.createElement(b.default.Fragment,null,b.default.createElement("p",{className:x.default.tdStyle},(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.assigned"}),r,"%"),b.default.createElement("p",null,a.toFixed(1)," / ",l.toFixed(1)," Core"))}},{title:(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.assignedMemory"}),dataIndex:"mey",key:"mey",render:(e,t)=>{var a=t.cap_memory,l=t.req_memory,r=(l/a*100).toFixed(1);return b.default.createElement(b.default.Fragment,null,b.default.createElement("p",{className:x.default.tdStyle},(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.assigned"}),r,"%"),b.default.createElement("p",null,l.toFixed(1)," / ",a.toFixed(1)," GB"))}},{title:(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.edit"}),key:"edit",render:(e,t)=>{var a=[b.default.createElement("span",{onClick:()=>this.editNodeStatus("reschedulable",t.name,t)},(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.dispatch"}))],l=[b.default.createElement("span",{onClick:()=>this.editNodeStatus("unschedulable",t.name,t)},(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.banDispatch"}))],r=[b.default.createElement("span",{onClick:()=>this.editNodeStatus("evict",t.name,t)},(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.evacuation"}))],s=[];0==t.unschedulable?(s.push(...l),s.push(...r)):(s.push(...a),s.push(...r));var n=b.default.createElement(c.default,{onMouseEnter:this.menuMouseEnter,onMouseLeave:this.menuMouseLeave},s.map(e=>{return b.default.createElement(c.default.Item,null,e)}));return b.default.createElement(i.default,{overlay:n,placement:"bottomLeft"},b.default.createElement(u.default,{component:h,style:{width:"50%"}}))}}];return b.default.createElement(b.default.Fragment,null,b.default.createElement(s.default,{extra:a&&"rke"==a.provider&&b.default.createElement(o.default,{icon:"form",onClick:this.clusterNodeAdd},(0,_.formatMessage)({id:"enterpriseColony.mgt.cluster.editNode"})),style:{boxShadow:"rgba(36, 46, 66, 0.16) 2px 4px 10px 0px"}},l?b.default.createElement(d.default,{columns:g,dataSource:t,pagination:!!(t&&t.length>10),onRow:this.onClickRow,rowClassName:x.default.rowStyle}):b.default.createElement(n.default,{active:!0})))}},E=C))||E)||E),L=I;t.default=L},gLJQ:function(e,t,a){e.exports={InfoStyle:"InfoStyle___1jXJU",ClusterInfo:"ClusterInfo___2V0cW",nodeType:"nodeType___2RdLx"}},ipdq:function(e,t,a){e.exports={svgStyle:"svgStyle___36EYY",dsahboard:"dsahboard___3lA62",headerStyle:"headerStyle___xPV4d",thStyle:"thStyle___1Cciw",collapseStyle:"collapseStyle___3vZG_",spanStyle:"spanStyle___2AKML",columnMoney:"columnMoney___2QXJK",modalStyle:"modalStyle___1dJag"}},l4x9:function(e,t,a){"use strict";var l=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var s=l(a("BMrR"));a("/xke");var n,d,o,i=l(a("TeRw")),u=r(a("q1tI")),c=a("MuoO"),m=a("7DNP"),f=a("mLYH"),p=l(a("LpW7")),h=a("LLXN"),g=l(a("bTEM")),y=l(a("BnX1")),E=l(a("WQ0r")),C=l(a("s6ox")),v=l(a("T8HY")),b=l(a("2lxJ")),_=l(a("QDog")),w=l(a("44vR")),S=(n=(0,c.connect)(),n((o=class extends u.Component{constructor(e){super(e),this.loadClusters=(()=>{var e=this.props,t=e.dispatch,a=e.match.params,l=a.eid,r=a.regionID;t({type:"region/fetchEnterpriseClusters",payload:{enterprise_id:l},callback:e=>{if(e&&e.list){var t=[];e.list.map((e,a)=>{return e.key="cluster".concat(a),t.push(e),e});t.filter(e=>{e.region_id==r&&this.setState({rowCluster:e,showInfo:!0},()=>{this.fetClusterNodeList(e),this.fetDashboardList(e)})})}else this.setState({rowCluster:[],showInfo:!1})}})}),this.updateCluster=(e=>{var t=this.props.match.params.eid;(0,f.getUpdateKubernetesTask)({clusterID:e,providerName:"rke",enterprise_id:t},e=>{cloud.handleCloudAPIError(e)}).then(t=>{t.task&&"complete"!==t.task.status?this.setState({showUpdateKubernetesTasks:!0,updateTask:t.task}):this.setState({showUpdateKubernetes:!0,nodeListArr:t.nodeList,rkeConfig:t.rkeConfig,updateClusterID:e,clusterID:e})}).catch(e=>{console.log(e)})}),this.fetClusterNodeList=(e=>{var t=this.props,a=t.dispatch,l=t.match.params,r=l.eid;l.regionID;this.setState({showListInfo:!1}),a({type:"region/fetClusterNodeList",payload:{enterprise_id:r,region_name:e&&e.region_name},callback:e=>{e&&200==e.status_code&&this.setState({nodeList:e.list,showListInfo:!0,nodeType:e.bean})},handleError:()=>{this.setState({nodeList:[],showListInfo:!0},()=>{i.default.error({message:(0,h.formatMessage)({id:"enterpriseColony.mgt.cluster.errorList"})})})}})}),this.editClusterNodeActive=((e,t,a)=>{var l=this.props,r=l.dispatch,s=l.match.params,n=s.eid,d=(s.regionID,this.state.rowCluster);r({type:"region/editClusterNodeActive",payload:{enterprise_id:n,region_name:a,action:e,node_id:t},callback:e=>{e&&200==e.status_code&&(i.default.success({message:(0,h.formatMessage)({id:"enterpriseColony.mgt.cluster.editSuccess"})}),this.fetClusterNodeList(d))},handleError:()=>{i.default.error({message:(0,h.formatMessage)({id:"enterpriseColony.mgt.cluster.editDefeated"})}),this.fetClusterNodeList(d)}})}),this.editNode=(()=>{this.setState({showUpdateKubernetes:!0})}),this.cancelShowUpdateKubernetes=(()=>{var e=this.state.rowCluster;this.setState({showUpdateKubernetesTasks:!1,updateTask:null},()=>{this.fetClusterNodeList(e)})}),this.fetDashboardList=(e=>{var t=this.props,a=t.dispatch,l=t.match.params,r=l.eid;l.regionID,this.state.rowCluster,e.provider_cluster_id,e.provider;a({type:"region/fetDashboardList",payload:{enterprise_id:r,region_name:e.region_name},callback:e=>{this.setState({dashboardList:e.list,dashboardShow:!0})},handleError:()=>{this.setState({dashboardList:[],dashboardShow:!0},()=>{i.default.error({message:(0,h.formatMessage)({id:"enterpriseColony.mgt.cluster.getRainbondList"})})})}})}),this.state={rowCluster:[],nodeList:[],showListInfo:!1,selectClusterName:"",clusterID:"",showCreateLog:!1,isInstallRemind:!1,installLoading:!1,isComponents:!1,showUpdateKubernetes:!1,dashboardShow:!1}}componentDidMount(){this.loadClusters()}render(){var e=_.default.getCurrEnterpriseId(),t=this.state,a=t.rowCluster,l=t.showInfo,r=t.nodeList,n=t.showListInfo,d=t.showUpdateKubernetes,o=t.nodeListArr,i=t.rkeConfig,c=t.updateClusterID,f=t.showUpdateKubernetesTasks,S=t.updateTask,M=t.clusterID,k=t.dashboardList,x=t.dashboardShow,I=t.nodeType;return u.default.createElement(u.default.Fragment,null,u.default.createElement(s.default,{className:w.default.breadStyle},u.default.createElement("span",null,b.default.getSvg("ClusterSvg",18)),u.default.createElement("span",null,u.default.createElement(m.Link,{to:"/enterprise/".concat(e,"/clusters")},(0,h.formatMessage)({id:"enterpriseColony.mgt.cluster.clusterMgt"})," / ")),u.default.createElement("span",null,a&&a.region_alias)),u.default.createElement(s.default,{className:w.default.titleStyle},u.default.createElement("span",null,b.default.getSvg("infoSvg",20)),u.default.createElement("span",null,(0,h.formatMessage)({id:"enterpriseColony.mgt.cluster.clusterInfo"}))),u.default.createElement(s.default,null,u.default.createElement(y.default,{rowClusterInfo:a,loadClusters:this.loadClusters,nodeType:I,showInfo:l})),u.default.createElement(s.default,{className:w.default.titleStyle},u.default.createElement("span",null,b.default.getSvg("listSvg",20)),u.default.createElement("span",null,(0,h.formatMessage)({id:"enterpriseColony.mgt.cluster.clusterList"}))),u.default.createElement(s.default,null,u.default.createElement(g.default,{rowClusterInfo:a,nodeList:r,active:this.editClusterNodeActive,showInfo:n,updateCluster:this.updateCluster})),u.default.createElement(s.default,{className:w.default.titleStyle},u.default.createElement("span",null,b.default.getSvg("userSvg",20)),u.default.createElement("span",null,(0,h.formatMessage)({id:"enterpriseColony.mgt.cluster.user"}))),u.default.createElement(s.default,null,u.default.createElement(E.default,{showInfo:l,rowClusterInfo:a})),u.default.createElement(s.default,{className:w.default.titleStyle},u.default.createElement("span",null,b.default.getSvg("examineSvg",20)),u.default.createElement("span",null,(0,h.formatMessage)({id:"enterpriseColony.mgt.cluster.rainbondList"}))),u.default.createElement(s.default,null,u.default.createElement(p.default,{dashboardList:k,dashboardShow:x})),d&&u.default.createElement(C.default,{eid:e,onOK:e=>{this.setState({clusterID:e.clusterID,showUpdateKubernetes:!1,updateTask:e,showUpdateKubernetesTasks:!0})},onCancel:()=>{this.setState({showUpdateKubernetes:!1})},clusterID:c,nodeList:o,rkeConfig:i}),f&&u.default.createElement(v.default,{eid:e,clusterID:M,task:S,selectProvider:"rke",onCancel:this.cancelShowUpdateKubernetes}))}},d=o))||d),M=S;t.default=M}}]);