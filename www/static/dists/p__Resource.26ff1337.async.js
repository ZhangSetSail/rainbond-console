(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[73],{FcSy:function(e,t,a){e.exports={action:"action___3Fw7O",tooltip_style:"tooltip_style___2qLqq",loadingStyle:"loadingStyle___3yZ-k",CardStyle:"CardStyle___1_GJU"}},"Fw1+":function(e,t,a){"use strict";var s=a("g09b"),l=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bbsP");var i=s(a("/wGt"));a("IzEo");var n=s(a("bx4M"));a("g9YV");var d=s(a("wCAj"));a("T2oS");var o=s(a("W9HT"));a("+L6B");var r=s(a("2/Rp"));a("Q9mQ");var c=s(a("diRs"));a("/xke");var u=s(a("TeRw"));a("y8nQ");var m,f,g,h,p=s(a("Vl3Y")),b=s(a("XZXw")),y=l(a("q1tI")),C=a("MuoO"),w=a("LLXN"),_=s(a("QDog")),v=s(a("4sH1")),S=s(a("ZNrE")),M=a("CC/n"),D=s(a("q76B")),E=s(a("2lxJ")),K=s(a("FcSy")),R=(m=(0,C.connect)(),f=p.default.create(),m(g=f((h=class extends y.PureComponent{constructor(e){super(e),this.getPageContent=(()=>{var e=_.default.getCurrTeamName(),t=_.default.getAppID();(0,M.getKubernetesVal)({team_name:e,app_id:t}).then(e=>{e&&e.response_data&&200==e.response_data.code&&this.setState({content:e.list,localContent:" ",loadingSwitch:!1})})}),this.onClose=(()=>{this.setState({visible:!1,isSubmit:!0,type:"add"})}),this.handleConfigurationOperation=(()=>{this.setState({visible:!0,title:(0,w.formatMessage)({id:"addKubenetesResource.btn.add"}),type:"add",localContent:!1})}),this.handleSubmit=(()=>{var e=this.props.form;e.validateFields((e,t)=>{var a={yaml:t.yaml},s=this.handYamlValidation(t.yaml);s&&(t.yaml?this.handelAddOrEdit(a):u.default.error({message:(0,w.formatMessage)({id:"notification.hint.resource.msg"})}))})}),this.editButton=((e,t)=>{var a=_.default.getCurrTeamName(),s=_.default.getAppID();(0,M.getSingleKubernetesVal)({team_name:a,app_id:s,list_name:t.name,id:t.ID}).then(a=>{a&&a.response_data&&200==a.response_data.code?this.setState({type:e,visible:!0,editName:t.name,localContent:a.list.content,editId:t.ID,title:(0,w.formatMessage)({id:"addKubenetesResource.table.btn.edit"})}):this.setState({type:e,visible:!0,editName:t.name,localContent:t.content,editId:t.ID,title:(0,w.formatMessage)({id:"addKubenetesResource.table.btn.edit"})})})}),this.editErrButton=((e,t)=>{this.setState({title:"yaml",visible:!0,localContent:t.content,isSubmit:!1})}),this.deleteButton=(e=>{e?(this.setState({showDeletePort:!this.state.showDeletePort}),this.setState({deleteVal:e})):this.setState({showDeletePort:!this.state.showDeletePort})}),this.handleDel=(()=>{var e=this.state.deleteVal,t=_.default.getCurrTeamName(),a=_.default.getAppID();(0,M.delSingleKubernetesVal)({team_name:t,app_id:a,yaml:e.content,list_name:e.name,List_id:e.ID}).then(e=>{e&&e.response_data&&200==e.response_data.code&&(u.default.success({message:(0,w.formatMessage)({id:"notification.success.delete"})}),this.getPageContent())}),this.setState({showDeletePort:!this.state.showDeletePort,visible:!1})}),this.cancalDeletePort=(()=>{this.setState({showDeletePort:!this.state.showDeletePort})}),this.handelAddOrEdit=(e=>{var t=_.default.getCurrTeamName(),a=_.default.getAppID(),s=this.state,l=(s.selectval,s.type),i=s.editId;"add"==l?(0,M.addSingleKubernetesVal)({team_name:t,app_id:a,yaml:e.yaml}).then(e=>{e&&e.response_data&&200==e.response_data.code?(u.default.success({message:(0,w.formatMessage)({id:"notification.success.add"})}),this.getPageContent()):(u.default.error({message:(0,w.formatMessage)({id:"notification.error.add"})}),this.getPageContent())}):"edit"==l&&(0,M.editSingleKubernetesVal)({team_name:t,app_id:a,list_name:this.state.editName,yaml:e.yaml,List_id:i}).then(e=>{e&&e.response_data&&200==e.response_data.code?(u.default.success({message:(0,w.formatMessage)({id:"notification.success.change"})}),this.getPageContent()):(u.default.error({message:(0,w.formatMessage)({id:"notification.error.change"})}),this.getPageContent())}),this.setState({visible:!1})}),this.handYamlValidation=(e=>{try{if(e){var t=v.default.loadAll(e);return t}}catch(e){var a=e.message.indexOf("\n"),s=e.message.substring(0,a);u.default.error({message:s,duration:30,top:10})}}),this.onSelectChange=(e=>{this.setState({selectedRowKeys:e})}),this.batchDeletion=(()=>{var e=this.state.selectedRowKeys,t=this.props.dispatch,a=_.default.getCurrTeamName(),s=_.default.getAppID();this.setState({handelType:"multiple"}),t({type:"application/batchDelSingleKubernetesVal",payload:{List_id:e,team_name:a,app_id:s},callback:e=>{u.default.success({message:(0,w.formatMessage)({id:"notification.success.delete"})}),this.setState({showDeletePort:!this.state.showDeletePort,selectedRowKeys:[]},()=>{this.getPageContent()})},handleError:e=>{u.default.error({message:(0,w.formatMessage)({id:"notification.error.delete"})}),this.setState({showDeletePort:!this.state.showDeletePort,selectedRowKeys:[]},()=>{this.getPageContent()})}})}),this.state={visible:!1,content:[],localContent:"",type:"add",title:(0,w.formatMessage)({id:"addKubenetesResource.btn.add"}),showDeletePort:!1,deleteVal:{},editName:"",editId:0,isSubmit:!0,loadingSwitch:!0}}componentDidMount(){this.getPageContent()}render(){var e=this.props.form,t=e.getFieldDecorator,a=e.setFieldsValue,s=this.state,l=s.content,u=s.localContent,m=s.title,f=s.isSubmit,g=s.loadingSwitch,h=(s.TooltipValue,s.type,s.selectedRowKeys),C=s.handelType,_={selectedRowKeys:h,onChange:this.onSelectChange},v={labelCol:{xs:{span:4},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:20}}},M={labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:24},sm:{span:24}}},R=[{title:(0,w.formatMessage)({id:"addKubenetesResource.table.name"}),dataIndex:"name",key:"name",align:"center",width:300},{title:(0,w.formatMessage)({id:"addKubenetesResource.table.type"}),dataIndex:"kind",key:"kind",align:"center",width:200},{title:(0,w.formatMessage)({id:"addKubenetesResource.table.status"}),dataIndex:"state",key:"state",align:"center",width:200,render:(e,t)=>{return y.default.createElement("div",null,1==e&&y.default.createElement("span",{style:{color:"green"}},(0,w.formatMessage)({id:"addKubenetesResource.table.success"})),2==e&&y.default.createElement("span",{style:{color:"green"}},(0,w.formatMessage)({id:"addKubenetesResource.table.update_success"})),3==e&&y.default.createElement(y.default.Fragment,null,y.default.createElement("span",{style:{color:"red"}},(0,w.formatMessage)({id:"addKubenetesResource.table.error"})),y.default.createElement(c.default,{overlayClassName:K.default.tooltip_style,placement:"bottom",title:(0,w.formatMessage)({id:"addKubenetesResource.table.errorDetail"}),content:t.error_overview,trigger:"click"},y.default.createElement("span",{style:{marginLeft:"20px",color:"#5672ac",cursor:"pointer"}},(0,w.formatMessage)({id:"addKubenetesResource.table.checkDetail"})))),4==e&&y.default.createElement("div",null,y.default.createElement("span",{style:{color:"red"}},(0,w.formatMessage)({id:"addKubenetesResource.table.update_error"})),y.default.createElement(c.default,{overlayClassName:K.default.tooltip_style,placement:"bottom",title:(0,w.formatMessage)({id:"addKubenetesResource.table.errorDetail"}),content:t.error_overview,trigger:"click"},y.default.createElement("span",{style:{marginLeft:"20px",color:"#5672ac",cursor:"pointer"}},(0,w.formatMessage)({id:"addKubenetesResource.table.checkDetail"})))))}},{title:(0,w.formatMessage)({id:"addKubenetesResource.table.operate"}),dataIndex:"content",key:"content",align:"center",width:200,render:(e,t)=>{return y.default.createElement(y.default.Fragment,null,3===t.state?y.default.createElement("span",{className:K.default.action,onClick:()=>this.editErrButton("edit",t),style:{marginRight:"10px"}},(0,w.formatMessage)({id:"addKubenetesResource.table.btn.check"})):y.default.createElement("span",{className:K.default.action,onClick:()=>this.editButton("edit",t),style:{marginRight:"10px"}},(0,w.formatMessage)({id:"addKubenetesResource.table.btn.edit"})),y.default.createElement("span",{className:K.default.action,onClick:()=>{this.setState({handelType:"single"}),this.deleteButton(t)}},(0,w.formatMessage)({id:"addKubenetesResource.table.btn.delete"})))}}];return y.default.createElement(b.default,{title:(0,w.formatMessage)({id:"addKubenetesResource.title"}),content:(0,w.formatMessage)({id:"addKubenetesResource.desc"}),titleSvg:E.default.getSvg("k8sSvg",18)},y.default.createElement(n.default,{className:K.default.CardStyle,style:{borderRadius:5,boxShadow:"rgb(36 46 66 / 16%) 2px 4px 10px 0px"},extra:y.default.createElement("div",{style:{width:"100%",display:"flex",justifyContent:h&&h.length>0?"space-between":"end"}},h&&h.length>0&&y.default.createElement(r.default,{type:"primary",onClick:()=>{this.deleteButton(),this.setState({handelType:"multiple"})}},y.default.createElement(w.FormattedMessage,{id:"componentOverview.body.tab.monitor.CustomMonitor.delete"})),y.default.createElement(r.default,{type:"primary",icon:"plus",onClick:()=>{this.handleConfigurationOperation()}},(0,w.formatMessage)({id:"addKubenetesResource.btn.add"})))},g?y.default.createElement("div",{className:K.default.loadingStyle},y.default.createElement(o.default,{size:"large"})):y.default.createElement(d.default,{dataSource:l,columns:R,rowSelection:_,rowKey:e=>e.ID})),y.default.createElement(i.default,{title:m,placement:"right",width:"400",onClose:this.onClose,visible:this.state.visible},y.default.createElement(p.default,v,y.default.createElement(S.default,{setFieldsValue:a,Form:p.default,style:{marginBottom:"20px"},getFieldDecorator:t,formItemLayout:M,name:"yaml",message:(0,w.formatMessage)({id:"notification.hint.confiuration.editContent"}),data:u||"",mode:"yaml",isAuto:!0})),y.default.createElement("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right"}},y.default.createElement(r.default,{onClick:this.onClose,style:{marginRight:8}},(0,w.formatMessage)({id:"button.cancel"})),f&&y.default.createElement(r.default,{onClick:this.handleSubmit,type:"primary"},(0,w.formatMessage)({id:"button.confirm"})))),this.state.showDeletePort&&y.default.createElement(D.default,{title:(0,w.formatMessage)({id:"confirmModal.delete.resource.title"}),desc:(0,w.formatMessage)({id:"confirmModal.delete.resource.desc"}),subDesc:(0,w.formatMessage)({id:"confirmModal.delete.strategy.subDesc"}),onOk:"multiple"==C?this.batchDeletion:this.handleDel,onCancel:this.cancalDeletePort}))}},g=h))||g)||g),x=R;t.default=x}}]);