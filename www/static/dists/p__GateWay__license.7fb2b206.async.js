(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[55],{"1nZ5":function(e,t,a){"use strict";var i=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var r=i(a("bx4M"));a("g9YV");var l=i(a("wCAj"));a("+L6B");var d=i(a("2/Rp"));a("P2fV");var n=i(a("NJEC"));a("14J3");var o=i(a("BMrR"));a("/xke");var c=i(a("TeRw"));a("tU7J");var m,u,f,p=i(a("wFql")),g=a("MuoO"),h=s(a("q1tI")),y=a("LLXN"),b=i(a("SKd/")),v=i(a("XZXw")),w=a("vSx2"),_=i(a("QDog")),M=i(a("2lxJ")),k=i(a("hMqj")),E=p.default.Paragraph,x=(m=(0,g.connect)(e=>{var t=e.user,a=e.teamControl,i=e.enterprise;return{currUser:t.currentUser,currentTeam:a.currentTeam,currentRegionName:a.currentRegionName,currentEnterprise:i.currentEnterprise,currentTeamPermissionsInfo:a.currentTeamPermissionsInfo}}),m((f=class extends h.Component{constructor(e){super(e),this.onPageChange=(e=>{this.setState({licenseLoading:!0}),this.setState({page:e},()=>{this.load()})}),this.rowKey=((e,t)=>t),this.load=(()=>{var e=this.state,t=e.page,a=e.pageSize;this.props.dispatch({type:"gateWay/fetchAllLicense",payload:{team_name:_.default.getCurrTeamName(),page_num:t,page_size:a},callback:e=>{e&&200===e.status_code&&this.setState({licenseList:e.list,total:e.bean.nums,editData:"",licenseLoading:!1})}})}),this.handleCick=(()=>{this.setState({visibleDrawer:!0})}),this.handleClose=(()=>{this.setState({visibleDrawer:!1,editData:""})}),this.handleOk=(e=>{var t=this.state.editData;t?this.props.dispatch({type:"gateWay/editLicense",payload:{alias:e.alias,private_key:e.private_key,certificate:e.certificate,certificate_type:e.certificate_type,team_name:_.default.getCurrTeamName(),certifiate_id:this.state.id},callback:e=>{e&&200===e.status_code&&(c.default.success({message:e?(0,y.formatMessage)({id:"notification.success.change"}):(0,y.formatMessage)({id:"notification.error.change"})}),this.setState({visibleDrawer:!1},()=>{this.load()}))}}):this.props.dispatch({type:"gateWay/addLicense",payload:{alias:e.alias,private_key:e.private_key,certificate:e.certificate,certificate_type:e.certificate_type,team_name:_.default.getCurrTeamName()},callback:e=>{e&&200===e.status_code&&(c.default.success({message:(0,y.formatMessage)({id:"notification.success.add"})}),this.setState({visibleDrawer:!1},()=>{this.load()}))}})}),this.handleDelete=(e=>{this.props.dispatch({type:"gateWay/deleteLicense",payload:{team_name:_.default.getCurrTeamName(),certifiate_id:e.id},callback:e=>{e&&200===e.status_code&&(c.default.success({message:e&&e.msg_show||(0,y.formatMessage)({id:"notification.success.delete"})}),this.load())}})}),this.handleEdit=(e=>{this.props.dispatch({type:"gateWay/queryDetail",payload:{certifiate_id:e.id,team_name:_.default.getCurrTeamName()},callback:e=>{e&&200===e.status_code&&this.setState({visibleDrawer:!0,editData:e.bean,id:e.bean.id})}})}),this.saveForm=(e=>{this.form=e,this.state.editData&&this.form&&this.form.setFieldsValue(this.state.editData)}),this.handleUpdate=(e=>{console.log(e)}),this.handlePermissions=(e=>{var t=this.props.currentTeamPermissionsInfo;return k.default.querySpecifiedPermissionsInfo(t,e)}),this.state={visibleDrawer:!1,licenseList:[],licenseLoading:!0,page:1,pageSize:10,total:"",editData:"",id:"",operationPermissions:this.handlePermissions("queryCertificateInfo")}}componentWillMount(){var e=this.props.dispatch,t=this.state.operationPermissions.isAccess;t?this.load():_.default.withoutPermission(e)}render(){var e=this.props,t=e.currentEnterprise,a=e.currentTeam,i=e.currentRegionName,s=this.state,c=s.page,m=s.pageSize,u=s.total,f=s.licenseList,p=s.operationPermissions,g=p.isCreate,_=p.isEdit,k=p.isDelete,x=[{title:(0,y.formatMessage)({id:"teamGateway.certificate.table.name"}),dataIndex:"alias",key:"alias",align:"center",width:"12%"},{title:(0,y.formatMessage)({id:"teamGateway.certificate.table.address"}),dataIndex:"issued_to",key:"issued_to",align:"center",width:"25%",render:e=>{return h.default.createElement(E,{ellipsis:{rows:2,expandable:!0},style:{margin:0}},e&&e.map(e=>{return h.default.createElement(o.default,{key:e},h.default.createElement(E,{style:{margin:0},copyable:!0},e))}))}},{title:(0,y.formatMessage)({id:"teamGateway.certificate.table.time"}),dataIndex:"end_data",key:"end_data",align:"center",width:"20%",render:(e,t)=>{return h.default.createElement("div",{style:{color:t.has_expired?"red":" rgba(0, 0, 0, 0.65)"}},e)}},{title:(0,y.formatMessage)({id:"teamGateway.certificate.table.type"}),dataIndex:"certificate_type",key:"certificate_type",align:"center",width:"13%"},{title:(0,y.formatMessage)({id:"teamGateway.certificate.table.source"}),dataIndex:"issued_by",key:"issued_by",align:"center",width:"15%"},{title:(0,y.formatMessage)({id:"teamGateway.certificate.table.operate"}),dataIndex:"action",key:"action",align:"center",width:"15%",render:(e,t)=>{return h.default.createElement("span",null,_&&h.default.createElement("a",{style:{marginRight:"10px"},onClick:()=>{this.handleEdit(t)}},(0,y.formatMessage)({id:"teamGateway.certificate.table.edit"})),!t.issued_by.includes("\u7b2c\u4e09\u65b9\u7b7e\u53d1")&&_&&h.default.createElement("a",{style:{marginRight:"10px"},onClick:()=>{this.handleUpdate(t)}},(0,y.formatMessage)({id:"teamGateway.certificate.table.update"})),k&&h.default.createElement(n.default,{title:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",onConfirm:()=>{this.handleDelete(t)}},h.default.createElement("a",null,(0,y.formatMessage)({id:"teamGateway.certificate.table.delete"}))))}}],C=[];return C=(0,w.createTeam)((0,w.createEnterprise)(C,t),a,i),C.push({title:(0,y.formatMessage)({id:"teamGateway.strategy.manage"})}),h.default.createElement(v.default,{title:(0,y.formatMessage)({id:"teamGateway.certificate.title"}),breadcrumbList:C,content:(0,y.formatMessage)({id:"teamGateway.certificate.desc"}),titleSvg:M.default.getSvg("certificateSvg",18)},h.default.createElement(r.default,{extra:g&&h.default.createElement(d.default,{type:"primary",icon:"plus",style:{float:"right"},onClick:this.handleCick},(0,y.formatMessage)({id:"teamGateway.certificate.btn.add"})),style:{borderRadius:5,boxShadow:"rgb(36 46 66 / 16%) 1px 2px 5px 0px"},bodyStyle:{padding:"0"}},h.default.createElement(l.default,{pagination:{total:u,page_num:c,pageSize:m,onChange:this.onPageChange,current:c},rowKey:this.rowKey,dataSource:f,columns:x,loading:this.state.licenseLoading})),this.state.visibleDrawer&&h.default.createElement(b.default,{ref:this.saveForm,visible:this.state.visibleDrawer,onClose:this.handleClose,onOk:e=>{this.handleOk(e)},editData:this.state.editData}))}},u=f))||u),C=x;t.default=C},"SKd/":function(e,t,a){"use strict";var i=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bbsP");var r=i(a("/wGt"));a("+L6B");var l=i(a("2/Rp")),d=i(a("jehZ"));a("5NDa");var n=i(a("5rEg"));a("miYZ");var o=i(a("tsqr"));a("7Kak");var c=i(a("9yH6"));a("y8nQ");var m,u,f,p=i(a("Vl3Y")),g=a("MuoO"),h=s(a("q1tI")),y=a("LLXN"),b=i(a("ZNrE")),v=p.default.Item,w=c.default.Group,_=(m=(0,g.connect)(e=>{var t=e.loading;return{editLicenseLoading:t.effects["gateWay/editLicense"],addLicenseLoading:t.effects["gateWay/addLicense"]}}),m((f=class extends h.PureComponent{constructor(e){super(e),this.handleSubmit=(e=>{e.preventDefault();var t=this.props.onOk;this.props.form.validateFields((e,a)=>{!e&&t&&t(a)})}),this.beforeUpload=((e,t)=>{var a=e.name.split("."),i=a.length,s="pem"===a[i-1]||"crt"===a[i-1]||"cer"===a[i-1]||"key"===a[i-1];return!!s||(t&&o.default.warning("\u8bf7\u4e0a\u4f20\u4ee5.pem, .crt, .cer, .key\u7ed3\u5c3e\u7684\u6587\u4ef6",5),!1)}),this.state={}}render(){var e=this.props,t=e.onClose,a=e.editData,i=void 0===a?{}:a,s=e.addLicenseLoading,o=e.editLicenseLoading,m=e.form,u=m.getFieldDecorator,f=m.setFieldsValue,g={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:17}}},_={setFieldsValue:f,formItemLayout:g,Form:p.default,getFieldDecorator:u},M=[{value:i.certificate,name:"certificate",label:(0,y.formatMessage)({id:"popover.manage.certificate.label.public"}),messages:(0,y.formatMessage)({id:"placeholder.certificate.name"}),uploadName:"public_key_btn",mode:"javascript"},{value:i.private_key,name:"private_key",label:(0,y.formatMessage)({id:"popover.manage.certificate.label.private"}),messages:(0,y.formatMessage)({id:"placeholder.certificate.private"}),uploadName:"private_key_btn",mode:"javascript"}];return h.default.createElement("div",null,h.default.createElement(r.default,{title:i?(0,y.formatMessage)({id:"popover.manage.certificate.title.edit"}):(0,y.formatMessage)({id:"popover.manage.certificate.title.add"}),placement:"right",width:500,closable:!1,onClose:t,visible:this.props.visible,maskClosable:!1,style:{overflow:"auto"}},h.default.createElement(p.default,{onSubmit:this.handleSubmit},h.default.createElement(v,(0,d.default)({},g,{label:(0,y.formatMessage)({id:"popover.manage.certificate.label.name"})}),u("alias",{rules:[{required:!0,message:(0,y.formatMessage)({id:"placeholder.certificate.name"})},{max:64,message:(0,y.formatMessage)({id:"placeholder.appShare.max64"})}]})(h.default.createElement(n.default,{placeholder:(0,y.formatMessage)({id:"placeholder.certificate.name"})}))),h.default.createElement(v,(0,d.default)({},g,{label:(0,y.formatMessage)({id:"popover.manage.certificate.label.kind"})}),u("certificate_type",{initialValue:(0,y.formatMessage)({id:"popover.manage.certificate.label.server"}),rules:[{required:!0}]})(h.default.createElement(w,null,h.default.createElement(c.default,{value:(0,y.formatMessage)({id:"popover.manage.certificate.label.server"})},(0,y.formatMessage)({id:"popover.manage.certificate.label.server"}))))),M.map(e=>{var t=e.value,a=e.name,i=e.label,s=e.messages,r=e.mode;return h.default.createElement(h.Fragment,{key:a},h.default.createElement(b.default,(0,d.default)({},_,{data:t,name:a,label:i,message:s,mode:r,beforeUpload:this.beforeUpload})))}),h.default.createElement("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px",zIndex:999}},h.default.createElement(l.default,{style:{marginRight:8},onClick:t},(0,y.formatMessage)({id:"button.cancel"})),h.default.createElement(l.default,{htmlType:"submit",type:"primary",loading:o||s},(0,y.formatMessage)({id:"button.confirm"}))))))}},u=f))||u),M=p.default.create()(_),k=M;t.default=k}}]);